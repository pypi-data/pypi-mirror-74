(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[59],{1663:function(t,e,n){"use strict";var r=n(4),a=(n(1),n(8)),i=n(0),o=Object(r.a)((function(t){var e=t.className,n=t.children,r=t.error;return Object(i.f)("div",{"data-test-id":"loading-placeholder",className:e},r||n)}),{target:"e1xygdhp0",label:"Placeholder"})("display:flex;flex-direction:column;flex-shrink:0;justify-content:center;background-color:",(function(t){return t.error?t.theme.red100:t.theme.gray200}),";",(function(t){return t.error&&"color: ".concat(t.theme.red300,";")})," width:",(function(t){return t.width}),";height:",(function(t){return t.height}),";",(function(t){return"circle"===t.shape?"border-radius: 100%;":""})," ",(function(t){return"number"==typeof t.bottomGutter&&t.bottomGutter>0?"margin-bottom: ".concat(Object(a.a)(t.bottomGutter),";"):""}));o.defaultProps={shape:"rect",bottomGutter:0,width:"100%",height:"60px"},e.a=o},1675:function(t,e,n){"use strict";var r,a,i,o,c,s;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return s})),function(t){t[t.INCIDENT=0]="INCIDENT",t[t.RESOLUTION=1]="RESOLUTION"}(r||(r={})),function(t){t[t.ABOVE=0]="ABOVE",t[t.BELOW=1]="BELOW"}(a||(a={})),function(t){t.ERRORS="events",t.TRANSACTIONS="transactions"}(i||(i={})),function(t){t[t.ONE_MINUTE=1]="ONE_MINUTE",t[t.FIVE_MINUTES=5]="FIVE_MINUTES",t[t.TEN_MINUTES=10]="TEN_MINUTES",t[t.FIFTEEN_MINUTES=15]="FIFTEEN_MINUTES",t[t.THIRTY_MINUTES=30]="THIRTY_MINUTES",t[t.ONE_HOUR=60]="ONE_HOUR",t[t.TWO_HOURS=120]="TWO_HOURS",t[t.FOUR_HOURS=240]="FOUR_HOURS",t[t.ONE_DAY=1440]="ONE_DAY"}(o||(o={})),function(t){t.EMAIL="email",t.SLACK="slack",t.PAGER_DUTY="pagerduty"}(c||(c={})),function(t){t.SPECIFIC="specific",t.USER="user",t.TEAM="team"}(s||(s={}))},1739:function(t,e,n){"use strict";function r(t){var e=t.orgSlug,n=t.transaction,r=t.projectID,a=t.query;return{pathname:function(t){var e=t.orgSlug;return"/organizations/".concat(e,"/performance/summary/")}({orgSlug:e}),query:{transaction:n,project:r,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query}}}n.d(e,"a",(function(){return r}))},1764:function(t,e,n){"use strict";var r,a,i,o,c;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return c})),function(t){t[t.DETECTED=0]="DETECTED",t[t.CREATED=1]="CREATED",t[t.TRIGGERED=2]="TRIGGERED"}(r||(r={})),function(t){t[t.CREATED=0]="CREATED",t[t.DETECTED=1]="DETECTED",t[t.STATUS_CHANGE=2]="STATUS_CHANGE",t[t.COMMENT=3]="COMMENT",t[t.STARTED=4]="STARTED"}(a||(a={})),function(t){t[t.OPENED=1]="OPENED",t[t.CLOSED=2]="CLOSED",t[t.WARNING=10]="WARNING",t[t.CRITICAL=20]="CRITICAL"}(i||(i={})),function(t){t[t.MANUAL=1]="MANUAL",t[t.RULE_UPDATED=2]="RULE_UPDATED",t[t.RULE_TRIGGERED=3]="RULE_TRIGGERED"}(o||(o={})),function(t){t[t.PENDING=0]="PENDING",t[t.SNAPSHOT=4]="SNAPSHOT",t[t.DISABLED=5]="DISABLED"}(c||(c={}))},1792:function(t,e,n){"use strict";n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return m})),n.d(e,"i",(function(){return h})),n.d(e,"h",(function(){return v})),n.d(e,"g",(function(){return y})),n.d(e,"e",(function(){return S})),n.d(e,"f",(function(){return E})),n.d(e,"d",(function(){return T})),n.d(e,"a",(function(){return R}));var r,a=n(15),i=n.n(a),o=n(16),c=n.n(o),s=n(3),u=n(1668),l=n(58),d=n(1662),f=n(1675),b=n(1848),p=n(1764);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e,n){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/"))}function m(t,e,n){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/stats/"))}function h(t,e,n,r){var a=r?"POST":"DELETE";return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/subscriptions/"),{method:a})}function v(t,e,n,r){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/"),{method:"PUT",data:{status:r}})}function y(t){switch(t.status){case p.c.CLOSED:return!1;default:return!0}}function S(t){var e,n,r=null==t?void 0:t.alertRule,a=null!==(e=null==r?void 0:r.aggregate)&&void 0!==e?e:"",i=null!==(n=null==r?void 0:r.dataset)&&void 0!==n?n:f.c.ERRORS;return b.a.find((function(t){return t.validDataset.includes(i)&&t.match.test(a)}))}function E(t){return{start:Object(l.j)(1e3*t.eventStats.data[0][0]),end:Object(l.j)(1e3*t.eventStats.data[t.eventStats.data.length-1][0])}}function T(t){var e,n=t.orgSlug,r=t.projects,a=t.incident,o=t.stats,c=t.extraQueryParams;if(!(r&&r.length&&a&&o))return"";var s="".concat(a.alertRule.timeWindow,"m"),l=E(o),b=l.start,p=l.end,O=j({id:void 0,name:a&&a.title||"",orderby:"-".concat(Object(u.i)(a.alertRule.aggregate)),yAxis:a.alertRule.aggregate,query:null!==(e=null==a?void 0:a.discoverQuery)&&void 0!==e?e:"",projects:r.filter((function(t){var e=t.slug;return a.projects.includes(e)})).map((function(t){var e=t.id;return Number(e)})),version:2,fields:a.alertRule.dataset===f.c.ERRORS?["issue","count()","count_unique(user)"]:["transaction",a.alertRule.aggregate],start:b,end:p},c),g=d.a.fromSavedQuery(O).getResultsViewUrlTarget(n),m=g.query,h=i()(g,["query"]);return j({query:j({},m,{interval:s})},h)}var R=(r={},c()(r,f.c.ERRORS,Object(s.b)("Errors")),c()(r,f.c.TRANSACTIONS,Object(s.b)("Transactions")),r)},1848:function(t,e,n){"use strict";n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return g}));var r=n(33),a=n.n(r),i=n(16),o=n.n(i),c=n(3),s=n(1887),u=n(637),l=n(1739),d=n(1792),f=n(1675);function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O=[{name:Object(c.b)("Error count"),match:/^count\(\)/,validDataset:[f.c.ERRORS],default:"count()",makeCtaParams:g},{name:Object(c.b)("Users affected"),match:/^count_unique\(tags\[sentry:user\]\)/,validDataset:[f.c.ERRORS],default:"count_unique(tags[sentry:user])",makeCtaParams:g},{name:Object(c.b)("Latency"),match:/^(p[0-9]{2,3}|percentile\(transaction\.duration,[^)]+\)|avg\([^)]+\))/,validDataset:[f.c.TRANSACTIONS],default:"percentile(transaction.duration, 0.95)",makeCtaParams:function(t){return j({opts:t,tooltip:Object(c.b)("Latency by Transaction")})}},{name:Object(c.b)("Apdex"),match:/^apdex\([0-9.]+\)/,validDataset:[f.c.TRANSACTIONS],default:"apdex(300)",makeCtaParams:function(t){return j({opts:t,tooltip:Object(c.b)("Apdex by Transaction")})}},{name:Object(c.b)("Transaction Count"),match:/^count\(\)/,validDataset:[f.c.TRANSACTIONS],default:"count()",makeCtaParams:function(t){return j({opts:t})}},{name:Object(c.b)("Failure rate"),match:/^failure_rate\(\)/,validDataset:[f.c.TRANSACTIONS],default:"failure_rate()",makeCtaParams:function(t){var e,n,r=t.orgSlug,a=t.incident,i=t.projects,o=t.stats;if(!a||!o)return{to:"",buttonText:Object(c.b)("Incident details")};var l=Object(u.b)(null!==(e=a.discoverQuery)&&void 0!==e?e:""),f=null===(n=l.transaction)||void 0===n?void 0:n.find((function(t){return!t.includes("*")})),b=void 0!==f?{fields:["transaction.status","count()"],orderby:"-count",display:s.d.TOP5}:{fields:["transaction","failure_rate()"],orderby:"-failure_rate",display:s.d.TOP5};return{to:Object(d.d)({orgSlug:r,projects:i,incident:a,stats:o,extraQueryParams:b}),buttonText:Object(c.b)("Open in Discover"),title:void 0===f?Object(c.b)("Failure rate by transaction"):void 0}}}];function j(t){var e,n,r=t.opts,i=r.orgSlug,o=r.projects,f=r.incident,b=r.stats,O=t.tooltip;if(!f||!b)return{to:"",buttonText:Object(c.b)("Incident details")};var j=null===(n=Object(u.b)(null!==(e=f.discoverQuery)&&void 0!==e?e:"").transaction)||void 0===n?void 0:n.find((function(t){return!t.includes("*")}));if(void 0!==j){var g=Object(d.f)(b);return{to:Object(l.a)({orgSlug:i,transaction:j,projectID:o.filter((function(t){var e=t.slug;return f.projects.includes(e)})).map((function(t){return t.id})),query:p({},g)}),buttonText:Object(c.b)("View Transaction Summary"),title:j}}var m={fields:a()(new Set(["transaction","count()",f.alertRule.aggregate])),orderby:"-count",display:s.d.TOP5};return{to:Object(d.d)({orgSlug:i,projects:o,incident:f,stats:b,extraQueryParams:m}),buttonText:Object(c.b)("Open in Discover"),title:O}}function g(t){var e=t.orgSlug,n=t.projects,r=t.incident,a=t.stats;if(!r)return{buttonText:Object(c.b)("Open in Discover"),to:""};var i={display:s.d.TOP5};return{buttonText:Object(c.b)("Open in Discover"),to:Object(d.d)({orgSlug:e,projects:n,incident:r,stats:a,extraQueryParams:i})}}},1862:function(t,e,n){"use strict";function r(t,e){return t.requestPromise("/promptsactivity/",{method:"PUT",data:{organization_id:e.organizationId,project_id:e.projectId,feature:e.feature,status:e.status}})}n.d(e,"a",(function(){return r}))},1869:function(t,e,n){"use strict";var r=n(4),a=(n(1),n(281)),i=n(8),o=n(0);function c(t){var e=t.className,n=t.image,r=t.children;return Object(o.f)(a.a,{className:e},Object(o.f)(s,null,Object(o.f)(l,null,n),Object(o.f)(u,null,r)))}c.displayName="OnboardingPanel";var s=Object(r.a)("div",{target:"eipqko00",label:"Container"})("padding:",Object(i.a)(3),";position:relative;@media (min-width:",(function(t){return t.theme.breakpoints[0]}),"){display:flex;align-items:center;flex-direction:row;justify-content:center;flex-wrap:wrap;min-height:300px;max-width:1000px;margin:0 auto;}@media (min-width:",(function(t){return t.theme.breakpoints[1]}),"){min-height:350px;}"),u=Object(r.a)("div",{target:"eipqko01",label:"StyledBox"})("z-index:1;@media (min-width:",(function(t){return t.theme.breakpoints[0]}),"){flex:2;}"),l=Object(r.a)(u,{target:"eipqko02",label:"IlloBox"})("position:relative;min-height:100px;max-width:300px;margin:",Object(i.a)(2)," auto;@media (min-width:",(function(t){return t.theme.breakpoints[0]}),"){flex:1;margin:",Object(i.a)(3),";max-width:auto;}");e.a=c},2660:function(t,e,n){t.exports=n.p+"alerts-empty-state.7ebcc8.svg"},2889:function(t,e,n){"use strict";n.r(e);var r=n(20),a=n.n(r),i=n(28),o=n.n(i),c=n(16),s=n.n(c),u=n(9),l=n.n(u),d=n(10),f=n.n(d),b=n(11),p=n.n(b),O=n(12),j=n.n(O),g=n(6),m=n.n(g),h=n(4),v=n(282),y=n.n(v),S=n(1),E=n.n(S),T=n(877),R=n.n(T),k=n(186),w=n.n(k),P=n(18),D=n(223),I=n(281),N=n(463),A=n(3),x=n(34),C=n(88),L=n(1636),_=n(396),q=n(31),U=n(163),z=n(626),G=n(81),M=n(52),V=n(387),B=n(627),H=n(288),F=n(8),W=n(80),Q=n(383),Y=n(37),K=n(641),X=n(1862),J=Object(h.a)("div",{target:"e1k7qk1w0",label:"TableLayout"})("display:grid;grid-template-columns:",(function(t){return"open"===t.status?"4fr 1fr 2fr":"3fr 2fr 2fr 1fr 2fr"}),";grid-column-gap:",Object(F.a)(1.5),";width:100%;align-items:center;"),Z=Object(h.a)("div",{target:"e1k7qk1w1",label:"TitleAndSparkLine"})("display:",(function(t){return"open"===t.status?"grid":"flex"}),";grid-gap:",Object(F.a)(1),";grid-template-columns:auto 120px;align-items:center;padding-right:",Object(F.a)(2),";overflow:hidden;"),$=n(496),tt=n.n($),et=n(46),nt=n.n(et),rt=n(1644),at=n(649),it=n(284),ot=n(286),ct=n(104),st=n(25),ut=n(249),lt=n(41),dt=n(334),ft=n(85),bt=n(1764),pt=n(1792),Ot=n(43),jt=n.n(Ot),gt=n(1663),mt=n(0);function ht(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var vt=E.a.lazy((function(){return Promise.all([n.e(16),n.e(199)]).then(n.bind(null,2857))})),yt=E.a.lazy((function(){return Promise.all([n.e(16),n.e(200)]).then(n.bind(null,2858))})),St=function(t){p()(r,t);var e,n=(e=r,function(){var t,n=m()(e);if(ht()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return j()(this,t)});function r(){return l()(this,r),n.apply(this,arguments)}return f()(r,[{key:"render",value:function(){var t=this.props,e=t.className,n=t.error,r=t.eventStats;if(n)return Object(mt.f)(Rt,{error:n});if(!r)return Object(mt.f)(Tt,null);var a=r.data.map((function(t){var e=jt()(t,2)[1];return e&&Array.isArray(e)&&e.length&&e[0].count||0}));return Object(mt.f)(E.a.Suspense,{fallback:Object(mt.f)(Tt,null)},Object(mt.f)("div",{"data-test-id":"incident-sparkline",className:e},Object(mt.f)(vt,{data:a,width:100,height:32},Object(mt.f)(yt,{style:{stroke:st.a.gray500,fill:"none",strokeWidth:2}}))))}}]),r}(E.a.Component);St.displayName="SparkLine";var Et=Object(h.a)(St,{target:"e1ut8dj0",label:"StyledSparkLine"})("flex-shrink:0;width:100%;height:",38,"px;"),Tt=Object(h.a)(gt.a,{target:"e1ut8dj1",label:"SparkLinePlaceholder"})("height:",38,"px;"),Rt=Object(h.a)(Tt,{target:"e1ut8dj2",label:"SparklineError"})({name:"mp4ek8",styles:"align-items:center;line-height:1;"}),kt=Et;function wt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Pt=function(t){p()(r,t);var e,n=(e=r,function(){var t,n=m()(e);if(wt()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return j()(this,t)});function r(){var t;l()(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return(t=n.call.apply(n,[this].concat(a))).getProject=tt()((function(t,e){return e.find((function(e){return e.slug===t}))})),t}return f()(r,[{key:"getEndpoints",value:function(){var t=this.props,e=t.orgId,n=t.incident;return"open"===t.filteredStatus?[["stats","/organizations/".concat(e,"/incidents/").concat(n.identifier,"/stats/")]]:[]}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderError",value:function(){return this.renderBody()}},{key:"renderTimeSince",value:function(t){return Object(mt.f)(It,null,Object(mt.f)(lt.a,{title:Object(mt.f)(rt.a,{date:t,utc:!1}),position:"top"},Object(mt.f)(ut.a,{title:"",date:t})))}},{key:"renderStatusIndicator",value:function(){var t=this.props.incident.status,e=t===bt.c.CLOSED,n=t===bt.c.WARNING,r=e?st.a.gray400:n?st.a.orange300:st.a.red300,a=e?Object(A.b)("Resolved"):n?Object(A.b)("Warning"):Object(A.b)("Critical");return Object(mt.f)(lt.a,{title:Object(A.c)("Status: [text]",{text:a})},Object(mt.f)(At,{color:r}))}},{key:"renderBody",value:function(){var t=this.props,e=t.incident,n=t.orgId,r=t.projectsLoaded,a=t.projects,i=t.filteredStatus,o=this.state,c=o.error,s=o.stats,u=nt()(e.dateStarted),l=nt.a.duration(nt()(e.dateClosed||new Date).diff(u)).as("seconds"),d=e.projects[0];return Object(mt.f)(it.a,null,Object(mt.f)(Lt,null,Object(mt.f)(J,{status:i},Object(mt.f)(Z,{status:i},Object(mt.f)(xt,null,this.renderStatusIndicator(),Object(mt.f)(Ct,{to:"/organizations/".concat(n,"/alerts/").concat(e.identifier,"/")},"Alert #",e.id),e.title),"open"===i&&Object(mt.f)(kt,{error:c&&Object(mt.f)(Dt,null),eventStats:null==s?void 0:s.eventStats})),Object(mt.f)(Nt,{avatarSize:18,project:r?this.getProject(d,a):{slug:d}}),this.renderTimeSince(e.dateStarted),"closed"===i&&Object(mt.f)(at.a,{seconds:Object(dt.a)({value:l,fixed:1200})}),"closed"===i&&e.dateClosed&&this.renderTimeSince(e.dateClosed))))}},{key:"metricPreset",get:function(){var t=this.props.incident;return t?Object(pt.e)(t):void 0}}]),r}(L.a);function Dt(){return Object(mt.f)(lt.a,{title:Object(A.b)("Error loading alert stats")},Object(mt.f)(P.Hb,null))}Dt.displayName="ErrorLoadingStatsIcon";var It=Object(h.a)("div",{target:"e12tl7g20",label:"CreatedResolvedTime"})(ft.a," line-height:1.4;display:flex;align-items:center;"),Nt=Object(h.a)(ot.a,{target:"e12tl7g21",label:"ProjectBadge"})({name:"6su6fj",styles:"flex-shrink:0;"}),At=Object(h.a)("div",{target:"e12tl7g22",label:"StatusIndicator"})("width:10px;height:12px;background:",(function(t){return t.color}),";display:inline-block;border-top-right-radius:40%;border-bottom-right-radius:40%;margin-bottom:-1px;"),xt=Object(h.a)("span",{target:"e12tl7g23",label:"Title"})(ft.a),Ct=Object(h.a)(ct.a,{target:"e12tl7g24",label:"IncidentLink"})("padding:0 ",Object(F.a)(1),";"),Lt=Object(h.a)(I.f,{target:"e12tl7g25",label:"IncidentPanelItem"})("font-size:",(function(t){return t.theme.fontSizeMedium}),";padding:",Object(F.a)(1.5)," ",Object(F.a)(2)," ",Object(F.a)(1.5)," 0;"),_t=Pt,qt=n(1869),Ut=n(2660),zt=n.n(Ut);function Gt(t){var e=t.actions;return Object(mt.f)(qt.a,{image:Object(mt.f)(Mt,{src:zt.a})},Object(mt.f)("h3",null,Object(A.b)("More signal, less noise")),Object(mt.f)("p",null,Object(A.b)("Not every error is worth an email. Set your own rules for alerts you need, with information that helps.")),Object(mt.f)(Vt,{gap:1},e))}Gt.displayName="Onboarding";var Mt=Object(h.a)("img",{target:"e1ljbtxe0",label:"AlertsImage"})("@media (min-width:",(function(t){return t.theme.breakpoints[0]}),"){user-select:none;position:absolute;top:0;bottom:0;width:220px;margin-top:auto;margin-bottom:auto;transform:translateX(-50%);left:50%;}@media (min-width:",(function(t){return t.theme.breakpoints[2]}),"){transform:translateX(-60%);width:280px;}@media (min-width:",(function(t){return t.theme.breakpoints[3]}),"){transform:translateX(-75%);width:320px;}"),Vt=Object(h.a)(U.a,{target:"e1ljbtxe1",label:"ButtonList"})({name:"1tuvsuv",styles:"grid-template-columns:repeat(auto-fit,minmax(130px,max-content));"}),Bt=Gt;function Ht(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ht(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Wt(t){return function(){var e,n=m()(t);if(Qt()){var r=m()(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return j()(this,e)}}function Qt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Yt="https://docs.sentry.io/workflow/alerts-notifications/alerts/?_ga=2.21848383.580096147.1592364314-1444595810.1582160976";function Kt(t){return["open","closed"].includes(t)?t:"open"}var Xt=function(t){p()(r,t);var e,n=Wt(r);function r(){var t;l()(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return(t=n.call.apply(n,[this].concat(a))).handleNavigateToSettings=function(e){var n=t.props,r=n.router,a=n.params;e.preventDefault(),Object(N.a)("/settings/".concat(a.orgId,"/projects/:projectId/alerts/"),r)},t}return f()(r,[{key:"getEndpoints",value:function(){var t=this.props,e=t.params,n=t.location.query,r=Kt(n.status);return[["incidentList","/organizations/".concat(e&&e.orgId,"/incidents/"),{query:Ft({},n,{status:r})}]]}},{key:"onLoadAllEndpointsSuccess",value:(e=o()(a.a.mark((function t(){var e,n,r,i,o,c,s,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===this.state.incidentList.length){t.next=4;break}return this.setState({hasAlertRule:!0,firstVisitShown:!1}),t.abrupt("return");case 4:return this.setState({loading:!0}),n=this.props,r=n.params,i=n.location,o=n.organization,t.next=8,this.api.requestPromise("/organizations/".concat(null==r?void 0:r.orgId,"/alert-rules/"),{method:"GET",query:i.query});case 8:if(c=t.sent,!(s=c.length>0)){t.next=13;break}return this.setState({hasAlertRule:s,firstVisitShown:!1,loading:!1}),t.abrupt("return");case 13:return t.next=15,this.api.requestPromise("/promptsactivity/",{query:{organization_id:o.id,feature:"alert_stream"}});case 15:u=t.sent,(l=!(null==u?void 0:null===(e=u.data)||void 0===e?void 0:e.dismissed_ts))&&Object(X.a)(this.api,{feature:"alert_stream",organizationId:o.id,status:"dismissed"}),this.setState({hasAlertRule:s,firstVisitShown:l,loading:!1});case 19:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"tryRenderOnboarding",value:function(){if(!this.state.firstVisitShown)return null;var t=Object(mt.f)(E.a.Fragment,null,Object(mt.f)(q.a,{size:"small",external:!0,href:Yt},Object(A.b)("View Features")),Object(mt.f)(Zt,this.props));return Object(mt.f)(Bt,{actions:t})}},{key:"tryRenderEmpty",value:function(){var t=this.state,e=t.hasAlertRule,n=t.incidentList,r=Kt(this.props.location.query.status);return n.length>0?null:Object(mt.f)(z.a,{size:"medium",icon:Object(mt.f)(P.j,{isCircled:!0,size:"48"}),title:e?"open"===r?Object(A.b)("Everything’s a-okay. There are no unresolved metric alerts in these projects."):Object(A.b)("There are no resolved metric alerts in these projects."):Object(A.b)("No metric alert rules exist for these projects."),description:Object(A.c)("Learn more about [link:Metric Alerts]",{link:Object(mt.f)(G.a,{href:Yt})})})}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderList",value:function(){var t,e,n=this.state,r=n.loading,a=n.incidentList,i=n.incidentListPageLinks,o=n.hasAlertRule,c=this.props.params.orgId,s=new Set(R()(null==a?void 0:a.map((function(t){return t.projects})))),u=!(!a||0!==a.length||void 0!==o),l=r||u,d=Kt(this.props.location.query.status);return Object(mt.f)(E.a.Fragment,null,null!==(t=this.tryRenderOnboarding())&&void 0!==t?t:Object(mt.f)(I.a,null,!r&&Object(mt.f)(ee,null,Object(mt.f)(J,{status:d},Object(mt.f)(te,{status:d},Object(mt.f)("div",null,Object(A.b)("Alert")),"open"===d&&Object(mt.f)("div",null,Object(A.b)("Graph"))),Object(mt.f)("div",null,Object(A.b)("Project")),Object(mt.f)("div",null,Object(A.b)("Triggered")),"closed"===d&&Object(mt.f)("div",null,Object(A.b)("Duration")),"closed"===d&&Object(mt.f)("div",null,Object(A.b)("Resolved")))),l?Object(mt.f)(M.default,null):null!==(e=this.tryRenderEmpty())&&void 0!==e?e:Object(mt.f)(I.c,null,Object(mt.f)(H.a,{orgId:c,slugs:Array.from(s)},(function(t){var e=t.initiallyLoaded,n=t.projects;return a.map((function(t){return Object(mt.f)(_t,{key:t.id,projectsLoaded:e,projects:n,incident:t,orgId:c,filteredStatus:d})}))})))),Object(mt.f)(B.a,{pageLinks:i}))}},{key:"renderBody",value:function(){var t=this.state,e=t.loading,n=t.firstVisitShown,r=this.props,a=r.params,i=r.location,o=r.organization,c=i.pathname,s=i.query,u=a.orgId,l=w()(Ft({},s,{status:"open"}),"cursor"),d=w()(Ft({},s,{status:"closed"}),"cursor"),f=Kt(s.status);return Object(mt.f)(y.a,{title:"Alerts- ".concat(u," - Sentry")},Object(mt.f)(K.a,{organization:o,showDateSelector:!1},Object(mt.f)(D.b,null,Object(mt.f)(D.c,null,Object(mt.f)($t,null,Object(A.b)("Alerts")," ",Object(mt.f)(_.a,{type:"beta"})),e||n?Object(mt.f)(ne,null,null):Object(mt.f)(ne,{gap:1},Object(mt.f)(Zt,this.props),Object(mt.f)(q.a,{onClick:this.handleNavigateToSettings,href:"#",size:"small",icon:Object(mt.f)(P.ob,{size:"xs"})},Object(A.b)("View Rules")),Object(mt.f)(U.a,{merged:!0,active:f},Object(mt.f)(q.a,{to:{pathname:c,query:l},barId:"open",size:"small"},Object(A.b)("Active")),Object(mt.f)(q.a,{to:{pathname:c,query:d},barId:"closed",size:"small"},Object(A.b)("Resolved"))))),Object(mt.f)(C.b,{type:"info",icon:Object(mt.f)(P.K,{size:"md"})},Object(A.c)("This page is in beta and currently only shows [link:metric alerts]. [contactLink:Please contact us if you have any feedback.]",{link:Object(mt.f)(G.a,{onClick:function(){return t=o,Object(x.e)({eventKey:"alert_stream.documentation_clicked",eventName:"Alert Stream: Documentation Clicked",organization_id:t.id,user_id:Y.default.get("user").id});var t},href:Yt}),contactLink:Object(mt.f)(G.a,{href:"mailto:alerting-feedback@sentry.io"},Object(A.b)("Please contact us if you have any feedback."))})),this.renderList())))}}]),r}(L.a),Jt=function(t){p()(n,t);var e=Wt(n);function n(){return l()(this,n),e.apply(this,arguments)}return f()(n,[{key:"componentDidMount",value:function(){this.trackView()}},{key:"componentDidUpdate",value:function(t){var e,n;(null===(e=t.location.query)||void 0===e?void 0:e.status)!==(null===(n=this.props.location.query)||void 0===n?void 0:n.status)&&this.trackView()}},{key:"trackView",value:function(){var t=this.props,e=t.location,n=t.organization,r=Kt(e.query.status);Object(x.e)({eventKey:"alert_stream.viewed",eventName:"Alert Stream: Viewed",organization_id:n.id,status:r})}},{key:"render",value:function(){return Object(mt.f)(Xt,this.props)}}]),n}(E.a.Component);Jt.displayName="IncidentsListContainer";var Zt=function(t){var e=t.router,n=t.params,r=t.organization;return Object(mt.f)(Q.a,{organization:r,access:["project:write"]},(function(t){var r=t.hasAccess;return Object(mt.f)(q.a,{disabled:!r,title:r?void 0:Object(A.b)("Users with admin permission or higher can create alert rules."),onClick:function(t){t.preventDefault(),Object(N.a)("/settings/".concat(n.orgId,"/projects/:projectId/alerts/new/?referrer=alert_stream"),e)},priority:"primary",href:"#",size:"small",icon:Object(mt.f)(P.b,{isCircled:!0,size:"xs"})},Object(A.b)("Add Alert Rule"))}))};Zt.displayName="AddAlertRuleButton";var $t=Object(h.a)(V.a,{target:"ebw9n8a0",label:"StyledPageHeading"})({name:"70qvj9",styles:"display:flex;align-items:center;"}),te=Object(h.a)(Z,{target:"ebw9n8a1",label:"PaddedTitleAndSparkLine"})("padding-left:",Object(F.a)(2),";"),ee=Object(h.a)(I.e,{target:"ebw9n8a2",label:"StyledPanelHeader"})("padding:",Object(F.a)(1.5)," ",Object(F.a)(2)," ",Object(F.a)(1.5)," 0;"),ne=Object(h.a)(U.a,{target:"ebw9n8a3",label:"Actions"})({name:"xgff9b",styles:"height:32px;"});e.default=Object(W.a)(Jt)}}]);
//# sourceMappingURL=AlertsList.js.map
{"version":3,"sources":["webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/components/settingsPageHeader.tsx","webpack:///./app/components/dateTime.tsx","webpack:///./app/views/settings/account/apiTokenRow.jsx","webpack:///./app/views/settings/account/apiTokens.jsx"],"names":["getTitle","render","title","this","renderComponent","icon","action","tabs","noTitleStyles","props","TitleAndActions","Icon","Title","styled","Action","propTypes","node","isRequired","bool","defaultProps","Component","p","StyledSettingsPageHeading","SettingsPageHeading","getFormat","clock24Hours","dateOnly","timeOnly","seconds","shortDate","date","utc","user","get","options","format","carriedProps","tz","timezone","any","ApiTokenRow","handleRemove","onRemove","token","StyledPanelItem","Controls","InputWrapper","getDynamicText","value","fixed","size","onClick","t","Details","ScopesWrapper","Heading","ScopeList","scopes","join","Time","dateCreated","Date","React","PanelItem","space","theme","fontSizeRelativeSmaller","fontSizeMedium","gray3","ApiTokens","handleRemoveToken","addLoadingMessage","oldTokenList","state","tokenList","setState","filter","tk","a","async","api","requestPromise","method","data","addSuccessMessage","addErrorMessage","loading","error","isEmpty","length","priority","to","data-test-id","tct","link","href","map","key","AsyncView"],"mappings":"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","file":"ApiTokensIndex.js","sourcesContent":["import DocumentTitle from 'react-document-title';\nimport React from 'react';\n\nimport AsyncComponent from 'app/components/asyncComponent';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    const title = this.getTitle();\n    return (\n      <DocumentTitle title={`${title ? `${title} - ` : ''}Sentry`}>\n        {this.renderComponent()}\n      </DocumentTitle>\n    );\n  }\n}\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styled from 'react-emotion';\n\nimport space from 'app/styles/space';\nimport {HeaderTitle} from 'app/styles/organization';\n\ntype Props = {\n  // The title\n  title: React.ReactNode;\n\n  // Disables font styles in the title. Allows for more custom titles.\n  noTitleStyles?: boolean;\n\n  className?: string;\n\n  // Icon left of title\n  icon?: React.ReactNode;\n\n  // Actions on opposite end of title bar from the title\n  action?: React.ReactNode;\n\n  tabs?: React.ReactNode;\n};\n\nclass SettingsPageHeading extends React.Component<Props> {\n  static propTypes = {\n    icon: PropTypes.node,\n    title: PropTypes.node.isRequired,\n    action: PropTypes.node,\n    tabs: PropTypes.node,\n    // Disables font styles in the title. Allows for more custom titles.\n    noTitleStyles: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    noTitleStyles: false,\n  };\n\n  render() {\n    const {icon, title, action, tabs, noTitleStyles, ...props} = this.props;\n    return (\n      <div {...props}>\n        <TitleAndActions>\n          {icon && <Icon>{icon}</Icon>}\n          {title && (\n            <Title tabs={tabs} styled={noTitleStyles}>\n              <HeaderTitle>{title}</HeaderTitle>\n            </Title>\n          )}\n          {action && <Action tabs={tabs}>{action}</Action>}\n        </TitleAndActions>\n\n        {tabs && <div>{tabs}</div>}\n      </div>\n    );\n  }\n}\n\ntype TitleProps = {\n  styled?: boolean;\n  tabs?: React.ReactNode;\n};\n\nconst TitleAndActions = styled('div')`\n  display: flex;\n  align-items: center;\n`;\n\nconst Title = styled('div')<TitleProps & React.HTMLProps<HTMLDivElement>>`\n  ${p =>\n    !p.styled &&\n    `\n    font-size: 20px;\n    font-weight: bold;`};\n  margin: ${p => (p.tabs ? `${space(4)} 0 ${space(2)}` : `${space(4)} 0`)};\n  flex: 1;\n`;\n\nconst Icon = styled('div')`\n  margin-right: ${space(1)};\n`;\n\nconst Action = styled('div')<{tabs?: React.ReactNode}>`\n  ${p => (p.tabs ? `margin-top: ${space(2)}` : null)};\n`;\n\nconst StyledSettingsPageHeading = styled(SettingsPageHeading)<\n  Omit<React.HTMLProps<HTMLDivElement>, keyof Props> & Props\n>`\n  font-size: 14px;\n  margin-top: -${space(4)};\n`;\n\nexport default StyledSettingsPageHeading;\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport moment from 'moment-timezone';\n\nimport ConfigStore from 'app/stores/configStore';\n\ntype Props = {\n  date: moment.MomentInput;\n  dateOnly?: boolean;\n  timeOnly?: boolean;\n  shortDate?: boolean;\n  seconds?: boolean;\n  utc?: boolean;\n};\n\nclass DateTime extends React.Component<Props> {\n  static propTypes = {\n    date: PropTypes.any.isRequired,\n    dateOnly: PropTypes.bool,\n    timeOnly: PropTypes.bool,\n    shortDate: PropTypes.bool,\n    seconds: PropTypes.bool,\n    utc: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    seconds: true,\n  };\n\n  getFormat = ({clock24Hours}: {clock24Hours: boolean}): string => {\n    const {dateOnly, timeOnly, seconds, shortDate} = this.props;\n\n    // October 26, 2017\n    if (dateOnly) {\n      return 'LL';\n    }\n\n    // 4:57 PM\n    if (timeOnly) {\n      return 'LT';\n    }\n\n    if (shortDate) {\n      return 'MM/DD/YYYY';\n    }\n\n    if (clock24Hours) {\n      return 'MMMM D YYYY HH:mm:ss z';\n    }\n\n    // Oct 26, 2017 11:30:30 AM\n    if (seconds) {\n      return 'll LTS z';\n    }\n\n    // Default is Oct 26, 2017 11:30 AM\n    return 'lll';\n  };\n\n  render() {\n    const {\n      date,\n      seconds, // eslint-disable-line no-unused-vars\n      shortDate, // eslint-disable-line no-unused-vars\n      dateOnly, // eslint-disable-line no-unused-vars\n      utc,\n      timeOnly: _timeOnly, // eslint-disable-line no-unused-vars\n      ...carriedProps\n    } = this.props;\n    const user = ConfigStore.get('user');\n    const options = user ? user.options : {};\n    const format = this.getFormat(options);\n\n    return (\n      <time {...carriedProps}>\n        {utc\n          ? moment.utc(date).format(format)\n          : moment.tz(date, options.timezone).format(format)}\n      </time>\n    );\n  }\n}\n\nexport default DateTime;\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styled from 'react-emotion';\n\nimport {PanelItem} from 'app/components/panels';\nimport {t} from 'app/locale';\nimport Button from 'app/components/button';\nimport DateTime from 'app/components/dateTime';\nimport TextCopyInput from 'app/views/settings/components/forms/textCopyInput';\nimport getDynamicText from 'app/utils/getDynamicText';\nimport space from 'app/styles/space';\n\nclass ApiTokenRow extends React.Component {\n  static propTypes = {\n    token: PropTypes.object.isRequired,\n    onRemove: PropTypes.func.isRequired,\n  };\n\n  handleRemove = () => {\n    const {onRemove, token} = this.props;\n    onRemove(token);\n  };\n\n  render() {\n    const {token} = this.props;\n\n    return (\n      <StyledPanelItem>\n        <Controls>\n          <InputWrapper>\n            <TextCopyInput>\n              {getDynamicText({value: token.token, fixed: 'PERCY_AUTH_TOKEN'})}\n            </TextCopyInput>\n          </InputWrapper>\n          <Button size=\"small\" onClick={this.handleRemove} icon=\"icon-circle-subtract\">\n            {t('Remove')}\n          </Button>\n        </Controls>\n\n        <Details>\n          <ScopesWrapper>\n            <Heading>{t('Scopes')}</Heading>\n            <ScopeList>{token.scopes.join(', ')}</ScopeList>\n          </ScopesWrapper>\n          <div>\n            <Heading>{t('Created')}</Heading>\n            <Time>\n              <DateTime\n                date={getDynamicText({\n                  value: token.dateCreated,\n                  fixed: new Date(1508208080000), //National Pasta Day\n                })}\n              />\n            </Time>\n          </div>\n        </Details>\n      </StyledPanelItem>\n    );\n  }\n}\n\nconst StyledPanelItem = styled(PanelItem)`\n  flex-direction: column;\n  padding: ${space(2)};\n`;\n\nconst Controls = styled('div')`\n  display: flex;\n  align-items: center;\n  margin-bottom: ${space(1)};\n`;\n\nconst InputWrapper = styled('div')`\n  font-size: ${p => p.theme.fontSizeRelativeSmaller};\n  flex: 1;\n  margin-right: ${space(1)};\n`;\n\nconst Details = styled('div')`\n  display: flex;\n  margin-top: ${space(1)};\n`;\n\nconst ScopesWrapper = styled('div')`\n  flex: 1;\n`;\n\nconst ScopeList = styled('div')`\n  font-size: ${p => p.theme.fontSizeRelativeSmaller};\n  line-height: 1.4;\n`;\n\nconst Time = styled('time')`\n  font-size: ${p => p.theme.fontSizeRelativeSmaller};\n  line-height: 1.4;\n`;\n\nconst Heading = styled('div')`\n  font-size: ${p => p.theme.fontSizeMedium};\n  text-transform: uppercase;\n  color: ${p => p.theme.gray3};\n  margin-bottom: ${space(1)};\n`;\n\nexport default ApiTokenRow;\n","import React from 'react';\n\nimport {Panel, PanelBody, PanelHeader} from 'app/components/panels';\nimport {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n} from 'app/actionCreators/indicator';\nimport {t, tct} from 'app/locale';\nimport ApiTokenRow from 'app/views/settings/account/apiTokenRow';\nimport AsyncView from 'app/views/asyncView';\nimport Button from 'app/components/button';\nimport EmptyMessage from 'app/views/settings/components/emptyMessage';\nimport SettingsPageHeader from 'app/views/settings/components/settingsPageHeader';\nimport TextBlock from 'app/views/settings/components/text/textBlock';\n\nclass ApiTokens extends AsyncView {\n  getTitle() {\n    return t('API Tokens');\n  }\n\n  getDefaultState() {\n    return {\n      loading: true,\n      error: false,\n      tokenList: [],\n    };\n  }\n\n  getEndpoints() {\n    return [['tokenList', '/api-tokens/']];\n  }\n\n  handleRemoveToken = token => {\n    addLoadingMessage();\n    const oldTokenList = this.state.tokenList;\n\n    this.setState(\n      state => ({\n        tokenList: state.tokenList.filter(tk => tk.token !== token.token),\n      }),\n      async () => {\n        try {\n          await this.api.requestPromise('/api-tokens/', {\n            method: 'DELETE',\n            data: {token: token.token},\n          });\n\n          addSuccessMessage(t('Removed token'));\n        } catch (_err) {\n          addErrorMessage(t('Unable to remove token. Please try again.'));\n          this.setState({\n            tokenList: oldTokenList,\n          });\n        }\n      }\n    );\n  };\n\n  renderBody() {\n    const {tokenList} = this.state;\n\n    const isEmpty = tokenList.length === 0;\n\n    const action = (\n      <Button\n        priority=\"primary\"\n        size=\"small\"\n        to=\"/settings/account/api/auth-tokens/new-token/\"\n        data-test-id=\"create-token\"\n      >\n        {t('Create New Token')}\n      </Button>\n    );\n\n    return (\n      <div>\n        <SettingsPageHeader title=\"Auth Tokens\" action={action} />\n        <TextBlock>\n          {t(\n            \"Authentication tokens allow you to perform actions against the Sentry API on behalf of your account. They're the easiest way to get started using the API.\"\n          )}\n        </TextBlock>\n        <TextBlock>\n          {tct(\n            'For more information on how to use the web API, see our [link:documentation].',\n            {\n              link: <a href=\"https://docs.sentry.io/hosted/api/\" />,\n            }\n          )}\n        </TextBlock>\n        <TextBlock>\n          <small>\n            psst. Looking for the <strong>DSN</strong> for an SDK? You'll find that under{' '}\n            <strong>[Project] » Settings » Client Keys</strong>.\n          </small>\n        </TextBlock>\n        <Panel>\n          <PanelHeader>{t('Auth Token')}</PanelHeader>\n\n          <PanelBody>\n            {isEmpty && (\n              <EmptyMessage>\n                {t(\"You haven't created any authentication tokens yet.\")}\n              </EmptyMessage>\n            )}\n\n            {!isEmpty &&\n              tokenList.map(token => {\n                return (\n                  <ApiTokenRow\n                    key={token.token}\n                    token={token}\n                    onRemove={this.handleRemoveToken}\n                  />\n                );\n              })}\n          </PanelBody>\n        </Panel>\n      </div>\n    );\n  }\n}\n\nexport default ApiTokens;\n"],"sourceRoot":""}
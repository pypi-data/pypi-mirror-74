(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[81],{1629:function(e,t,n){"use strict";var r=n(2),a=n(1),o=n.n(a),i=n(0),s=n.n(i),l=n(93),c=n.n(l),u=n(33),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getFormat=function(e){var n=e.clock24Hours,r=t.props,a=r.dateOnly,o=r.timeOnly,i=r.seconds,s=r.shortDate;return a?"LL":o?"LT":s?"MM/DD/YYYY":n?"MMMM D YYYY HH:mm:ss z":i?"ll LTS z":"lll"},t}return Object(r.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.date,n=(e.seconds,e.shortDate,e.dateOnly,e.utc),a=(e.timeOnly,Object(r.h)(e,["date","seconds","shortDate","dateOnly","utc","timeOnly"])),o=u.default.get("user"),i=o?o.options:{},l=this.getFormat(i);return s.a.createElement("time",Object(r.a)({},a),n?c.a.utc(t).format(l):c.a.tz(t,i.timezone).format(l))},t.propTypes={date:o.a.any.isRequired,dateOnly:o.a.bool,timeOnly:o.a.bool,shortDate:o.a.bool,seconds:o.a.bool,utc:o.a.bool},t.defaultProps={seconds:!0},t}(s.a.Component);t.a=d},1686:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(21),i=n(338);t.a=function(e){var t=e.className,n=e.bytes;return a.a.createElement("span",{className:t},Object(i.a)({value:Object(o.i)(n),fixed:"xx KB"}))}},1733:function(e,t,n){"use strict";var r=n(2),a=n(1),o=n.n(a),i=n(0),s=n.n(i),l=n(33),c=n(86),u=n(53),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.hasAttachmentsRole=function(){var e=l.default.get("user");if(!e)return!1;if(e.isSuperuser)return!0;var t=this.props.organization,n=t.availableRoles,r=t.attachmentsRole,a=t.role;if(!Array.isArray(n))return!1;var o=n.map((function(e){return e.id})),i=o.indexOf(r);return o.indexOf(a||"")>=i},t.prototype.getDownloadUrl=function(){var e=this.props,t=e.attachment,n=e.organization,r=e.eventId,a=e.projectId;return"/api/0/projects/"+n.slug+"/"+a+"/events/"+r+"/attachments/"+t.id+"/"},t.prototype.render=function(){return(0,this.props.children)(this.hasAttachmentsRole()?this.getDownloadUrl():null)},t.propTypes={organization:u.b.Organization.isRequired,projectId:o.a.string.isRequired,eventId:o.a.string.isRequired,attachment:u.b.EventAttachment.isRequired,children:o.a.func.isRequired},t}(s.a.PureComponent);t.a=Object(c.a)(d)},1771:function(e,t,n){"use strict";var r,a=n(2),o=n(0),i=n.n(o),s=n(3),l=n(4),c=n(27),u=n(11),d=n(252),p=n(61),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDelete=function(){return Object(a.b)(t,void 0,void 0,(function(){var e,t,n,r,o;return Object(a.e)(this,(function(a){switch(a.label){case 0:if(e=this.props,t=e.api,n=e.url,r=e.onDelete,o=e.attachmentId,!n)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.requestPromise(n,{method:"DELETE"})];case 2:return a.sent(),r(o),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},t}return Object(a.d)(t,e),t.prototype.render=function(){var e=this.props.url;return i.a.createElement(i.a.Fragment,null,i.a.createElement(h,{size:"xsmall",icon:"icon-download",href:e?e+"?download=1":"",disabled:!e,title:e?void 0:Object(l.b)("Insufficient permissions to download attachments")},Object(l.b)("Download")),i.a.createElement(d.a,{confirmText:Object(l.b)("Delete"),message:Object(l.b)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:this.handleDelete,disabled:!e},i.a.createElement(c.a,{size:"xsmall",icon:"icon-trash",disabled:!e,priority:"danger",title:e?void 0:Object(l.b)("Insufficient permissions to delete attachments")})))},t}(i.a.Component),h=Object(s.c)(c.a,{target:"ewomrm90"})(r||(r=Object(a.f)(["\n  margin-right: ",";\n"],["\n  margin-right: ",";\n"])),Object(u.a)(.5));t.a=Object(p.a)(m)},1835:function(e,t,n){var r=n(291),a=n(149);e.exports=function(e){return a(e)&&r(e)}},2315:function(e,t,n){var r=n(809),a=n(801),o=n(2316),i=n(1835),s=a((function(e){return o(r(e,i))}));e.exports=s},2316:function(e,t,n){var r=n(2317),a=n(457),o=n(596);e.exports=function(e,t,n){var i=e.length;if(i<2)return i?o(e[0]):[];for(var s=-1,l=Array(i);++s<i;)for(var c=e[s],u=-1;++u<i;)u!=s&&(l[s]=r(l[s]||c,e[u],t,n));return o(a(l,1),t,n)}},2317:function(e,t,n){var r=n(604),a=n(805),o=n(900),i=n(292),s=n(298),l=n(605),c=200;e.exports=function(e,t,n,u){var d=-1,p=a,m=!0,h=e.length,f=[],b=t.length;if(!h)return f;n&&(t=i(t,s(n))),u?(p=o,m=!1):t.length>=c&&(p=l,m=!1,t=new r(t));e:for(;++d<h;){var y=e[d],v=null==n?y:n(y);if(y=u||0!==y?y:0,m&&v==v){for(var g=b;g--;)if(t[g]===v)continue e;f.push(y)}else p(t,v,u)||f.push(y)}return f}},2648:function(e,t,n){"use strict";n.r(t);var r,a,o,i=n(2),s=n(0),l=n.n(s),c=n(146),u=n.n(c),d=n(250),p=n(4),m=n(61),h=n(575),f=n(3),b=n(98),y=n(1629),v=n(1686),g=n(1733),O=n(1771),j={"event.minidump":Object(p.b)("Minidump"),"event.applecrashreport":Object(p.b)("Apple Crash Report"),"event.attachment":Object(p.b)("Other")},E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.d)(t,e),t.prototype.getEventUrl=function(){var e=this.props,t=e.attachment;return"/organizations/"+e.orgId+"/issues/"+e.groupId+"/events/"+t.event_id+"/"},t.prototype.getAttachmentTypeDisplayName=function(e){return j[e]||Object(p.b)("Other")},t.prototype.render=function(){var e=this.props,t=e.attachment,n=e.projectId,r=e.onDelete,a=e.isDeleted;return l.a.createElement(D,{isDeleted:a},l.a.createElement("td",null,l.a.createElement("h5",null,t.name,l.a.createElement("br",null),l.a.createElement("small",null,l.a.createElement(y.a,{date:t.dateCreated})," Â·"," ",l.a.createElement(b.a,{to:this.getEventUrl()},t.event_id)))),l.a.createElement("td",null,this.getAttachmentTypeDisplayName(t.type)),l.a.createElement("td",null,l.a.createElement(v.a,{bytes:t.size})),l.a.createElement("td",null,l.a.createElement(g.a,{projectId:n,eventId:t.event_id,attachment:t},(function(e){return!a&&l.a.createElement(O.a,{url:e,onDelete:r,attachmentId:t.id})}))))},t}(l.a.Component),D=Object(f.c)("tr",{target:"ekv38qo0"})(r||(r=Object(i.f)(["\n  opacity: ",";\n  td {\n    text-decoration: ",";\n  }\n"],["\n  opacity: ",";\n  td {\n    text-decoration: ",";\n  }\n"])),(function(e){return e.isDeleted?.3:1}),(function(e){return e.isDeleted?"line-through":"normal"})),I=E,A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.attachments,n=e.orgId,r=e.projectId,a=e.groupId,o=e.onDelete,i=e.deletedAttachments,s=[Object(p.b)("Name"),Object(p.b)("Type"),Object(p.b)("Size"),Object(p.b)("Actions")];return l.a.createElement("table",{className:"table events-table"},l.a.createElement("thead",null,l.a.createElement("tr",null,s.map((function(e){return l.a.createElement("th",{key:e},e)})))),l.a.createElement("tbody",null,t.map((function(e){return l.a.createElement(I,{key:e.id,attachment:e,orgId:n,projectId:r,groupId:a,onDelete:o,isDeleted:i.some((function(t){return e.id===t}))})}))))},t}(l.a.Component),R=n(195),x=n.n(R),q=n(2315),w=n.n(q),z=n(5),L=n(11),T=n(766),k=n(27),C=Object(f.c)("div",{target:"eoyp7bi0"})(a||(a=Object(i.f)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: ",";\n"],["\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: ",";\n"])),Object(L.a)(3)),N=Object(f.c)(T.a,{target:"eoyp7bi1"})(o||(o=Object(i.f)(["\n  & > a:first-child:not(:last-child) {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n  & > a:last-child:not(:first-child) {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n  }\n"],["\n  & > a:first-child:not(:last-child) {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n  & > a:last-child:not(:first-child) {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n  }\n"]))),M=Object(z.withRouter)((function(e){var t=e.location,n=t.query,r=t.pathname,a=n.types,o=["event.minidump","event.applecrashreport"],s=x()(n,"types"),c=Object(i.a)(Object(i.a)({},n),{types:o});return l.a.createElement(C,null,l.a.createElement(N,null,l.a.createElement(k.a,{size:"small",to:{pathname:r,query:s},priority:void 0===a?"primary":"default"},Object(p.b)("All Attachments")),l.a.createElement(k.a,{size:"small",to:{pathname:r,query:c},priority:0===w()(o,a).length?"primary":"default"},Object(p.b)("Only Crash Reports"))))})),S=n(159),Y=n(50),U=n(572),H=n(628),B=n(147),F=n(585);n.d(t,"GroupEventAttachments",(function(){return P}));var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={eventAttachmentsList:[],deletedAttachments:[],loading:!0,error:null,pageLinks:null},t.handleDelete=function(e){t.setState((function(t){return{deletedAttachments:Object(i.i)(t.deletedAttachments,[e])}}))},t.fetchData=function(){t.setState({loading:!0,error:null});var e=Object(i.a)(Object(i.a)({},u()(t.props.location.query,["cursor","environment","types"])),{limit:50});t.props.api.request("/issues/"+t.props.params.groupId+"/attachments/",{query:e,method:"GET",success:function(e,n,r){t.setState((function(t){return{eventAttachmentsList:e,error:null,loading:!1,pageLinks:r?r.getResponseHeader("Link"):t.pageLinks}}))},error:function(e){t.setState({error:Object(H.a)(e),loading:!1})}})},t}return Object(i.d)(t,e),t.prototype.componentWillMount=function(){this.fetchData()},t.prototype.componentDidUpdate=function(e){this.props.location.search!==e.location.search&&this.fetchData()},t.prototype.renderNoQueryResults=function(){return l.a.createElement(h.a,null,l.a.createElement("p",null,Object(p.b)("Sorry, no event attachments match your search query.")))},t.prototype.renderEmpty=function(){return l.a.createElement(h.a,null,l.a.createElement("p",null,Object(p.b)("There don't seem to be any event attachments yet.")))},t.prototype.renderResults=function(){var e=this.props,t=e.group,n=e.params,r=this.state,a=r.eventAttachmentsList,o=r.deletedAttachments;return l.a.createElement(A,{attachments:a,orgId:n.orgId,projectId:t.project.slug,groupId:n.groupId,onDelete:this.handleDelete,deletedAttachments:o})},t.prototype.renderBody=function(){return this.state.loading?l.a.createElement(Y.default,null):this.state.error?l.a.createElement(S.a,{message:this.state.error,onRetry:this.fetchData}):this.state.eventAttachmentsList.length>0?this.renderResults():this.props.location.query.types?this.renderNoQueryResults():this.renderEmpty()},t.prototype.render=function(){return l.a.createElement(B.a,{features:["event-attachments"],renderDisabled:function(){return l.a.createElement(F.a,null)}},l.a.createElement(M,null),l.a.createElement(d.a,{className:"event-list"},l.a.createElement(d.c,null,this.renderBody())),l.a.createElement(U.a,{pageLinks:this.state.pageLinks}))},t}(l.a.Component);t.default=Object(m.a)(P)}}]);
//# sourceMappingURL=GroupEventAttachments.js.map
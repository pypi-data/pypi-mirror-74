(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[25,85],{1610:function(e,t,n){"use strict";var r=n(2),a=n(251),o=n.n(a),i=n(0),c=n.n(i),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.getTitle=function(){return""},t.prototype.render=function(){var e=this.getTitle();return c.a.createElement(o.a,{title:(e?e+" - ":"")+"Sentry"},this.renderComponent())},t}(n(1609).a);t.a=l},1632:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(251),i=n.n(o);t.a=function(e){var t=e.title+" - "+e.objSlug+" - Sentry";return a.a.createElement(i.a,{title:t},e.children)}},1755:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(21),a="none",o="(No Environment)";function i(e){return encodeURIComponent(e.name)||a}function c(e){return Object(r.u)(e.name)||o}},1808:function(e,t,n){"use strict";var r,a,o,i,c,l=n(2),u=n(0),s=n.n(u),d=n(3),b=n(138),h=n(120),p=Object(d.c)("button",{target:"e1r42lk40"})(r||(r=Object(l.f)(["\n  display: flex;\n  padding: 0;\n  width: 1.5em;\n  height: 1.5em;\n  position: relative;\n  border-radius: 50%;\n  align-items: center;\n  justify-content: center;\n  border: 1px solid ",";\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.04);\n  background: none;\n\n  &:focus,\n  &.focus-visible {\n    outline: none;\n    border: 1px solid ",";\n    box-shadow: rgba(209, 202, 216, 0.5) 0 0 0 3px;\n  }\n"],["\n  display: flex;\n  padding: 0;\n  width: 1.5em;\n  height: 1.5em;\n  position: relative;\n  border-radius: 50%;\n  align-items: center;\n  justify-content: center;\n  border: 1px solid ",";\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.04);\n  background: none;\n\n  &:focus,\n  &.focus-visible {\n    outline: none;\n    border: 1px solid ",";\n    box-shadow: rgba(209, 202, 216, 0.5) 0 0 0 3px;\n  }\n"])),(function(e){return e.theme.borderLight}),(function(e){return e.theme.borderDark})),m=function(e){return!["disabled","animate"].includes(e)&&Object(b.a)(e)},f=Object(d.c)("div",{shouldForwardProp:m,target:"e1r42lk41"})(a||(a=Object(l.f)(["\n  display: grid;\n  grid-gap: 0.25em 0.5em;\n  grid-template-columns: max-content auto;\n  align-items: center;\n  cursor: ",";\n  margin-top: ",";\n  outline: none;\n"],["\n  display: grid;\n  grid-gap: 0.25em 0.5em;\n  grid-template-columns: max-content auto;\n  align-items: center;\n  cursor: ",";\n  margin-top: ",";\n  outline: none;\n"])),(function(e){return e.disabled?"default":"pointer"}),(function(e){return e.index>0?"0.5em":"0"})),g=Object(d.c)("div",{shouldForwardProp:m,target:"e1r42lk42"})(o||(o=Object(l.f)(["\n  width: 1rem;\n  height: 1rem;\n  border-radius: 50%;\n  background-color: ",";\n  animation: ",";\n  opacity: ",";\n"],["\n  width: 1rem;\n  height: 1rem;\n  border-radius: 50%;\n  background-color: ",";\n  animation: ",";\n  opacity: ",";\n"])),(function(e){return e.theme.green}),(function(e){return e.animate?"0.2s "+h.e+" ease":"none"}),(function(e){return e.disabled?.4:null})),j=Object(d.c)("div",{shouldForwardProp:m,target:"e1r42lk43"})(i||(i=Object(l.f)(["\n  opacity: ",";\n"],["\n  opacity: ",";\n"])),(function(e){return e.disabled?.4:null})),O=Object(d.c)("div",{target:"e1r42lk44"})(c||(c=Object(l.f)(["\n  color: ",";\n  font-size: ",";\n  line-height: 1.4em;\n"],["\n  color: ",";\n  font-size: ",";\n  line-height: 1.4em;\n"])),(function(e){return e.theme.gray2}),(function(e){return e.theme.fontSizeRelativeSmall}));t.a=function(e){var t=e.value,n=e.disabled,r=e.choices,a=e.label,o=e.onChange,i=Object(l.h)(e,["value","disabled","choices","label","onChange"]);return s.a.createElement("div",Object(l.a)({},i,{role:"radiogroup","aria-labelledby":a}),(r||[]).map((function(e,r){var a=Object(l.g)(e,3),i=a[0],c=a[1],u=a[2],d=t===i;return s.a.createElement(f,{key:r,onClick:function(e){return!n&&o(i,e)},role:"radio",index:r,"aria-checked":d,disabled:n},s.a.createElement(p,{type:"button",disabled:n},d&&s.a.createElement(g,{disabled:n,animate:""!==t})),s.a.createElement(j,{disabled:n},c),u&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null),s.a.createElement(O,null,u)))})))}},2023:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),o=n.n(a),i=n(1937),c=n(1618),l=n(2009),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmitSuccess=function(){var e=t.props,n=e.params,r=e.routes,a=e.router,o=e.location;a.push(Object(c.a)("metric-rules/",{params:n,routes:r,location:o,stepBack:-1}))},t}return Object(r.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.project,n=Object(r.h)(e,["project"]);return o.a.createElement(l.a,Object(r.a)({onSubmitSuccess:this.handleSubmitSuccess,rule:Object(r.a)(Object(r.a)({},Object(i.a)()),{projects:[t.slug]})},n))},t}(o.a.Component);t.default=u},2658:function(e,t,n){"use strict";n.r(t);var r,a,o,i,c,l=n(2),u=n(0),s=n.n(u),d=n(250),b=n(4),h=n(1610),p=n(5),m=n(36),f=n.n(m),g=n(3),j=n(24),O=n(51),v=n(1755),y=n(1616),E=n(1728),w=n(418),C=n(611),x=n(2022),S=n(583),P=n(1632),k=n(1687),R=n(1618),A=n(11),F=n(61),T=n(137),D=n(27),N=n(336),q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getChoiceField=function(e,n){var r,a=t.props,o=a.data,i=a.onPropertyChange;return o&&(void 0===o[e]&&n.choices.length?(r=n.initial?n.initial:n.choices[0][0],i(e,r)):r=o[e]),s.a.createElement(z,null,s.a.createElement(T.a,{clearable:!1,placeholder:Object(b.b)("Select integration"),noResultsText:Object(b.b)("No integrations available"),height:"35",name:e,value:r,choices:n.choices,key:e,onChange:function(n){return t.props.onPropertyChange(e,n)}}))},t.getTextField=function(e,n){var r=t.props,a=r.data,o=r.onPropertyChange;return s.a.createElement(I,{type:"text",name:e,value:a&&a[e],placeholder:""+n.placeholder,key:e,onChange:function(t){return o(e,t.target.value)}})},t.getNumberField=function(e,n){var r=t.props,a=r.data,o=r.onPropertyChange;return s.a.createElement(I,{type:"number",name:e,value:a&&a[e],placeholder:""+n.placeholder,key:e,onChange:function(t){return o(e,t.target.value)}})},t.getField=function(e,n){return{choice:t.getChoiceField,number:t.getNumberField,string:t.getTextField}[n.type](e,n)},t}return Object(l.d)(t,e),t.prototype.getComponent=function(){var e=this,t=this.props,n=t.data,r=t.node;if(!r)return null;var a=r.label,o=r.formFields,i=a.split(/({\w+})/).map((function(t){if(!/^{\w+}$/.test(t))return t;var r=t.slice(1,-1);return"value"!==r||!n||"is"!==n.match&&"ns"!==n.match?o&&o.hasOwnProperty(r)?e.getField(r,o[r]):t:null})),c=Object(l.g)(i),u=c[0],d=c.slice(1);return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,u),s.a.createElement(M,null,d))},t.prototype.render=function(){var e=this.props,t=e.data,n=e.onDelete,r=this.getComponent();return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("input",{type:"hidden",name:"id",value:t.id}),r,s.a.createElement("div",null,s.a.createElement(D.a,{onClick:n,type:"button",size:"small",icon:"icon-trash"})))},t}(s.a.Component),z=Object(g.c)("div",{target:"e12cxzh60"})(r||(r=Object(l.f)(["\n  width: 204px;\n"],["\n  width: 204px;\n"]))),I=Object(g.c)(N.a,{target:"e12cxzh61"})(a||(a=Object(l.f)(["\n  width: auto;\n"],["\n  width: auto;\n"]))),M=Object(g.c)("div",{target:"e12cxzh62"})(o||(o=Object(l.f)(["\n  display: grid;\n  grid-gap: ",";\n  grid-auto-flow: column;\n  grid-auto-columns: min-content;\n  align-items: center;\n  white-space: nowrap;\n"],["\n  display: grid;\n  grid-gap: ",";\n  grid-auto-flow: column;\n  grid-auto-columns: min-content;\n  align-items: center;\n  white-space: nowrap;\n"])),Object(A.a)(1)),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getNode=function(e){var n=t.props.nodes;return n?n.find((function(t){return t.id===e})):null},t}return Object(l.d)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.onAddRow,r=t.onDeleteRow,a=t.onPropertyChange,o=t.nodes,i=t.placeholder,c=t.items,l=o?o.filter((function(e){return e.enabled})).map((function(e){return{value:e.id,label:e.label}})):[];return s.a.createElement(s.a.Fragment,null,c&&!!c.length&&s.a.createElement(L,null,c.map((function(t,n){return s.a.createElement(q,{key:n,node:e.getNode(t.id),onDelete:function(){return r(n)},data:t,onPropertyChange:a(n)})}))),s.a.createElement(U,{placeholder:i,onChange:function(e){return n(e?e.value:e)},options:l}))},t}(s.a.Component),U=Object(g.c)(T.a,{target:"e17f2heu0"})(i||(i=Object(l.f)(["\n  width: 100%;\n"],["\n  width: 100%;\n"]))),L=Object(g.c)("div",{target:"e17f2heu1"})(c||(c=Object(l.f)(["\n  display: grid;\n  grid-template-columns: max-content auto min-content;\n  flex-direction: column;\n  align-items: center;\n  margin-bottom: ",";\n  grid-gap: ",";\n"],["\n  display: grid;\n  grid-template-columns: max-content auto min-content;\n  flex-direction: column;\n  align-items: center;\n  margin-bottom: ",";\n  grid-gap: ",";\n"])),Object(A.a)(2),Object(A.a)(1)),_=[["5",Object(b.b)("5 minutes")],["10",Object(b.b)("10 minutes")],["30",Object(b.b)("30 minutes")],["60",Object(b.b)("60 minutes")],["180",Object(b.b)("3 hours")],["720",Object(b.b)("12 hours")],["1440",Object(b.b)("24 hours")],["10080",Object(b.b)("one week")],["43200",Object(b.b)("30 days")]],J=[["all",Object(b.b)("all")],["any",Object(b.b)("any")],["none",Object(b.b)("none")]],W={actionMatch:"all",actions:[],conditions:[],name:"",frequency:30,environment:j.e};function G(e){return e.hasOwnProperty("id")}var H,V,$,K,Q,X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={rule:Object(l.a)({},W),loading:!1,error:null,environments:[]},t.handleSubmit=function(){return Object(l.b)(t,void 0,void 0,(function(){var e,t,n,r,a,o,i,c,u;return Object(l.e)(this,(function(s){switch(s.label){case 0:e=this.state.rule,t=G(e)?e.id+"/":"",n=!t,r=this.props,a=r.project,o=r.organization,i="/projects/"+o.slug+"/"+a.slug+"/rules/"+t,e&&e.environment===j.e&&delete e.environment,Object(O.b)(Object(b.b)("Saving...")),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.props.api.requestPromise(i,{method:n?"POST":"PUT",data:e})];case 2:return c=s.sent(),this.setState({error:null,loading:!1,rule:c}),Object(O.d)(n?Object(b.b)("Created alert rule"):Object(b.b)("Updated alert rule")),p.browserHistory.replace(Object(R.a)("",Object(l.a)(Object(l.a)({},this.props),{stepBack:-1}))),[3,4];case 3:return u=s.sent(),this.setState({error:u.responseJSON||{__all__:"Unknown error"},loading:!1}),Object(O.a)(Object(b.b)("An error occurred")),[3,4];case 4:return[2]}}))}))},t.handleCancel=function(){t.props.router.push(Object(R.a)("",Object(l.a)(Object(l.a)({},t.props),{stepBack:-1})))},t.hasError=function(e){var n=t.state.error;return!!n&&n.hasOwnProperty(e)},t.handleEnvironmentChange=function(e){e===j.e?t.handleChange("environment",null):t.handleChange("environment",e)},t.handleChange=function(e,n){t.setState((function(t){var r=Object(l.a)({},t.rule);return r[e]=n,{rule:r}}))},t.handlePropertyChange=function(e){return function(n){return function(r,a){var o=Object(l.a)({},t.state.rule);o[e][n][r]=a,t.setState({rule:o})}}},t.handleAddRow=function(e){return function(n){t.setState((function(t){var r;return{rule:Object(l.a)(Object(l.a)({},t.rule),((r={})[e]=Object(l.i)(t.rule?t.rule[e]:[],[{id:n}]),r))}}))}},t.handleDeleteRow=function(e){return function(n){t.setState((function(t){var r,a=t.rule?Object(l.i)(t.rule[e]):[];return t.rule&&a.splice(n,1),{rule:Object(l.a)(Object(l.a)({},t.rule),((r={})[e]=a,r))}}))}},t}return Object(l.d)(t,e),t.prototype.componentDidMount=function(){this.fetchData()},t.prototype.fetchData=function(){return Object(l.b)(this,void 0,void 0,(function(){var e,t,n,r,a,o,i,c,u,s;return Object(l.e)(this,(function(d){switch(d.label){case 0:e=this.props,t=e.api,n=e.params,r=n.ruleId,a=n.projectId,o=n.orgId,i=[t.requestPromise("/projects/"+o+"/"+a+"/environments/"),r?t.requestPromise("/projects/"+o+"/"+a+"/rules/"+r+"/"):Promise.resolve(W)],d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return c=l.g.apply(void 0,[d.sent(),2]),u=c[0],s=c[1],this.setState({environments:u,rule:s}),[3,4];case 3:return d.sent(),Object(O.a)(Object(b.b)("Unable to fetch data")),[3,4];case 4:return[2]}}))}))},t.prototype.render=function(){var e=this,t=this.props.params,n=t.projectId,r=t.ruleId,a=this.state.environments,o=Object(l.i)([[j.e,Object(b.b)("All Environments")]],a.map((function(e){return[e.name,Object(v.a)(e)]}))),i=this.state,c=i.rule,u=i.error,h=c||{},p=h.actionMatch,m=h.actions,g=h.conditions,O=h.frequency,y=h.name,E=c&&c.environment?c.environment:j.e,C=r?Object(b.b)("Edit Alert Rule"):Object(b.b)("New Alert Rule");return s.a.createElement(s.a.Fragment,null,s.a.createElement(P.a,{title:C,objSlug:n}),s.a.createElement(Z,{key:G(c)?c.id:void 0,onCancel:this.handleCancel,onSubmit:this.handleSubmit,initialData:c,submitLabel:Object(b.b)("Save Rule")},r&&!this.state.rule&&s.a.createElement(re,null),s.a.createElement(d.a,null,s.a.createElement(d.e,null,Object(b.b)("Configure Rule Conditions")),s.a.createElement(d.c,null,u&&s.a.createElement(w.a,{type:"error"},Object(b.b)("There was an error saving your changes. Make sure all fields are valid and try again.")),s.a.createElement(S.a,{className:f()({error:this.hasError("environment")}),label:Object(b.b)("Environment"),help:Object(b.b)("Choose an environment for these conditions to apply to"),placeholder:Object(b.b)("Select an Environment"),clearable:!1,name:"environment",value:E,choices:o,onChange:function(t){return e.handleEnvironmentChange(t)}}),s.a.createElement(x.a,null,Object(b.b)("Whenever %s of these conditions are met",s.a.createElement(te,null,s.a.createElement(ne,{className:f()({error:this.hasError("actionMatch")}),inline:!1,height:"20",clearable:!1,search:!1,name:"actionMatch",value:p,required:!0,flexibleControlStateSize:!0,choices:J,onChange:function(t){return e.handleChange("actionMatch",t)}})))),this.hasError("conditions")&&s.a.createElement(w.a,{type:"error"},this.state.error.conditions[0]),s.a.createElement(ee,null,s.a.createElement(B,{nodes:this.props.conditions,items:g||[],placeholder:Object(b.b)("Add a condition..."),onPropertyChange:this.handlePropertyChange("conditions"),onAddRow:this.handleAddRow("conditions"),onDeleteRow:this.handleDeleteRow("conditions")})),s.a.createElement(x.a,null,Object(b.b)("Perform these actions")),this.hasError("actions")&&s.a.createElement(w.a,{type:"error"},this.state.error.actions[0]),s.a.createElement(ee,null,s.a.createElement(B,{nodes:this.props.actions,items:m||[],placeholder:Object(b.b)("Add an action..."),onPropertyChange:this.handlePropertyChange("actions"),onAddRow:this.handleAddRow("actions"),onDeleteRow:this.handleDeleteRow("actions")})))),s.a.createElement(d.a,null,s.a.createElement(d.e,null,Object(b.b)("Rate Limit")),s.a.createElement(d.c,null,s.a.createElement(S.a,{label:Object(b.b)("Action Interval"),help:Object(b.b)("Perform these actions once this often for an issue"),clearable:!1,name:"frequency",className:this.hasError("frequency")?" error":"",value:O,required:!0,choices:_,onChange:function(t){return e.handleChange("frequency",t)}}))),s.a.createElement(d.a,null,s.a.createElement(d.e,null,Object(b.b)("Give your rule a name")),s.a.createElement(d.c,null,s.a.createElement(k.a,{label:Object(b.b)("Rule name"),help:Object(b.b)("Give your rule a name so it is easy to manage later"),name:"name",defaultValue:y,required:!0,placeholder:Object(b.b)("My Rule Name"),onChange:function(t){return e.handleChange("name",t)}})))))},t}(s.a.Component),Y=Object(F.a)(X),Z=Object(g.c)(y.a,{target:"e1p49m5u0"})(H||(H=Object(l.f)(["\n  position: relative;\n"],["\n  position: relative;\n"]))),ee=Object(g.c)(C.a,{target:"e1p49m5u1"})(V||(V=Object(l.f)(["\n  flex-direction: column;\n"],["\n  flex-direction: column;\n"]))),te=Object(g.c)("div",{target:"e1p49m5u2"})($||($=Object(l.f)(["\n  margin: 0 ",";\n  width: 72px;\n"],["\n  margin: 0 ",";\n  width: 72px;\n"])),Object(A.a)(1)),ne=Object(g.c)(S.a,{target:"e1p49m5u3"})(K||(K=Object(l.f)(["\n  padding: 0;\n  font-weight: normal;\n  text-transform: none;\n"],["\n  padding: 0;\n  font-weight: normal;\n  text-transform: none;\n"]))),re=Object(g.c)(E.a,{target:"e1p49m5u4"})(Q||(Q=Object(l.f)(["\n  opacity: 0.6;\n  z-index: 1; /* Needed so that it sits above form elements */\n"],["\n  opacity: 0.6;\n  z-index: 1; /* Needed so that it sits above form elements */\n"]))),ae=n(2023),oe=n(1808),ie=n(86),ce=n(581),le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChangeAlertType=function(e){t.setState({alertType:e})},t}return Object(l.d)(t,e),t.prototype.getDefaultState=function(){var t=this.props.location.pathname;return Object(l.a)(Object(l.a)({},e.prototype.getDefaultState.call(this)),{alertType:t.includes("issue-rules")?"issue":t.includes("metric-rules")?"metric":null,configs:null})},t.prototype.getEndpoints=function(){var e=this.props.params;return[["configs","/projects/"+e.orgId+"/"+e.projectId+"/rules/configuration/"]]},t.prototype.renderLoading=function(){return this.renderBody()},t.prototype.renderBody=function(){var e=this.state,t=e.alertType,n=e.configs;return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,null,s.a.createElement(d.e,null,Object(b.b)("Choose an Alert Type")),s.a.createElement(d.c,null,s.a.createElement(C.a,null,s.a.createElement(oe.a,{label:Object(b.b)("Select an Alert Type"),value:this.state.alertType,choices:[["metric",Object(b.b)("Metric Alert"),Object(b.b)("Alert on conditions defined over all events in the project. For example, more than 10 users affected by signup-page errors, database errors exceed 10 per minute, errors seen by our largest customers exceed 500 per hour.")],["issue",Object(b.b)("Issue Alert"),Object(b.b)("Alert when any issue satisfies a set of conditions. For example, a new issue is seen, an issue occurs more than 100 times, an issue affects more than 100 users.")]],onChange:this.handleChangeAlertType})))),"issue"===t?s.a.createElement(Y,Object(l.a)({},this.props,{actions:n&&n.actions,conditions:n&&n.conditions})):"metric"===t?s.a.createElement(ae.default,Object(l.a)({},this.props)):null)},t}(h.a);t.default=Object(ce.a)(Object(ie.a)(le))}}]);
//# sourceMappingURL=ProjectAlertsRuleDetails.js.map
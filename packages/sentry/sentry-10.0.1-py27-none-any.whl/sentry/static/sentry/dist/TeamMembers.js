(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[178],{1690:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"g",(function(){return m})),a.d(t,"f",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return b})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return f}));var r=a(111),n=a(4),o=a(51),c=a(174),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("function"==typeof e[t]){for(var a=arguments.length,r=new Array(a>2?a-2:0),n=2;n<a;n++)r[n-2]=arguments[n];e[t].apply(e,r)}};function i(e,t,a){return r.a.fetchDetails(t.teamId),e.request("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{success:function(e){r.a.fetchDetailsSuccess(t.teamId,e),s(a,"success",e)},error:function(e){r.a.fetchDetailsError(t.teamId,e),s(a,"error",e)}})}function m(e,t){r.a.updateSuccess(e,t)}function u(e,t,a){var n="/teams/".concat(t.orgId,"/").concat(t.teamId,"/");return r.a.update(t.teamId,t.data),e.request(n,{method:"PUT",data:t.data,success:function(e){m(t.teamId,e),s(a,"success",e)},error:function(e){r.a.updateError(t.teamId,e),s(a,"error",e)}})}function d(e,t,a){var n="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),o=Object(c.a)();return r.a.update(o,t.teamId),e.request(n,{method:"POST",data:t.data,success:function(e){r.a.updateSuccess(t.teamId,e),s(a,"success",e)},error:function(e){r.a.updateError(o,t.teamId,e),s(a,"error",e)}})}function b(e,t,a){var n="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),o=Object(c.a)();return r.a.update(o,t.teamId),e.request(n,{method:"DELETE",success:function(e){r.a.updateSuccess(t.teamId,e),s(a,"success",e)},error:function(e){r.a.updateError(o,t.teamId,e),s(a,"error",e)}})}function l(e,t,a,c){return r.a.createTeam(t),e.requestPromise("/organizations/".concat(a.orgId,"/teams/"),{method:"POST",data:t}).then((function(e){return r.a.createTeamSuccess(e),Object(o.d)(Object(n.c)("[team] has been added to the [organization] organization",{team:"#".concat(e.slug),organization:a.orgId})),e}),(function(e){throw r.a.createTeamError(t.slug||t.name,e),Object(o.a)(Object(n.c)("Unable to create [team] in the [organization] organization",{team:"#".concat(t.slug||t.name),organization:a.orgId})),e}))}function f(e,t,a){return r.a.removeTeam(t.teamId),e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{method:"DELETE"}).then((function(e){return r.a.removeTeamSuccess(t.teamId,e),Object(o.d)(Object(n.c)("[team] has been removed from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}),(function(e){throw r.a.removeTeamError(t.teamId,e),Object(o.a)(Object(n.c)("Unable to remove [team] from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}))}},2583:function(e,t,a){"use strict";a.r(t);var r=a(23),n=a.n(r),o=a(6),c=a.n(o),s=a(7),i=a.n(s),m=a(9),u=a.n(m),d=a(8),b=a.n(d),l=a(26),f=a.n(l),p=a(10),h=a.n(p),g=a(105),v=a.n(g),j=a(0),I=a.n(j),O=a(3),y=a(250),M=a(51),w=a(1690),E=a(83),z=a(4),S=a(193),x=a(27),q=a(253),L=a(346),T=a(570),R=a(345),k=a(68),D=a(19),B=a(98),P=a(159),C=a(50),F=a(91),U=a(11),A=a(61),W=a(199),N=a(86),J=function(e){function t(){var e,a;c()(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(a=u()(this,(e=b()(t)).call.apply(e,[this].concat(o)))).state={loading:!0,error:!1,dropdownBusy:!1,teamMemberList:null,orgMemberList:null},a.debouncedFetchMembersRequest=v()((function(e){var t=this;this.setState({dropdownBusy:!0},(function(){return t.fetchMembersRequest(e)}))}),200),a.fetchMembersRequest=function(e){var t,r,o,c,s;return n.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=a.props,r=t.params,o=t.api,c=r.orgId,i.prev=2,i.next=5,n.a.awrap(o.requestPromise("/organizations/".concat(c,"/members/"),{query:{query:e}}));case 5:s=i.sent,a.setState({orgMemberList:s,dropdownBusy:!1}),i.next=13;break;case 9:i.prev=9,i.t0=i.catch(2),Object(M.a)(Object(z.b)("Unable to load organization members."),{duration:2e3}),a.setState({dropdownBusy:!1});case 13:case"end":return i.stop()}}),null,null,[[2,9]])},a.fetchData=function(){var e,t,r,o;return n.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=a.props,t=e.api,r=e.params,c.prev=1,c.next=4,n.a.awrap(t.requestPromise("/teams/".concat(r.orgId,"/").concat(r.teamId,"/members/")));case 4:o=c.sent,a.setState({teamMemberList:o,loading:!1,error:!1}),c.next=11;break;case 8:c.prev=8,c.t0=c.catch(1),a.setState({loading:!1,error:!0,errorResponse:c.t0});case 11:a.fetchMembersRequest("");case 12:case"end":return c.stop()}}),null,null,[[1,8]])},a.addTeamMember=function(e){var t=a.props.params;a.setState({loading:!0}),a.debouncedFetchMembersRequest(""),Object(w.c)(a.props.api,{orgId:t.orgId,teamId:t.teamId,memberId:e.value},{success:function(){var t=a.state.orgMemberList.find((function(t){return t.id===e.value}));a.setState({loading:!1,error:!1,teamMemberList:a.state.teamMemberList.concat([t])}),Object(M.d)(Object(z.b)("Successfully added member to team."))},error:function(){a.setState({loading:!1}),Object(M.a)(Object(z.b)("Unable to add team member."))}})},a.handleMemberFilterChange=function(e){a.setState({dropdownBusy:!0}),a.debouncedFetchMembersRequest(e.target.value)},a.renderDropdown=function(e){if(!(e.has("org:write")||e.has("team:admin")))return I.a.createElement(L.a,{disabled:!0,title:Object(z.b)("You do not have enough permission to add new members"),isOpen:!1,size:"xsmall"},Object(z.b)("Add Member"));var t=new Set(a.state.teamMemberList.map((function(e){return e.id}))),r=(a.state.orgMemberList||[]).filter((function(e){return!t.has(e.id)})).map((function(e){return{searchKey:"".concat(e.name," ").concat(e.email),value:e.id,label:I.a.createElement(K,null,I.a.createElement(G,{user:e,size:24,className:"avatar"}),I.a.createElement(Y,null,e.name||e.email))}})),n=I.a.createElement(Q,null,Object(z.b)("Members"),I.a.createElement(V,{onClick:function(){return Object(E.j)({source:"teams"})},"data-test-id":"invite-member"},Object(z.b)("Invite Member")));return I.a.createElement(q.a,{items:r,onSelect:a.addTeamMember,menuHeader:n,emptyMessage:Object(z.b)("No members"),onChange:a.handleMemberFilterChange,busy:a.state.dropdownBusy,onClose:function(){return a.debouncedFetchMembersRequest("")}},(function(e){var t=e.isOpen;return I.a.createElement(L.a,{isOpen:t,size:"xsmall","data-test-id":"add-member"},Object(z.b)("Add Member"))}))},a.removeButton=function(e){return I.a.createElement(x.a,{size:"small",onClick:a.removeMember.bind(f()(a),e),label:Object(z.b)("Remove")},I.a.createElement(D.a,{src:"icon-circle-subtract",size:"1.25em",style:{marginRight:Object(U.a)(1)}}),Object(z.b)("Remove"))},a}return h()(t,e),i()(t,[{key:"componentWillMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.params;e.params.teamId===t.teamId&&e.params.orgId===t.orgId||this.setState({loading:!0,error:!1},this.fetchData)}},{key:"removeMember",value:function(e){var t=this,a=this.props.params;Object(w.d)(this.props.api,{orgId:a.orgId,teamId:a.teamId,memberId:e.id},{success:function(){t.setState({teamMemberList:t.state.teamMemberList.filter((function(t){return t.id!==e.id}))}),k.a.add(Object(z.b)("Successfully removed member from team."),"success",{duration:2e3})},error:function(){k.a.add(Object(z.b)("There was an error while trying to remove a member from the team."),"error",{duration:2e3})}})}},{key:"render",value:function(){var e=this;if(this.state.loading)return I.a.createElement(C.default,null);if(this.state.error)return I.a.createElement(P.a,{onRetry:this.fetchData});var t=this.props,a=t.params,r=t.organization,n=t.config,o=new Set(r.access),c=o.has("org:write"),s=o.has("team:admin");return I.a.createElement(y.a,null,I.a.createElement(y.e,{hasButtons:!0},I.a.createElement("div",null,Object(z.b)("Members")),I.a.createElement("div",{style:{textTransform:"none"}},this.renderDropdown(o))),this.state.teamMemberList.length?this.state.teamMemberList.map((function(t){var r=t.email===n.user.email,o=c||s||r;return I.a.createElement(H,{key:t.id},I.a.createElement(R.a,{avatarSize:36,member:t,useLink:!0,orgId:a.orgId}),o&&e.removeButton(t))})):I.a.createElement(T.a,{icon:"icon-user",size:"large"},Object(z.b)("This team has no members")))}}]),t}(I.a.Component);J.displayName="TeamMembers";var H=Object(O.c)("div",{target:"e1jyxppj0"})("display:flex;justify-content:space-between;padding:",Object(U.a)(2),";border-bottom:1px solid ",(function(e){return e.theme.borderLight}),";"),K=Object(O.c)("div",{target:"e1jyxppj1"})("font-size:0.875em;display:flex;align-items:center;padding:",Object(U.a)(.5),";"),Y=Object(O.c)("div",{target:"e1jyxppj2"})("flex-shrink:1;min-width:0;",F.a,";"),G=Object(O.c)((function(e){return I.a.createElement(S.a,e)}),{target:"e1jyxppj3"})("min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em;margin-right:",Object(U.a)(.5),";"),Q=Object(O.c)("div",{target:"e1jyxppj4"})("width:250px;font-size:0.875em;padding:",Object(U.a)(1)," 0;text-transform:uppercase;"),V=Object(O.c)(B.a,{target:"e1jyxppj5"})("float:right;text-transform:none;");t.default=Object(W.a)(Object(A.a)(Object(N.a)(J)))}}]);
//# sourceMappingURL=TeamMembers.js.map
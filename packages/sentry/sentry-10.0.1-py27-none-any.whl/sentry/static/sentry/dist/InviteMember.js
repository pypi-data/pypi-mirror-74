(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[91],{1611:function(e,t,a){"use strict";var n,r,s,l,i,o=a(2),c=a(1),m=a.n(c),u=a(0),d=a.n(u),b=a(3),f=a(11),p=a(337),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,a=e.title,n=e.action,r=e.tabs,s=e.noTitleStyles,l=Object(o.h)(e,["icon","title","action","tabs","noTitleStyles"]);return d.a.createElement("div",Object(o.a)({},l),d.a.createElement(h,null,t&&d.a.createElement(y,null,t),a&&d.a.createElement(v,{tabs:r,styled:s},d.a.createElement(p.a,null,a)),n&&d.a.createElement(O,{tabs:r},n)),r&&d.a.createElement("div",null,r))},t.propTypes={icon:m.a.node,title:m.a.node.isRequired,action:m.a.node,tabs:m.a.node,noTitleStyles:m.a.bool},t.defaultProps={noTitleStyles:!1},t}(d.a.Component),h=Object(b.c)("div",{target:"e1uay4fd0"})(n||(n=Object(o.f)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"]))),v=Object(b.c)("div",{target:"e1uay4fd1"})(r||(r=Object(o.f)(["\n  ",";\n  margin: ",";\n  flex: 1;\n"],["\n  ",";\n  margin: ",";\n  flex: 1;\n"])),(function(e){return!e.styled&&"\n    font-size: 20px;\n    font-weight: bold;"}),(function(e){return e.tabs?Object(f.a)(4)+" 0 "+Object(f.a)(2):Object(f.a)(4)+" 0"})),y=Object(b.c)("div",{target:"e1uay4fd2"})(s||(s=Object(o.f)(["\n  margin-right: ",";\n"],["\n  margin-right: ",";\n"])),Object(f.a)(1)),O=Object(b.c)("div",{target:"e1uay4fd3"})(l||(l=Object(o.f)(["\n  ",";\n"],["\n  ",";\n"])),(function(e){return e.tabs?"margin-top: "+Object(f.a)(2):null})),j=Object(b.c)(g,{target:"e1uay4fd4"})(i||(i=Object(o.f)(["\n  font-size: 14px;\n  margin-top: -",";\n"],["\n  font-size: 14px;\n  margin-top: -",";\n"])),Object(f.a)(4));t.a=j},1816:function(e,t,a){"use strict";var n=a(6),r=a.n(n),s=a(7),l=a.n(s),i=a(9),o=a.n(i),c=a(8),m=a.n(c),u=a(10),d=a.n(u),b=a(0),f=a.n(b),p=a(3),g=a(105),h=a.n(g),v=a(4),y=a(27),O=a(252),j=a(98),E=a(250),T=a(253),w=a(346),x=a(570),R=a(11),k=a(61),S=function(e){function t(){var e,a;r()(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=o()(this,(e=m()(t)).call.apply(e,[this].concat(s)))).state={teams:null},a.fetchTeams=h()((function(e){var t=a.props.organization;a.props.api.requestPromise("/organizations/".concat(t.slug,"/teams/"),{query:{query:e}}).then((function(e){return a.setState({teams:e})}))}),100),a.handleQueryUpdate=function(e){a.fetchTeams(e.target.value)},a.handleAddTeam=function(e){var t=a.state.teams.find((function(t){return t.slug===e.value}));a.props.onAddTeam(t)},a.handleRemove=function(e){a.props.onRemoveTeam(e)},a}return d()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.fetchTeams()}},{key:"renderTeamAddDropDown",value:function(){var e,t=this.props,a=t.disabled,n=t.selectedTeams,r=t.menuHeader,s=this.state.teams,l=null===s||0===s.length,i=l||a;return e=l?[]:s.filter((function(e){return!n.includes(e.slug)})).map((function(e){return{value:e.slug,searchKey:e.slug,label:f.a.createElement(A,null,"#",e.slug)}})),f.a.createElement(T.a,{items:e,onChange:this.handleQueryUpdate,onSelect:this.handleAddTeam,emptyMessage:Object(v.b)("No teams"),menuHeader:r,disabled:i},(function(e){var t=e.isOpen;return f.a.createElement(w.a,{"aria-label":Object(v.b)("Add Team"),isOpen:t,size:"xsmall",disabled:i},Object(v.b)("Add Team"))}))}},{key:"renderBody",value:function(){var e=this,t=this.props,a=t.organization,n=t.selectedTeams,r=t.disabled,s=t.confirmLastTeamRemoveMessage;if(0===n.length)return f.a.createElement(x.a,null,Object(v.b)("No Teams assigned"));var l=1===n.length&&s?s:null;return n.map((function(t){return f.a.createElement(z,{key:t,orgId:a.slug,team:t,onRemove:e.handleRemove,disabled:r,confirmMessage:l})}))}},{key:"render",value:function(){return f.a.createElement(E.a,null,f.a.createElement(E.e,{hasButtons:!0},Object(v.b)("Team"),this.renderTeamAddDropDown()),f.a.createElement(E.c,null,this.renderBody()))}}]),t}(f.a.Component);S.displayName="TeamSelect";var z=function(e){var t=e.orgId,a=e.team,n=e.onRemove,r=e.disabled,s=e.confirmMessage;return f.a.createElement(M,null,f.a.createElement(N,{to:"/settings/".concat(t,"/teams/").concat(a,"/")},"#",a),f.a.createElement(O.a,{message:s,bypass:!s,onConfirm:function(){return n(a)},disabled:r},f.a.createElement(y.a,{size:"xsmall",icon:"icon-circle-subtract",disabled:r},Object(v.b)("Remove"))))};z.displayName="TeamRow";var A=Object(p.c)("div",{target:"e2fk6ws0"})("padding:",Object(R.a)(.5)," ",Object(R.a)(.25),";text-transform:none;"),M=Object(p.c)(E.f,{target:"e2fk6ws1"})("padding:",Object(R.a)(2),";align-items:center;"),N=Object(p.c)(j.a,{target:"e2fk6ws2"})("flex:1;margin-right:",Object(R.a)(1),";");t.a=Object(k.a)(S)},2018:function(e,t,a){"use strict";var n,r=a(2),s=a(1),l=a.n(s),i=a(0),o=a.n(i),c=a(3),m=a(250),u=a(4),d=a(36),b=a.n(d),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=Object(r.h)(e,["className"]),n=b()("radio-select",t);return o.a.createElement("input",Object(r.a)({type:"radio",className:n},a))},t.defaultProps={checked:!1},t}(o.a.Component),p=a(339),g=Object(c.c)("label",{target:"e1noblkb0"})(n||(n=Object(r.f)(["\n  display: flex;\n  flex: 1;\n  align-items: center;\n  margin-bottom: 0;\n"],["\n  display: flex;\n  flex: 1;\n  align-items: center;\n  margin-bottom: 0;\n"]))),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.disabled,n=t.enforceAllowed,r=t.roleList,s=t.selectedRole;return o.a.createElement(m.a,null,o.a.createElement(m.e,null,Object(u.b)("Role")),o.a.createElement(m.c,null,r.map((function(t){var r=t.desc,l=t.name,i=t.id,c=t.allowed,u=a||n&&!c;return o.a.createElement(m.f,{key:i,onClick:function(){return!u&&e.props.setRole(i)},css:u?{color:"grey",cursor:"default"}:{}},o.a.createElement(g,null,o.a.createElement(f,{id:i,value:l,checked:i===s,readOnly:!0}),o.a.createElement("div",{style:{flex:1,padding:"0 16px"}},l,o.a.createElement(p.a,{noMargin:!0},o.a.createElement("div",{className:"help-block"},r)))))}))))},t.propTypes={enforceAllowed:l.a.bool,disabled:l.a.bool,selectedRole:l.a.string,roleList:l.a.array,setRole:l.a.func},t}(o.a.Component);t.a=h},2580:function(e,t,a){"use strict";a.r(t),a.d(t,"InviteMember",(function(){return C}));var n=a(6),r=a.n(n),s=a(7),l=a.n(s),i=a(9),o=a.n(i),c=a(8),m=a.n(c),u=a(10),d=a.n(u),b=a(5),f=a(0),p=a.n(f),g=a(36),h=a.n(g),v=a(35),y=a(51),O=a(24),j=a(4),E=a(61),T=a(86),w=a(27),x=a(33),R=a(50),k=a(1611),S=a(339),z=a(351),A=a(1816),M=a(447),N=a(2018),C=function(e){function t(e){var a;r()(this,t),(a=o()(this,m()(t).call(this,e))).redirectToMemberPage=function(){var e=a.props,t=e.params,n=e.router,r=/^\/settings\//.test(n.location.pathname)?"/settings/:orgId/members/":"/organizations/:orgId/members/";n.push(Object(M.a)(r,t))},a.splitEmails=function(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return e}))},a.inviteUser=function(e){var t=a.props.organization.slug,n=a.state,r=n.selectedTeams,s=n.selectedRole;return new Promise((function(n,l){a.props.api.request("/organizations/".concat(t,"/members/"),{method:"POST",data:{email:e,teams:Array.from(r.keys()),role:s,referrer:a.props.location.query.referrer},success:function(){Object(y.d)(Object(j.c)("Added [email] to [organization]",{email:e,organization:t})),n()},error:function(t){403===t.status?(Object(y.a)(Object(j.b)("You aren't allowed to invite members.")),n()):409===t.status?(Object(y.a)("User already exists: ".concat(e)),n()):l(t.responseJSON)}})}))},a.submit=function(){var e=a.state.email,t=a.splitEmails(e);t.length&&(a.setState({busy:!0}),Promise.all(t.map(a.inviteUser)).then((function(){return a.redirectToMemberPage()})).catch((function(e){!e||e.email||e.role||v.l((function(t){t.setExtra("error",e),t.setExtra("state",a.state),v.c(new Error("Unknown invite member api response"))})),a.setState({error:e,busy:!1})})))},a.handleAddTeam=function(e){var t=a.state.selectedTeams;t.has(e.slug)||t.add(e.slug),a.setState({selectedTeams:t})},a.handleRemoveTeam=function(e){var t=a.state.selectedTeams;t.delete(e),a.setState({selectedTeams:t})};var n=e.organization.teams,s=1===n.length?[n[0].slug]:[];return a.state={selectedTeams:new Set(s),roleList:[],selectedRole:"member",email:"",loading:!0,busy:!1,error:void 0},a}return d()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.organization.slug,a=x.default.get("user").isSuperuser;this.props.api.request("/organizations/".concat(t,"/members/me/"),{method:"GET",success:function(t){var a=(t||{}).roles;t&&a?(e.setState({roleList:a,loading:!1}),0===a.filter((function(e){return e.allowed})).length&&e.redirectToMemberPage()):(e.setState({loading:!1,error:{role:'Error loading roles, will default to "member"'}}),v.l((function(a){a.setExtra("resp",t),a.setExtra("state",e.state),v.c(new Error("[members]: data fetch invalid response"))})))},error:function(t){404===t.status&&a?e.setState({roleList:O.w,loading:!1}):0!==t.status&&v.l((function(a){a.setExtra("error",t),a.setExtra("state",e.state),v.c(new Error("[members]: data fetch error"))})),Object(y.a)(Object(j.b)("Error with request, please reload"))}})}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,n=t.loading,r=t.roleList,s=t.selectedRole,l=t.selectedTeams,i=this.props.organization,o=x.default.getConfig().invitesEnabled,c=x.default.get("user").isSuperuser;return p.a.createElement("div",null,p.a.createElement(k.a,{title:Object(j.b)("Add Member to Organization")}),p.a.createElement(S.a,null,o?Object(j.b)("Invite a member to join this organization via their email address. If they do not already have an account, they will first be asked to create one. Multiple emails delimited by commas."):Object(j.b)("You may add a user by their username if they already have an account. Multiple inputs delimited by commas.")),n&&p.a.createElement(R.default,null),!n&&p.a.createElement("div",null,p.a.createElement("div",{className:h()({"has-error":a&&a.email})},p.a.createElement(z.a,{name:"email",label:o?Object(j.b)("Email")+"(s)":Object(j.b)("Username")+"(s)",placeholder:"e.g. teammate@example.com",spellCheck:"false",onChange:function(t){return e.setState({email:t})}}),a&&a.email&&p.a.createElement("p",{className:"error"},a.email)),a&&a.role&&p.a.createElement("p",{className:"error alert-error"},a.role),p.a.createElement(N.a,{enforceAllowed:!c,roleList:r,selectedRole:s,setRole:function(t){return e.setState({selectedRole:t})}}),p.a.createElement(A.a,{organization:i,selectedTeams:Array.from(l.values()),onAddTeam:this.handleAddTeam,onRemoveTeam:this.handleRemoveTeam}),p.a.createElement(w.a,{priority:"primary",busy:this.state.busy,className:"invite-member-submit",onClick:this.submit},Object(j.b)("Add Member"))))}}]),t}(p.a.Component);C.displayName="InviteMember",t.default=Object(E.a)(Object(b.withRouter)(Object(T.a)(C)))}}]);
//# sourceMappingURL=InviteMember.js.map
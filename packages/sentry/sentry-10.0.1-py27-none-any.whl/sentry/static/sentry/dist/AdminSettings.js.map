{"version":3,"sources":["webpack:///./app/views/admin/adminSettings.jsx"],"names":["optionsAvailable","AdminSettings","this","getEndpoint","data","state","initialData","fields","key","option","field","isUndefined","value","defn","getOption","defaultValue","getOptionField","t","apiMethod","apiEndpoint","onSubmit","requireChanges","AsyncView"],"mappings":"oSAQMA,EAAmB,CACvB,oBACA,qBACA,uBACA,wBACA,oBACA,0BACA,qBACA,uBACA,4BACA,oBAGmBC,E,+IAEjB,MAAO,CAAC,CAAC,OAAQC,KAAKC,kB,oCAItB,MAAO,uB,mCAGI,IACJC,EAAQF,KAAKG,MAAbD,KAEDE,EAAc,GACdC,EAAS,GAJJ,uBAKX,YAAkBP,EAAlB,+CAAoC,KAAzBQ,EAAyB,QAE5BC,EAASL,EAAKI,IAAQ,CAACE,MAAO,IACpC,GAAIC,IAAYF,EAAOG,QAA2B,KAAjBH,EAAOG,MAAc,CACpD,IAAMC,EAAOC,YAAUN,GACvBF,EAAYE,GAAOK,EAAKE,aAAeF,EAAKE,eAAiB,QAE7DT,EAAYE,GAAOC,EAAOG,MAE5BL,EAAOC,GAAOQ,YAAeR,EAAKC,EAAOC,QAdhC,kFAiBX,OACE,6BACE,4BAAKO,YAAE,aAEP,kBAAC,UAAD,CACEC,UAAU,MACVC,YAAajB,KAAKC,cAClBiB,SAAUlB,KAAKkB,SACfd,YAAaA,EACbe,gBAAc,GAEd,uCACCd,EAAO,qBACPA,EAAO,sBACPA,EAAO,wBACPA,EAAO,yBACPA,EAAO,qBAER,gDACCA,EAAO,2BACPA,EAAO,sBACPA,EAAO,wBACPA,EAAO,6BAER,sCACCA,EAAO,0B,GAnDyBe","file":"AdminSettings.js","sourcesContent":["import React from 'react';\nimport isUndefined from 'lodash/isUndefined';\n\nimport AsyncView from 'app/views/asyncView';\nimport {t} from 'app/locale';\nimport {getOption, getOptionField} from 'app/options';\nimport {ApiForm} from 'app/components/forms';\n\nconst optionsAvailable = [\n  'system.url-prefix',\n  'system.admin-email',\n  'system.support-email',\n  'system.security-email',\n  'system.rate-limit',\n  'auth.allow-registration',\n  'auth.ip-rate-limit',\n  'auth.user-rate-limit',\n  'api.rate-limit.org-create',\n  'beacon.anonymous',\n];\n\nexport default class AdminSettings extends AsyncView {\n  getEndpoints() {\n    return [['data', this.getEndpoint()]];\n  }\n\n  getEndpoint() {\n    return '/internal/options/';\n  }\n\n  renderBody() {\n    const {data} = this.state;\n\n    const initialData = {};\n    const fields = {};\n    for (const key of optionsAvailable) {\n      // TODO(dcramer): we should not be mutating options\n      const option = data[key] || {field: {}};\n      if (isUndefined(option.value) || option.value === '') {\n        const defn = getOption(key);\n        initialData[key] = defn.defaultValue ? defn.defaultValue() : '';\n      } else {\n        initialData[key] = option.value;\n      }\n      fields[key] = getOptionField(key, option.field);\n    }\n\n    return (\n      <div>\n        <h3>{t('Settings')}</h3>\n\n        <ApiForm\n          apiMethod=\"PUT\"\n          apiEndpoint={this.getEndpoint()}\n          onSubmit={this.onSubmit}\n          initialData={initialData}\n          requireChanges\n        >\n          <h4>General</h4>\n          {fields['system.url-prefix']}\n          {fields['system.admin-email']}\n          {fields['system.support-email']}\n          {fields['system.security-email']}\n          {fields['system.rate-limit']}\n\n          <h4>Security & Abuse</h4>\n          {fields['auth.allow-registration']}\n          {fields['auth.ip-rate-limit']}\n          {fields['auth.user-rate-limit']}\n          {fields['api.rate-limit.org-create']}\n\n          <h4>Beacon</h4>\n          {fields['beacon.anonymous']}\n        </ApiForm>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}
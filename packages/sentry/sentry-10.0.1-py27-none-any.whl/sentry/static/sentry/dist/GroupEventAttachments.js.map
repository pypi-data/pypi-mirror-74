{"version":3,"sources":["webpack:///./app/components/dateTime.tsx","webpack:///./app/components/fileSize.tsx","webpack:///./app/utils/attachmentUrl.tsx","webpack:///./app/components/events/eventAttachmentActions.tsx","webpack:////workspace/node_modules/lodash/isArrayLikeObject.js","webpack:////workspace/node_modules/lodash/xor.js","webpack:////workspace/node_modules/lodash/_baseXor.js","webpack:////workspace/node_modules/lodash/_baseDifference.js","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/types.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTableRow.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTable.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx","webpack:///./app/views/organizationGroupDetails/groupEventAttachments/index.tsx"],"names":["getFormat","clock24Hours","dateOnly","timeOnly","seconds","shortDate","render","date","utc","user","get","options","format","this","carriedProps","tz","timezone","propTypes","any","isRequired","bool","defaultProps","Component","props","className","bytes","value","fixed","hasAttachmentsRole","isSuperuser","availableRoles","attachmentsRole","role","Array","isArray","roleIds","map","r","requiredIndex","indexOf","getDownloadUrl","attachment","organization","eventId","projectId","slug","id","children","Organization","string","EventAttachment","func","PureComponent","AttachmentUrl","handleDelete","api","url","onDelete","attachmentId","requestPromise","method","Fragment","DownloadButton","size","icon","href","disabled","title","undefined","confirmText","message","priority","onConfirm","EventAttachmentActions","isArrayLike","isObjectLike","module","exports","arrayFilter","baseRest","baseXor","isArrayLikeObject","xor","arrays","baseDifference","baseFlatten","baseUniq","iteratee","comparator","length","index","result","array","othIndex","SetCache","arrayIncludes","arrayIncludesWith","arrayMap","baseUnary","cacheHas","LARGE_ARRAY_SIZE","values","includes","isCommon","valuesLength","outer","computed","valuesIndex","push","getEventUrl","orgId","groupId","event_id","getAttachmentTypeDisplayName","type","isDeleted","TableRow","name","dateCreated","to","p","attachments","deletedAttachments","tableRowNames","key","some","FilterWrapper","space","MergedButtonBar","query","pathname","types","onlyCrashReportTypes","allAttachmentsQuery","onlyCrashReportsQuery","state","eventAttachmentsList","loading","error","pageLinks","deletedAttachmentId","setState","prevState","fetchData","location","limit","request","params","success","data","_","jqXHR","getResponseHeader","err","parseApiError","componentWillMount","componentDidUpdate","prevProps","search","renderNoQueryResults","renderEmpty","renderResults","group","project","renderBody","onRetry","features","renderDisabled","withApi"],"mappings":"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","file":"GroupEventAttachments.js","sourcesContent":["import PropTypes from 'prop-types';\nimport React from 'react';\nimport moment from 'moment-timezone';\n\nimport ConfigStore from 'app/stores/configStore';\n\ntype Props = {\n  date: moment.MomentInput;\n  dateOnly?: boolean;\n  timeOnly?: boolean;\n  shortDate?: boolean;\n  seconds?: boolean;\n  utc?: boolean;\n};\n\nclass DateTime extends React.Component<Props> {\n  static propTypes = {\n    date: PropTypes.any.isRequired,\n    dateOnly: PropTypes.bool,\n    timeOnly: PropTypes.bool,\n    shortDate: PropTypes.bool,\n    seconds: PropTypes.bool,\n    utc: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    seconds: true,\n  };\n\n  getFormat = ({clock24Hours}: {clock24Hours: boolean}): string => {\n    const {dateOnly, timeOnly, seconds, shortDate} = this.props;\n\n    // October 26, 2017\n    if (dateOnly) {\n      return 'LL';\n    }\n\n    // 4:57 PM\n    if (timeOnly) {\n      return 'LT';\n    }\n\n    if (shortDate) {\n      return 'MM/DD/YYYY';\n    }\n\n    if (clock24Hours) {\n      return 'MMMM D YYYY HH:mm:ss z';\n    }\n\n    // Oct 26, 2017 11:30:30 AM\n    if (seconds) {\n      return 'll LTS z';\n    }\n\n    // Default is Oct 26, 2017 11:30 AM\n    return 'lll';\n  };\n\n  render() {\n    const {\n      date,\n      seconds, // eslint-disable-line no-unused-vars\n      shortDate, // eslint-disable-line no-unused-vars\n      dateOnly, // eslint-disable-line no-unused-vars\n      utc,\n      timeOnly: _timeOnly, // eslint-disable-line no-unused-vars\n      ...carriedProps\n    } = this.props;\n    const user = ConfigStore.get('user');\n    const options = user ? user.options : {};\n    const format = this.getFormat(options);\n\n    return (\n      <time {...carriedProps}>\n        {utc\n          ? moment.utc(date).format(format)\n          : moment.tz(date, options.timezone).format(format)}\n      </time>\n    );\n  }\n}\n\nexport default DateTime;\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport {formatBytes} from 'app/utils';\nimport getDynamicText from 'app/utils/getDynamicText';\n\ntype Props = {\n  className?: string;\n  bytes: number;\n};\n\nfunction FileSize(props: Props) {\n  const {className, bytes} = props;\n\n  return (\n    <span className={className}>\n      {getDynamicText({value: formatBytes(bytes), fixed: 'xx KB'})}\n    </span>\n  );\n}\n\nFileSize.propTypes = {\n  className: PropTypes.string,\n  bytes: PropTypes.number.isRequired,\n};\n\nexport default FileSize;\n","import PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {Organization, EventAttachment} from 'app/types';\nimport ConfigStore from 'app/stores/configStore';\nimport withOrganization from 'app/utils/withOrganization';\nimport SentryTypes from 'app/sentryTypes';\n\ntype Props = {\n  organization: Organization;\n  projectId: string;\n  eventId: string;\n  attachment: EventAttachment;\n  children: (downloadUrl: string | null) => React.ReactNode;\n};\n\nclass AttachmentUrl extends React.PureComponent<Props> {\n  static propTypes = {\n    organization: SentryTypes.Organization.isRequired,\n    projectId: PropTypes.string.isRequired,\n    eventId: PropTypes.string.isRequired,\n    attachment: SentryTypes.EventAttachment.isRequired,\n    children: PropTypes.func.isRequired,\n  };\n\n  hasAttachmentsRole() {\n    const user = ConfigStore.get('user');\n    if (!user) {\n      return false;\n    }\n\n    if (user.isSuperuser) {\n      return true;\n    }\n\n    const {availableRoles, attachmentsRole, role} = this.props.organization;\n    if (!Array.isArray(availableRoles)) {\n      return false;\n    }\n\n    const roleIds = availableRoles.map(r => r.id);\n    const requiredIndex = roleIds.indexOf(attachmentsRole);\n    const currentIndex = roleIds.indexOf(role || '');\n    return currentIndex >= requiredIndex;\n  }\n\n  getDownloadUrl() {\n    const {attachment, organization, eventId, projectId} = this.props;\n    return `/api/0/projects/${\n      organization.slug\n    }/${projectId}/events/${eventId}/attachments/${attachment.id}/`;\n  }\n\n  render() {\n    const {children} = this.props;\n    return children(this.hasAttachmentsRole() ? this.getDownloadUrl() : null);\n  }\n}\n\nexport default withOrganization(AttachmentUrl);\n","import React from 'react';\nimport styled from 'react-emotion';\n\nimport {t} from 'app/locale';\nimport Button from 'app/components/button';\nimport space from 'app/styles/space';\nimport Confirm from 'app/components/confirm';\nimport withApi from 'app/utils/withApi';\nimport {Client} from 'app/api';\n\ntype Props = {\n  api: Client;\n  url: string | null;\n  attachmentId: string;\n  onDelete: (attachmentId: string) => void;\n};\n\nclass EventAttachmentActions extends React.Component<Props> {\n  handleDelete = async () => {\n    const {api, url, onDelete, attachmentId} = this.props;\n\n    if (url) {\n      try {\n        await api.requestPromise(url, {\n          method: 'DELETE',\n        });\n\n        onDelete(attachmentId);\n      } catch (_err) {\n        // TODO: Error-handling\n      }\n    }\n  };\n\n  render() {\n    const {url} = this.props;\n\n    return (\n      <React.Fragment>\n        <DownloadButton\n          size=\"xsmall\"\n          icon=\"icon-download\"\n          href={url ? `${url}?download=1` : ''}\n          disabled={!url}\n          title={!url ? t('Insufficient permissions to download attachments') : undefined}\n        >\n          {t('Download')}\n        </DownloadButton>\n\n        <Confirm\n          confirmText={t('Delete')}\n          message={t('Are you sure you wish to delete this file?')}\n          priority=\"danger\"\n          onConfirm={this.handleDelete}\n          disabled={!url}\n        >\n          <Button\n            size=\"xsmall\"\n            icon=\"icon-trash\"\n            disabled={!url}\n            priority=\"danger\"\n            title={!url ? t('Insufficient permissions to delete attachments') : undefined}\n          />\n        </Confirm>\n      </React.Fragment>\n    );\n  }\n}\n\nconst DownloadButton = styled(Button)`\n  margin-right: ${space(0.5)};\n`;\n\nexport default withApi(EventAttachmentActions);\n","var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n","var arrayFilter = require('./_arrayFilter'),\n    baseRest = require('./_baseRest'),\n    baseXor = require('./_baseXor'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nmodule.exports = xor;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseUniq = require('./_baseUniq');\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nmodule.exports = baseXor;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","import {t} from 'app/locale';\n\nexport const types = {\n  'event.minidump': t('Minidump'),\n  'event.applecrashreport': t('Apple Crash Report'),\n  'event.attachment': t('Other'),\n};\n","import React from 'react';\nimport styled from 'react-emotion';\n\nimport Link from 'app/components/links/link';\nimport {t} from 'app/locale';\nimport DateTime from 'app/components/dateTime';\nimport FileSize from 'app/components/fileSize';\nimport {EventAttachment} from 'app/types';\nimport AttachmentUrl from 'app/utils/attachmentUrl';\nimport EventAttachmentActions from 'app/components/events/eventAttachmentActions';\nimport {types} from 'app/views/organizationGroupDetails/groupEventAttachments/types';\n\ntype Props = {\n  orgId: string;\n  projectId: string;\n  groupId: string;\n  attachment: EventAttachment;\n  onDelete: (attachmentId: string) => void;\n  isDeleted: boolean;\n};\n\nclass GroupEventAttachmentsTableRow extends React.Component<Props> {\n  getEventUrl() {\n    const {attachment, orgId, groupId} = this.props;\n\n    return `/organizations/${orgId}/issues/${groupId}/events/${attachment.event_id}/`;\n  }\n\n  getAttachmentTypeDisplayName(type: string) {\n    return types[type] || t('Other');\n  }\n\n  render() {\n    const {attachment, projectId, onDelete, isDeleted} = this.props;\n\n    return (\n      <TableRow isDeleted={isDeleted}>\n        <td>\n          <h5>\n            {attachment.name}\n            <br />\n            <small>\n              <DateTime date={attachment.dateCreated} /> &middot;{' '}\n              <Link to={this.getEventUrl()}>{attachment.event_id}</Link>\n            </small>\n          </h5>\n        </td>\n\n        <td>{this.getAttachmentTypeDisplayName(attachment.type)}</td>\n\n        <td>\n          <FileSize bytes={attachment.size} />\n        </td>\n\n        <td>\n          <AttachmentUrl\n            projectId={projectId}\n            eventId={attachment.event_id}\n            attachment={attachment}\n          >\n            {url =>\n              !isDeleted && (\n                <EventAttachmentActions\n                  url={url}\n                  onDelete={onDelete}\n                  attachmentId={attachment.id}\n                />\n              )\n            }\n          </AttachmentUrl>\n        </td>\n      </TableRow>\n    );\n  }\n}\n\ntype TableRowProps = {isDeleted: boolean};\n\nconst TableRow = styled('tr')<TableRowProps>`\n  opacity: ${p => (p.isDeleted ? 0.3 : 1)};\n  td {\n    text-decoration: ${p => (p.isDeleted ? 'line-through' : 'normal')};\n  }\n`;\n\nexport default GroupEventAttachmentsTableRow;\n","import React from 'react';\n\nimport {EventAttachment} from 'app/types';\nimport {t} from 'app/locale';\nimport GroupEventAttachmentsTableRow from 'app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTableRow';\n\ntype Props = {\n  attachments: EventAttachment[];\n  orgId: string;\n  projectId: string;\n  groupId: string;\n  onDelete: (attachmentId: string) => void;\n  deletedAttachments: string[];\n};\n\nclass GroupEventAttachmentsTable extends React.Component<Props> {\n  render() {\n    const {\n      attachments,\n      orgId,\n      projectId,\n      groupId,\n      onDelete,\n      deletedAttachments,\n    } = this.props;\n    const tableRowNames = [t('Name'), t('Type'), t('Size'), t('Actions')];\n\n    return (\n      <table className=\"table events-table\">\n        <thead>\n          <tr>\n            {tableRowNames.map(name => {\n              return <th key={name}>{name}</th>;\n            })}\n          </tr>\n        </thead>\n        <tbody>\n          {attachments.map(attachment => {\n            return (\n              <GroupEventAttachmentsTableRow\n                key={attachment.id}\n                attachment={attachment}\n                orgId={orgId}\n                projectId={projectId}\n                groupId={groupId}\n                onDelete={onDelete}\n                isDeleted={deletedAttachments.some(id => attachment.id === id)}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nexport default GroupEventAttachmentsTable;\n","import React from 'react';\nimport omit from 'lodash/omit';\nimport xor from 'lodash/xor';\nimport {withRouter} from 'react-router';\nimport {WithRouterProps} from 'react-router/lib/withRouter';\nimport styled from 'react-emotion';\n\nimport space from 'app/styles/space';\nimport {t} from 'app/locale';\nimport ButtonBar from 'app/components/buttonBar';\nimport Button from 'app/components/button';\n\nconst GroupEventAttachmentsFilter = (props: WithRouterProps) => {\n  const {query, pathname} = props.location;\n  const {types} = query;\n  const onlyCrashReportTypes = ['event.minidump', 'event.applecrashreport'];\n  const allAttachmentsQuery = omit(query, 'types');\n  const onlyCrashReportsQuery = {\n    ...query,\n    types: onlyCrashReportTypes,\n  };\n\n  return (\n    <FilterWrapper>\n      <MergedButtonBar>\n        <Button\n          size=\"small\"\n          to={{pathname, query: allAttachmentsQuery}}\n          priority={types === undefined ? 'primary' : 'default'}\n        >\n          {t('All Attachments')}\n        </Button>\n        <Button\n          size=\"small\"\n          to={{pathname, query: onlyCrashReportsQuery}}\n          priority={xor(onlyCrashReportTypes, types).length === 0 ? 'primary' : 'default'}\n        >\n          {t('Only Crash Reports')}\n        </Button>\n      </MergedButtonBar>\n    </FilterWrapper>\n  );\n};\n\nconst FilterWrapper = styled('div')`\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: ${space(3)};\n`;\n\nconst MergedButtonBar = styled(ButtonBar)`\n  & > a:first-child:not(:last-child) {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n  & > a:last-child:not(:first-child) {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n  }\n`;\n\nexport default withRouter(GroupEventAttachmentsFilter);\n","import React from 'react';\nimport pick from 'lodash/pick';\n\nimport {Panel, PanelBody} from 'app/components/panels';\nimport {t} from 'app/locale';\nimport withApi from 'app/utils/withApi';\nimport EmptyStateWarning from 'app/components/emptyStateWarning';\nimport GroupEventAttachmentsTable from 'app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsTable';\nimport GroupEventAttachmentsFilter from 'app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter';\nimport LoadingError from 'app/components/loadingError';\nimport LoadingIndicator from 'app/components/loadingIndicator';\nimport Pagination from 'app/components/pagination';\nimport parseApiError from 'app/utils/parseApiError';\nimport {RouterProps, EventAttachment, Group} from 'app/types';\nimport {Client} from 'app/api';\nimport Feature from 'app/components/acl/feature';\nimport FeatureDisabled from 'app/components/acl/featureDisabled';\n\ntype Props = RouterProps & {\n  api: Client;\n  group: Group;\n};\n\ntype State = {\n  eventAttachmentsList: EventAttachment[];\n  deletedAttachments: string[];\n  loading: boolean;\n  error: null | string;\n  pageLinks: null | string;\n};\n\nclass GroupEventAttachments extends React.Component<Props, State> {\n  state = {\n    eventAttachmentsList: [],\n    deletedAttachments: [],\n    loading: true,\n    error: null,\n    pageLinks: null,\n  };\n\n  componentWillMount() {\n    this.fetchData();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.location.search !== prevProps.location.search) {\n      this.fetchData();\n    }\n  }\n\n  handleDelete = (deletedAttachmentId: string) => {\n    this.setState(prevState => {\n      return {\n        deletedAttachments: [...prevState.deletedAttachments, deletedAttachmentId],\n      };\n    });\n  };\n\n  fetchData = () => {\n    this.setState({\n      loading: true,\n      error: null,\n    });\n\n    const query = {\n      ...pick(this.props.location.query, ['cursor', 'environment', 'types']),\n      limit: 50,\n    };\n\n    this.props.api.request(`/issues/${this.props.params.groupId}/attachments/`, {\n      query,\n      method: 'GET',\n      success: (data, _, jqXHR) => {\n        this.setState(prevState => ({\n          eventAttachmentsList: data,\n          error: null,\n          loading: false,\n          pageLinks: jqXHR ? jqXHR.getResponseHeader('Link') : prevState.pageLinks,\n        }));\n      },\n      error: err => {\n        this.setState({\n          error: parseApiError(err),\n          loading: false,\n        });\n      },\n    });\n  };\n\n  renderNoQueryResults() {\n    return (\n      <EmptyStateWarning>\n        <p>{t('Sorry, no event attachments match your search query.')}</p>\n      </EmptyStateWarning>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <EmptyStateWarning>\n        <p>{t(\"There don't seem to be any event attachments yet.\")}</p>\n      </EmptyStateWarning>\n    );\n  }\n\n  renderResults() {\n    const {group, params} = this.props;\n    const {eventAttachmentsList, deletedAttachments} = this.state;\n\n    return (\n      <GroupEventAttachmentsTable\n        attachments={eventAttachmentsList}\n        orgId={params.orgId}\n        projectId={group.project.slug}\n        groupId={params.groupId}\n        onDelete={this.handleDelete}\n        deletedAttachments={deletedAttachments}\n      />\n    );\n  }\n\n  renderBody() {\n    let body;\n\n    if (this.state.loading) {\n      body = <LoadingIndicator />;\n    } else if (this.state.error) {\n      body = <LoadingError message={this.state.error} onRetry={this.fetchData} />;\n    } else if (this.state.eventAttachmentsList.length > 0) {\n      body = this.renderResults();\n    } else if (this.props.location.query.types) {\n      body = this.renderNoQueryResults();\n    } else {\n      body = this.renderEmpty();\n    }\n\n    return body;\n  }\n\n  render() {\n    return (\n      <Feature\n        features={['event-attachments']}\n        renderDisabled={() => <FeatureDisabled />}\n      >\n        <GroupEventAttachmentsFilter />\n        <Panel className=\"event-list\">\n          <PanelBody>{this.renderBody()}</PanelBody>\n        </Panel>\n        <Pagination pageLinks={this.state.pageLinks} />\n      </Feature>\n    );\n  }\n}\n\nexport {GroupEventAttachments};\n\nexport default withApi(GroupEventAttachments);\n"],"sourceRoot":""}
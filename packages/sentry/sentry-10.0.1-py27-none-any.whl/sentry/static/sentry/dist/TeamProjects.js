(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[179],{1833:function(e,t,a){"use strict";var n=a(2),r=a(0),c=a.n(r),o=a(53),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.project,a=Object(n.h)(e,["project"]);return c.a.createElement("span",Object(n.a)({className:"project-label"},a),c.a.createElement("span",{className:"project-name"},t.slug))},t.propTypes={project:o.a.isRequired},t}(c.a.PureComponent);t.a=s},1960:function(e,t,a){"use strict";var n=a(6),r=a.n(n),c=a(7),o=a.n(c),s=a(9),i=a.n(s),l=a(8),u=a.n(l),p=a(10),d=a.n(p),m=a(3),j=a(0),h=a.n(j),g=a(607),f=a(98),b=a(1833),v=a(11),k=function(e){function t(e){var a;return r()(this,t),(a=i()(this,u()(t).call(this,e))).handleToggleBookmark=function(e){a.setState({isBookmarked:e})},a.state={isBookmarked:a.props.project.isBookmarked},a}return d()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,t=e.project,a=e.organization;return h.a.createElement(y,{key:t.id},h.a.createElement(O,{organization:a,project:t,isBookmarked:this.state.isBookmarked,onToggle:this.handleToggleBookmark}),h.a.createElement(f.a,{to:"/settings/".concat(a.slug,"/projects/").concat(t.slug,"/")},h.a.createElement(b.a,{project:t})))}}]),t}(h.a.Component);k.displayName="ProjectItem";var y=Object(m.c)("div",{target:"enngb6z0"})("display:flex;align-items:center;"),O=Object(m.c)(g.a,{target:"enngb6z1"})("margin-right:",Object(v.a)(1),";margin-top:-",Object(v.a)(.25),";");t.a=k},2584:function(e,t,a){"use strict";a.r(t),a.d(t,"TeamProjects",(function(){return N}));var n=a(12),r=a.n(n),c=a(45),o=a.n(c),s=a(6),i=a.n(s),l=a(7),u=a.n(l),p=a(9),d=a.n(p),m=a(8),j=a.n(m),h=a(10),g=a.n(h),f=a(0),b=a.n(f),v=a(3),k=a(39),y=a(61),O=a(51),P=a(11),E=a(27),z=a(253),S=a(346),T=a(570),q=a(50),I=a(159),w=a(1960),A=a(250),L=a(19),B=a(572),C=a(21),x=a(4),U=a(86),N=function(e){function t(){var e,a;i()(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=d()(this,(e=j()(t)).call.apply(e,[this].concat(r)))).state={error:!1,loading:!0,pageLinks:null,unlinkedProjects:[],linkedProjects:[]},a.fetchAll=function(){a.fetchTeamProjects(),a.fetchUnlinkedProjects()},a.fetchTeamProjects=function(){var e=a.props,t=e.location,n=e.params,r=n.orgId,c=n.teamId;a.setState({loading:!0}),a.props.api.requestPromise("/organizations/".concat(r,"/projects/"),{query:{query:"team:".concat(c),cursor:t.query.cursor||""},includeAllArgs:!0}).then((function(e){var t=o()(e,3),n=t[0],r=(t[1],t[2]);a.setState({loading:!1,error:!1,linkedProjects:n,pageLinks:r.getResponseHeader("Link")})})).catch((function(){a.setState({loading:!1,error:!0})}))},a.fetchUnlinkedProjects=function(e){var t=a.props.params,n=t.orgId,r=t.teamId;a.props.api.requestPromise("/organizations/".concat(n,"/projects/"),{query:{query:e?"!team:".concat(r," ").concat(e):"!team:".concat(r)}}).then((function(e){a.setState({unlinkedProjects:e})}))},a.handleLinkProject=function(e,t){var n=a.props.params,r=n.orgId,c=n.teamId;a.props.api.request("/projects/".concat(r,"/").concat(e.slug,"/teams/").concat(c,"/"),{method:"add"===t?"POST":"DELETE",success:function(){a.fetchAll(),Object(O.d)("add"===t?Object(x.b)("Successfully added project to team."):Object(x.b)("Successfully removed project from team"))},error:function(e){Object(O.a)(Object(x.b)("Wasn't able to change project association."))}})},a.handleProjectSelected=function(e){var t=a.state.unlinkedProjects.find((function(t){return t.id===e.value}));a.handleLinkProject(t,"add")},a.handleQueryUpdate=function(e){a.fetchUnlinkedProjects(e.target.value)},a}return g()(t,e),u()(t,[{key:"componentDidMount",value:function(){this.fetchAll()}},{key:"componentDidUpdate",value:function(e){e.params.orgId===this.props.params.orgId&&e.params.teamId===this.props.params.teamId||this.fetchAll(),e.location!==this.props.location&&this.fetchTeamProjects()}},{key:"projectPanelContents",value:function(e){var t=this,a=this.props.organization,n=new Set(a.access).has("org:write");return e.length?Object(C.t)(e).map((function(e,r){return b.a.createElement(D,{key:e.id},b.a.createElement(w.a,{project:e,organization:a}),b.a.createElement(k.a,{disabled:n,title:Object(x.b)("You do not have enough permission to change project association.")},b.a.createElement(E.a,{size:"small",disabled:!n,onClick:function(){t.handleLinkProject(e,"remove")}},b.a.createElement(R,null)," ",Object(x.b)("Remove"))))})):b.a.createElement(T.a,{size:"large",icon:"icon-circle-exclamation"},Object(x.b)("This team doesn't have access to any projects."))}},{key:"render",value:function(){var e=this,t=this.state,a=t.linkedProjects,n=t.unlinkedProjects,c=t.error,o=t.loading;if(c)return b.a.createElement(I.a,{onRetry:function(){return e.fetchAll()}});if(o)return b.a.createElement(q.default,null);var s=new Set(this.props.organization.access),i=n.map((function(e){return{value:e.id,searchKey:e.slug,label:b.a.createElement(W,null,e.slug)}}));return b.a.createElement(b.a.Fragment,null,b.a.createElement(A.a,null,b.a.createElement(A.e,{hasButtons:!0},b.a.createElement("div",null,Object(x.b)("Projects")),b.a.createElement("div",{style:{textTransform:"none"}},s.has("org:write")?b.a.createElement(z.a,{items:i,onChange:this.handleQueryUpdate,onSelect:this.handleProjectSelected,emptyMessage:Object(x.b)("No projects")},(function(e){var t=e.isOpen;e.selectedItem;return b.a.createElement(S.a,{isOpen:t,size:"xsmall"},Object(x.b)("Add Project"))})):b.a.createElement(S.a,{disabled:!0,title:Object(x.b)("You do not have enough permission to associate a project."),size:"xsmall"},Object(x.b)("Add Project")))),b.a.createElement(A.c,null,this.projectPanelContents(a))),b.a.createElement(B.a,r()({pageLinks:this.state.pageLinks},this.props)))}}]),t}(b.a.Component);N.displayName="TeamProjects";var R=Object(v.c)((function(e){return b.a.createElement(L.a,r()({},e,{src:"icon-circle-subtract"}),Object(x.b)("Remove"))}),{target:"eqsa6vb0"})("min-height:1.25em;min-width:1.25em;margin-right:",Object(P.a)(1),";"),D=Object(v.c)(A.f,{target:"eqsa6vb1"})("display:flex;align-items:center;justify-content:space-between;padding:",Object(P.a)(2),";"),W=Object(v.c)("div",{target:"eqsa6vb2"})("padding:",Object(P.a)(.25)," 0;");t.default=Object(y.a)(Object(U.a)(N))}}]);
//# sourceMappingURL=TeamProjects.js.map
(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[82],{1682:function(e,t,r){"use strict";var n=r(12),a=r.n(n),i=r(20),s=r.n(i),o=r(6),l=r.n(o),c=r(7),u=r.n(c),m=r(9),g=r.n(m),d=r(8),p=r.n(d),h=r(10),f=r.n(h),b=r(0),v=r.n(b),y=r(36),E=r.n(y),I=r(252),S=function(e){function t(){var e,r;l()(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(r=g()(this,(e=p()(t)).call.apply(e,[this].concat(a)))).state={isModalOpen:!1},r}return f()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.disabled,n=e.title,i=e.children,o=s()(e,["className","disabled","title","children"]);return v.a.createElement(I.a,a()({},o,{disabled:r}),v.a.createElement("a",{className:E()(t||"",{disabled:r}),disabled:r,onClick:this.onToggle,title:n},i))}}]),t}(v.a.PureComponent);S.displayName="LinkWithConfirmation",t.a=S},1743:function(e,t,r){"use strict";var n=r(12),a=r.n(n),i=r(20),s=r.n(i),o=r(0),l=r.n(o),c=r(36),u=r.n(c),m=function(e){var t=e.children,r=e.className,n=e.responsive,i=e.center,o=s()(e,["children","className","responsive","center"]),c=u()("spread-layout",r,{center:i,"allow-responsive":n});return l.a.createElement("div",a()({},o,{className:c}),t)};m.displayName="SpreadLayout",m.defaultProps={responsive:!1,center:!0},t.a=m},1800:function(e,t,r){"use strict";var n=r(16),a=r.n(n),i=r(34),s=r.n(i),o=r(45),l=r.n(o),c=r(18),u=r.n(c),m=r(146),g=r.n(m),d=r(68),p=r(47),h=r(1871);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var b=new p.a,v=u.a.createStore({listenables:[h.a],init:function(){var e=this,t=this.getInitialState();Object.entries(t).forEach((function(t){var r=l()(t,2),n=r[0],a=r[1];e[n]=a}))},getInitialState:function(){return{mergedItems:[],unmergeList:new Map,unmergeState:new Map,unmergeDisabled:!0,unmergeLastCollapsed:!1,enableFingerprintCompare:!1,similarItems:[],filteredSimilarItems:[],similarLinks:"",mergeState:new Map,mergeList:new Set,mergedLinks:"",mergeDisabled:!1,loading:!0,error:!1}},setStateForId:function(e,t,r){return(Array.isArray(t)?t:[t]).map((function(t){var n=e.has(t)&&e.get(t)||{},a=Object.assign({},n,r);return e.set(t,a),a}))},isAllUnmergedSelected:function(){var e=Array.from(this.unmergeState.values()).filter((function(e){return e.busy}))||[];return this.unmergeList.size===this.mergedItems.filter((function(e){return!!e.latestEvent})).length-e.length},onFetch:function(e){var t=this,r=e||this.toFetchArray;this.init(),this.triggerFetchState();var n=r.map((function(e){var t=e.endpoint,r=e.queryParams,n=e.dataKey;return new Promise((function(e,a){b.request(t,{method:"GET",data:r,success:function(t,r,a){e({dataKey:n,data:t,links:a.getResponseHeader("Link")})},error:function(e){var t=e.responseJSON&&e.responseJSON.detail||!0;a(t)}})}))})),a={merged:function(e){return t.setStateForId(t.unmergeState,e.id,{busy:"locked"===e.state}),e},similar:function(e){var t,r=l()(e,2),n=r[0],a=r[1],i=!((t=a)&&Object.keys(t)||[]).map((function(e){return t[e]})).find((function(e){return e>=.6})),s=Object.keys(a).map((function(e){return[e,a[e]]})).reduce((function(e,t){var r=l()(t,2),n=r[0],a=r[1],i=n.split(":"),s=l()(i,1)[0];return e[s]||(e[s]=[]),e[s].push([n,a]),e}),{}),o=Object.keys(s).map((function(e){return[e,s[e]]})).reduce((function(e,t){var r=l()(t,2),n=r[0],a=r[1].filter((function(e){return null!==l()(e,2)[1]})),i=a.reduce((function(e,t){return e+l()(t,2)[1]}),0)/a.length;return e[n]=i,e}),{});return{issue:n,score:a,scoresByInterface:s,aggregate:o,isBelowThreshold:i}}};return e&&(this.toFetchArray=e),Promise.all(n).then((function(e){e.forEach((function(e){var r=e.dataKey,n=e.data,i=e.links,s=n.map(a[r]);t["".concat(r,"Items")]=s,t["".concat(r,"Links")]=i})),t.loading=!1,t.error=!1,t.triggerFetchState()}),(function(){t.loading=!1,t.error=!0,t.triggerFetchState()}))},onToggleMerge:function(e){var t,r=this.mergeState.has(e)&&this.mergeState.get(e);r&&!0===r.busy||(this.mergeList.has(e)?(this.mergeList.delete(e),t=!1):(this.mergeList.add(e),t=!0),this.setStateForId(this.mergeState,e,{checked:t}),this.triggerMergeState())},onToggleUnmerge:function(e){var t,r=l()(e,2),n=r[0],a=r[1],i=this.unmergeState.get(n);i&&!0===i.busy||(this.unmergeList.has(n)?(this.unmergeList.delete(n),t=!1):(this.unmergeList.set(n,a),t=!0),this.setStateForId(this.unmergeState,n,{checked:t}),this.unmergeDisabled=0===this.unmergeList.size||this.isAllUnmergedSelected(),this.enableFingerprintCompare=2===this.unmergeList.size,this.triggerUnmergeState())},onUnmerge:function(e){var t=this,r=e.groupId,n=e.loadingMessage,a=e.successMessage,i=e.errorMessage,s=Array.from(this.unmergeList.keys());return new Promise((function(e,o){if(t.isAllUnmergedSelected())o(new Error("Not allowed to unmerge ALL events"));else{t.unmergeDisabled=!0,t.setStateForId(t.unmergeState,s,{checked:!1,busy:!0}),t.triggerUnmergeState();var l=d.a.add(n);b.request("/issues/".concat(r,"/hashes/"),{method:"DELETE",query:{id:s},success:function(e,r,n){d.a.remove(l),d.a.add(a,"success",{duration:5e3}),t.setStateForId(t.unmergeState,s,{checked:!1,busy:!0}),t.unmergeList.clear()},error:function(){d.a.remove(l),d.a.add(i,"error"),t.setStateForId(t.unmergeState,s,{checked:!0,busy:!1})},complete:function(){t.unmergeDisabled=!1,e(t.triggerUnmergeState())}})}}))},onMerge:function(e){var t=this,r=e.params,n=e.query,a=e.projectId,i=Array.from(this.mergeList.values());return this.mergeDisabled=!0,this.setStateForId(this.mergeState,i,{busy:!0}),this.triggerMergeState(),new Promise((function(e,o){if(r){var l=r.orgId,c=r.groupId;b.merge({orgId:l,projectId:a||r.projectId,itemIds:[].concat(s()(i),[c]),query:n},{success:function(e,r,n){e&&e.merge&&e.merge.parent&&t.trigger({mergedParent:e.merge.parent}),t.setStateForId(t.mergeState,i,{checked:!1,busy:!0}),t.mergeList.clear()},error:function(){t.setStateForId(t.mergeState,i,{checked:!0,busy:!1})},complete:function(){t.mergeDisabled=!1,e(t.triggerMergeState())}})}else e(null)}))},onToggleCollapseFingerprints:function(){this.setStateForId(this.unmergeState,this.mergedItems.map((function(e){return e.id})),{collapsed:!this.unmergeLastCollapsed}),this.unmergeLastCollapsed=!this.unmergeLastCollapsed,this.trigger({unmergeLastCollapsed:this.unmergeLastCollapsed,unmergeState:this.unmergeState})},onToggleCollapseFingerprint:function(e){var t=this.unmergeState.has(e)&&this.unmergeState.get(e).collapsed;this.setStateForId(this.unmergeState,e,{collapsed:!t}),this.trigger({unmergeState:this.unmergeState})},triggerFetchState:function(){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(r,!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({similarItems:this.similarItems.filter((function(e){return!e.isBelowThreshold})),filteredSimilarItems:this.similarItems.filter((function(e){return e.isBelowThreshold}))},g()(this,["mergedItems","mergedLinks","similarLinks","mergeState","unmergeState","loading","error"]));return this.trigger(e),e},triggerUnmergeState:function(){var e=g()(this,["unmergeDisabled","unmergeState","unmergeList","enableFingerprintCompare","unmergeLastCollapsed"]);return this.trigger(e),e},triggerMergeState:function(){var e=g()(this,["mergeDisabled","mergeState","mergeList"]);return this.trigger(e),e}});t.a=v},1870:function(e,t,r){"use strict";var n=r(1),a=r.n(n),i=r(3),s=Object(i.c)("div",{target:"envzszi0"})("display:flex;flex:1;align-items:center;flex-direction:",(function(e){return e.vertical?"column":null}),";justify-content:",(function(e){return e.center?"center":null}),";overflow:",(function(e){return e.truncate?"hidden":null}),";");s.propTypes={center:a.a.bool,vertical:a.a.bool,truncate:a.a.bool},s.defaultProps={truncate:!0},t.a=s},1871:function(e,t,r){"use strict";var n=r(18),a=r.n(n).a.createActions(["fetch","showAllSimilarItems","toggleUnmerge","toggleMerge","unmerge","merge","toggleCollapseFingerprint","toggleCollapseFingerprints"]);t.a=a},2121:function(e,t,r){"use strict";var n,a=r(2),i=r(3),s=Object(i.c)("div",{target:"e1pdx9kr0"})(n||(n=Object(a.f)(["\n  background: ",";\n  border: 1px solid ",";\n  border-bottom: none;\n  border-radius: 3px 3px 0 0;\n  box-shadow: 0 1px 0 ",";\n  margin: 0;\n"],["\n  background: ",";\n  border: 1px solid ",";\n  border-bottom: none;\n  border-radius: 3px 3px 0 0;\n  box-shadow: 0 1px 0 ",";\n  margin: 0;\n"])),(function(e){return e.theme.whiteDark}),(function(e){return e.theme.borderLight}),(function(e){return e.theme.borderLight}));t.a=s},2645:function(e,t,r){"use strict";r.r(t);var n=r(45),a=r.n(n),i=r(16),s=r.n(i),o=r(5),l=r(0),c=r.n(l),u=r(18),m=r.n(u),g=r(22),d=r.n(g),p=r(99),h=r.n(p),f=r(4),b=r(1871),v=r(1800),y=r(159),E=r(50),I=r(12),S=r.n(I),O=r(6),j=r.n(O),k=r(7),w=r.n(k),L=r(9),x=r.n(L),C=r(8),N=r.n(C),D=r(10),P=r.n(D),M=r(572),F=r(629),T=r(3),U=function(e){function t(){return j()(this,t),x()(this,N()(t).apply(this,arguments))}return P()(t,e),w()(t,[{key:"render",value:function(){var e=this.props.className;return c.a.createElement("div",{className:e},c.a.createElement("span",null,Object(f.b)("Similar")),c.a.createElement(q,{colorIndex:4}),c.a.createElement(q,{colorIndex:3}),c.a.createElement(q,{colorIndex:2}),c.a.createElement(q,{colorIndex:1}),c.a.createElement(q,{colorIndex:0}),c.a.createElement("span",null,Object(f.b)("Not Similar")))}}]),t}(c.a.Component);U.displayName="SimilarSpectrum";var A=Object(T.c)(U,{target:"e1hn3xkk0"})("display:flex;font-size:",(function(e){return e.theme.fontSizeSmall}),";"),q=Object(T.c)("span",{target:"e1hn3xkk1"})("border-radius:2px;margin:5px;width:14px;",(function(e){return void 0!==e.colorIndex&&"background-color: ".concat(e.theme.similarity.colors[e.colorIndex],";")}),";"),z=A,G=r(1743),W=r(575),R=r(250),B=r(36),K=r.n(B),J=r(83),V=r(255),H=r(344),Q=r(621),X=r(601),Y=r(1870),Z=r(343),$=r(34),_=r.n($),ee=r(41),te=function(e){function t(){return j()(this,t),x()(this,N()(t).apply(this,arguments))}return P()(t,e),w()(t,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.vertical,n=e.palette,a=e.score,i=e.size,s=e.thickness,o=n.length,l=a>=o?o:a<=0?0:a,u=l-1,m={vertical:r,thickness:s,size:i};return c.a.createElement("div",{className:t},_()(Array(l)).map((function(e,t){return c.a.createElement(ne,S()({},m,{key:t,color:n[u]}))})),_()(Array(o-l)).map((function(e,t){return c.a.createElement(ne,S()({key:"empty-".concat(t)},m,{empty:!0}))})))}}]),t}(c.a.Component);te.displayName="ScoreBar",te.defaultProps={size:40,thickness:4,palette:ee.a.similarity.colors};var re=Object(T.c)(te,{target:"eecxaw40"})("display:flex;",(function(e){return e.vertical&&"\n    flex-direction: column-reverse;\n    justify-content: flex-end;\n  "}),";"),ne=Object(T.c)("div",{target:"eecxaw41"})("border-radius:3px;margin:2px;",(function(e){return e.empty&&"background-color: ".concat(e.theme.similarity.empty,";")}),";",(function(e){return e.color&&"background-color: ".concat(e.color,";")}),";width:",(function(e){return e.vertical?e.size:e.thickness}),"px;height:",(function(e){return e.vertical?e.thickness:e.size}),"px;"),ae=re,ie=r(11),se={"exception:message:character-shingles":Object(f.b)("Exception Message"),"exception:stacktrace:application-chunks":Object(f.b)("Application Code"),"exception:stacktrace:pairs":Object(f.b)("Stacktrace Frames"),"message:message:character-shingles":Object(f.b)("Log Message")},oe=function(e){function t(){return j()(this,t),x()(this,N()(t).apply(this,arguments))}return P()(t,e),w()(t,[{key:"render",value:function(){var e=this.props.scoreList;return e.length?c.a.createElement("div",null,e.map((function(e){var t=a()(e,2),r=t[0],n=t[1];return c.a.createElement(le,{key:r},c.a.createElement("div",null,se[r]),c.a.createElement(ce,{score:null===n?n:Math.round(5*n)}))}))):null}}]),t}(c.a.Component);oe.displayName="SimilarScoreCard",oe.defaultProps={scoreList:[]};var le=Object(T.c)("div",{target:"e1am9g9r0"})("display:flex;justify-content:space-between;margin:",Object(ie.a)(.25)," 0;"),ce=Object(T.c)("div",{target:"e1am9g9r1"})("height:16px;width:48px;border-radius:2px;background-color:",(function(e){return null===e.score?e.theme.similarity.empty:e.theme.similarity.colors[e.score]}),";"),ue=oe,me=["exception","message"],ge=d()({displayName:"SimilarIssueItem",mixins:[m.a.listenTo(v.a,"onGroupingUpdate")],getInitialState:function(){return{visible:!0,checked:!1,busy:!1}},onGroupingUpdate:function(e){var t=this,r=e.mergeState,n=this.props.issue;if(r){var a=r.has(n.id)&&r.get(n.id);a&&Object.keys(a).forEach((function(e){a[e]!==t.state[e]&&t.setState(s()({},e,a[e]))}))}},handleToggle:function(){var e=this.props.issue;this.state.busy||b.a.toggleMerge(e.id)},handleShowDiff:function(e){var t=this.props,r=t.orgId,n=t.groupId,a=t.issue;Object(J.g)({baseIssueId:n,targetIssueId:a.id,projectId:a.project.slug,orgId:r}),e.stopPropagation()},handleCheckClick:function(){},render:function(){var e=this.props,t=e.aggregate,r=e.scoresByInterface,n=e.issue;if(!this.state.visible)return null;var a=K()("group","similar-issue",{isResolved:"resolved"===n.status,busy:this.state.busy});return c.a.createElement(G.a,{"data-test-id":"similar-item-row",className:a,responsive:!0,onClick:this.handleToggle},c.a.createElement(Y.a,{truncate:!0},c.a.createElement(Y.a,{truncate:!0},c.a.createElement("div",{className:"action-column"},c.a.createElement(V.a,{id:n.id,value:n.id,checked:this.state.checked,onChange:this.handleCheckClick})),c.a.createElement("div",{className:"event-details",style:{flex:1}},c.a.createElement(X.a,{data:n}),c.a.createElement(Q.a,S()({},n,{lastSeen:null,showAssignee:!0})))),c.a.createElement("button",{style:{marginRight:2},className:"btn btn-default btn-xs",onClick:this.handleShowDiff},"Diff")),c.a.createElement("div",{className:"similar-score-columns"},c.a.createElement(H.a,{className:"similar-score-column",value:n.count}),me.map((function(e){var n=t[e],a=r[e]||[],i="number"!=typeof n||Number.isNaN(n)?0:n;return c.a.createElement("div",{key:e,className:"similar-score-column"},c.a.createElement(Z.a,{body:a.length&&c.a.createElement(ue,{scoreList:a})},c.a.createElement(ae,{vertical:!0,score:Math.round(5*i)})))}))))}}),de=r(1682),pe=r(2121),he=r(332),fe=d()({displayName:"SimilarToolbar",mixins:[m.a.listenTo(v.a,"onGroupingUpdate")],getInitialState:function(){return{mergeCount:0}},onGroupingUpdate:function(e){var t=e.mergeList;t&&t.size!==this.state.mergedCount&&this.setState({mergeCount:t.size})},render:function(){var e=this.props.onMerge;return c.a.createElement(pe.a,{className:"similar-toolbar"},c.a.createElement(G.a,{responsive:!0},c.a.createElement(Y.a,{style:{flex:1}},c.a.createElement(Y.a,null,c.a.createElement("div",{className:"similar-toolbar-actions"},c.a.createElement(de.a,{"data-test-id":"merge",disabled:0===this.state.mergeCount,title:Object(f.b)("Merging ".concat(this.state.mergeCount," issues")),message:Object(f.b)("Are you sure you want to merge these issues?"),className:"btn btn-sm btn-default",onConfirm:e},Object(f.b)("Merge")," (",this.state.mergeCount||0,")")))),c.a.createElement("div",{className:"similar-score-columns"},c.a.createElement(he.a,{className:"similar-score-column event-count-header"},Object(f.b)("Events")),c.a.createElement(he.a,{className:"similar-score-column event-similar-header"},Object(f.b)("Exception")),c.a.createElement(he.a,{className:"similar-score-column event-similar-header"},Object(f.b)("Message")))))}}),be=function(e){function t(){var e,r;j()(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(r=x()(this,(e=N()(t)).call.apply(e,[this].concat(a)))).renderEmpty=function(){return c.a.createElement(R.a,null,c.a.createElement(W.a,null,c.a.createElement("p",null,Object(f.b)("There are no similar issues."))))},r.handleShowAll=function(){r.setState({showAllItems:!0})},r.state={showAllItems:!1},r}return P()(t,e),w()(t,[{key:"render",value:function(){var e=this.props,t=e.orgId,r=e.groupId,n=e.items,a=e.filteredItems,i=e.pageLinks,s=e.onMerge,o=!!a.length,l=n.length>0||o,u=n.concat(this.state.showAllItems&&a||[]);return l?c.a.createElement("div",{className:"similar-list-container"},c.a.createElement(G.a,{className:"similar-list-header"},c.a.createElement("h2",null,c.a.createElement("span",null,Object(f.b)("Similar Issues")),c.a.createElement(F.a,{count:n.length+a.length})),c.a.createElement(z,null)),c.a.createElement(fe,{onMerge:s}),c.a.createElement("div",{className:"similar-list"},u.map((function(e){return c.a.createElement(ge,S()({key:e.issue.id,orgId:t,groupId:r},e))})),o&&!this.state.showAllItems&&c.a.createElement("div",{className:"similar-items-footer"},c.a.createElement("button",{className:"btn btn-default btn-xl",onClick:this.handleShowAll},"Show ",a.length," issues below threshold"))),c.a.createElement(M.a,{pageLinks:i})):this.renderEmpty()}}]),t}(c.a.Component);be.displayName="SimilarList",be.defaultProps={filteredItems:[]};var ve=be;function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(r,!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ie=d()({displayName:"GroupGroupingView",mixins:[m.a.listenTo(v.a,"onGroupingUpdate")],getInitialState:function(){return{similarItems:[],filteredSimilarItems:[],similarLinks:[],loading:!0,error:!1}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){e.params.groupId===this.props.params.groupId&&e.location.search===this.props.location.search||this.fetchData()},onGroupingUpdate:function(e){var t=e.mergedParent,r=e.similarItems,n=e.similarLinks,a=e.filteredSimilarItems,i=e.loading,s=e.error;if(r)this.setState({similarItems:r,similarLinks:n,filteredSimilarItems:a,loading:void 0!==i&&i,error:void 0!==s&&s});else if(t&&t!==this.props.params.groupId){var l=this.props.params;o.browserHistory.push("/organizations/".concat(l.orgId,"/issues/").concat(t,"/similar/"))}},getEndpoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"similar",t=this.props.params,r=Ee({},this.props.location.query,{limit:50});return"/issues/".concat(t.groupId,"/").concat(e,"/?").concat(h.a.stringify(r))},hasSimilarityFeature:function(){return new Set(this.props.project.features).has("similarity-view")},fetchData:function(){this.setState({loading:!0,error:!1});var e=[];this.hasSimilarityFeature()&&e.push({endpoint:this.getEndpoint("similar"),dataKey:"similar",queryParams:this.props.location.query}),b.a.fetch(e)},handleMerge:function(){var e=this.props,t=e.query,r=e.params;if(r){var n=this.state.similarItems.length?this.state.similarItems:this.state.filteredSimilarItems,i=a()(n,1)[0];b.a.merge({params:r,query:t,projectId:i.issue.project.slug})}},render:function(){var e=this.props.params,t=e.orgId,r=e.groupId,n=this.state.loading,a=this.state.error&&!n,i=!a&&!n,s=this.hasSimilarityFeature()&&(this.state.similarItems.length>=0||this.state.filteredSimilarItems.length>=0)&&i;return c.a.createElement("div",null,c.a.createElement("div",{className:"alert alert-block alert-warning"},c.a.createElement("strong",null,Object(f.b)("Warning"),":")," ",Object(f.b)("This is an experimental feature. Data may not be immediately available while we process merges.")),n&&c.a.createElement(E.default,null),a&&c.a.createElement(y.a,{message:"Unable to load similar issues, please try again later",onRetry:this.fetchData}),s&&c.a.createElement(ve,{items:this.state.similarItems,filteredItems:this.state.filteredSimilarItems,onMerge:this.handleMerge,orgId:t,groupId:r,pageLinks:this.state.similarLinks}))}});t.default=Ie},2656:function(e,t,r){"use strict";r.r(t);var n=r(16),a=r.n(n),i=r(0),s=r.n(i),o=r(18),l=r.n(o),c=r(22),u=r.n(c),m=r(99),g=r.n(m),d=r(4),p=r(1871),h=r(1800),f=r(159),b=r(50),v=r(6),y=r.n(v),E=r(7),I=r.n(E),S=r(9),O=r.n(S),j=r(8),k=r.n(j),w=r(10),L=r.n(w),x=r(3),C=r(250),N=r(575),D=r(572),P=r(629),M=r(12),F=r.n(M),T=r(20),U=r.n(T),A=r(144),q=r(255),z=r(601),G=r(1870),W=r(11),R=u()({displayName:"MergedItem",mixins:[l.a.listenTo(h.a,"onGroupingChange")],getInitialState:function(){return{collapsed:!1,checked:!1,busy:!1}},onGroupingChange:function(e){var t=this,r=e.unmergeState;if(r){var n=this.props.fingerprint,i=r.has(n)&&r.get(n);i&&Object.keys(i).forEach((function(e){i[e]!==t.state[e]&&t.setState(a()({},e,i[e]))}))}},handleToggleEvents:function(){var e=this.props.fingerprint;p.a.toggleCollapseFingerprint(e)},handleLabelClick:function(e){e.preventDefault()},handleToggle:function(){var e=this.props,t=e.disabled,r=e.fingerprint,n=e.event;t||this.state.busy||p.a.toggleUnmerge([r,n.id])},handleCheckClick:function(){},render:function(){var e=this.props,t=e.disabled,r=e.event,n=e.fingerprint,a=t||this.state.disabled;return s.a.createElement(B,{busy:this.state.busy},s.a.createElement(J,{expanded:!this.state.collapsed},s.a.createElement(G.a,{onClick:this.handleToggle},s.a.createElement(K,null,s.a.createElement(q.a,{id:n,value:n,checked:this.state.checked,disabled:a,onChange:this.handleCheckClick})),s.a.createElement(V,{onClick:this.handleLabelClick,htmlFor:n},n)),s.a.createElement("div",null,s.a.createElement("span",null),s.a.createElement(H,{onClick:this.handleToggleEvents},this.state.collapsed?s.a.createElement("i",{className:"icon-arrow-down"}):s.a.createElement("i",{className:"icon-arrow-up"})))),!this.state.collapsed&&s.a.createElement(Q,{className:"event-list"},r&&s.a.createElement(X,{className:"event-details"},s.a.createElement(G.a,null,s.a.createElement(z.a,{data:r,hideIcons:!0,hideLevel:!0})))))}}),B=Object(x.c)("div",{target:"e9r3vga0"})((function(e){return e.busy&&"opacity: 0.2"}),";"),K=Object(x.c)(A.b,{target:"e9r3vga1"})("padding:0 10px;align-items:center;input{margin:0;}"),J=Object(x.c)((function(e){e.expanded;var t=U()(e,["expanded"]);return s.a.createElement(A.b,F()({justify:"space-between"},t))}),{target:"e9r3vga2"})("border-top:1px solid ",(function(e){return e.theme.borderLight}),";background-color:#f3f1f6;padding:",Object(W.a)(.5)," 0;",(function(e){return e.expanded&&"border-bottom: 1px solid ".concat(e.theme.borderLight)}),";",B,"{&:first-child &{border-top:none;}&:last-child &{border-top:none;border-bottom:1px solid ",(function(e){return e.theme.borderLight}),";}}"),V=Object(x.c)("label",{target:"e9r3vga3"})("font-family:",(function(e){return e.theme.text.familyMono}),";",J," &{font-weight:normal;margin:0;}"),H=Object(x.c)("span",{target:"e9r3vga4"})("cursor:pointer;padding:0 10px;"),Q=Object(x.c)("div",{target:"e9r3vga5"})("overflow:hidden;border:none;"),X=Object(x.c)(A.b,{target:"e9r3vga6"})("justify-content:space-between;.event-list &{padding:10px;}"),Y=R,Z=r(45),$=r.n(Z),_=r(146),ee=r.n(_),te=r(83),re=r(27),ne=r(1682),ae=r(1743),ie=r(2121),se=u()({displayName:"MergedToolbar",mixins:[l.a.listenTo(h.a,"onGroupingUpdate")],getInitialState:function(){var e=h.a.unmergeList,t=h.a.unmergeLastCollapsed,r=h.a.unmergeDisabled;return{enableFingerprintCompare:h.a.enableFingerprintCompare,unmergeList:e,unmergeLastCollapsed:t,unmergeDisabled:r}},onGroupingUpdate:function(e){this.setState(ee()(e,["unmergeLastCollapsed","unmergeDisabled","unmergeList","enableFingerprintCompare"]))},handleShowDiff:function(e){var t=this.props,r=t.groupId,n=t.projectId,a=t.orgId,i=this.state.unmergeList.entries();if(2===this.state.unmergeList.size){var s=Array.from(i).map((function(e){return $()(e,2)[1]})),o=$()(s,2),l=o[0],c=o[1];Object(te.g)({baseIssueId:r,targetIssueId:r,baseEventId:l,targetEventId:c,orgId:a,projectId:n}),e.stopPropagation()}},render:function(){var e=this.props,t=e.onUnmerge,r=e.onToggleCollapse,n=this.state.unmergeList&&this.state.unmergeList.size||0;return s.a.createElement(le,null,s.a.createElement(ae.a,null,s.a.createElement(ae.a,null,s.a.createElement("div",null,s.a.createElement(ne.a,{disabled:this.state.unmergeDisabled,title:Object(d.b)("Unmerging ".concat(n," events")),message:Object(d.b)("These events will be unmerged and grouped into a new issue. Are you sure you want to unmerge these events?"),className:"btn btn-sm btn-default",onConfirm:t},Object(d.b)("Unmerge")," (",n||0,")"),s.a.createElement(oe,{size:"small",disabled:!this.state.enableFingerprintCompare,onClick:this.handleShowDiff},Object(d.b)("Compare")))),s.a.createElement(ae.a,null,s.a.createElement("div",null,s.a.createElement(re.a,{size:"small",onClick:r},this.state.unmergeLastCollapsed?Object(d.b)("Expand All"):Object(d.b)("Collapse All"))))))}}),oe=Object(x.c)(re.a,{target:"e1seayw30"})("margin-left:",Object(W.a)(1),";"),le=Object(x.c)(ie.a,{target:"e1seayw31"})("padding:",Object(W.a)(.5)," ",Object(W.a)(1),";"),ce=se,ue=function(e){function t(){var e,r;y()(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(r=O()(this,(e=k()(t)).call.apply(e,[this].concat(a)))).renderEmpty=function(){return s.a.createElement(N.a,null,s.a.createElement("p",null,Object(d.b)("There don't seem to be any hashes for this issue.")))},r}return L()(t,e),I()(t,[{key:"render",value:function(){var e=this.props,t=e.items,r=e.pageLinks,n=e.onToggleCollapse,a=e.onUnmerge,i=e.orgId,o=e.projectId,l=t.filter((function(e){return!!e.latestEvent}));return l.length>0?s.a.createElement("div",null,s.a.createElement("h2",null,s.a.createElement("span",null,Object(d.b)("Merged fingerprints with latest event")),s.a.createElement(P.a,{count:l.length})),s.a.createElement(ce,{onToggleCollapse:n,onUnmerge:a,orgId:i,projectId:o}),s.a.createElement(ge,null,l.map((function(e){var r=e.id,n=e.latestEvent;return s.a.createElement(Y,{key:r,disabled:1===t.length,event:n,fingerprint:r})}))),s.a.createElement(D.a,{pageLinks:r})):s.a.createElement(C.a,null,this.renderEmpty())}}]),t}(s.a.Component);ue.displayName="MergedList";var me=ue,ge=Object(x.c)("div",{target:"e16p6prb0"})("border:1px solid ",(function(e){return e.theme.borderLight}),";border-top:none;");function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(r,!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.d(t,"GroupMergedView",(function(){return he}));var he=u()({displayName:"GroupMergedView",mixins:[l.a.listenTo(h.a,"onGroupingUpdate")],getInitialState:function(){return{mergedItems:[],loading:!0,error:!1,query:this.props.location.query.query||""}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){if(e.params.groupId!==this.props.params.groupId||e.location.search!==this.props.location.search){var t=e.location.query;this.setState({query:t.query},this.fetchData)}},onGroupingUpdate:function(e){var t=e.mergedItems,r=e.mergedLinks,n=e.loading,a=e.error;t&&this.setState({mergedItems:t,mergedLinks:r,loading:void 0!==n&&n,error:void 0!==a&&a})},getEndpoint:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hashes",t=this.props.params,r=pe({},this.props.location.query,{limit:50,query:this.state.query});return"/issues/".concat(t.groupId,"/").concat(e,"/?").concat(g.a.stringify(r))},fetchData:function(){p.a.fetch([{endpoint:this.getEndpoint("hashes"),dataKey:"merged",queryParams:this.props.location.query}])},handleCollapse:function(){p.a.collapseFingerprints()},handleUnmerge:function(){p.a.unmerge({groupId:this.props.params.groupId,loadingMessage:"".concat(Object(d.b)("Unmerging events"),"..."),successMessage:Object(d.b)("Events successfully queued for unmerging."),errorMessage:Object(d.b)("Unable to queue events for unmerging.")})},render:function(){var e=this.state.loading,t=this.state.error&&!e,r=!t&&!e;return s.a.createElement("div",null,s.a.createElement("div",{className:"alert alert-block alert-warning"},s.a.createElement("strong",null,Object(d.b)("Warning"),":")," ",Object(d.b)("This is an experimental feature. Data may not be immediately available while we process unmerges.")),e&&s.a.createElement(b.default,null),t&&s.a.createElement(f.a,{message:"Unable to load merged events, please try again later",onRetry:this.fetchData}),r&&s.a.createElement(me,{orgId:this.props.params.orgId,projectId:this.props.project.slug,items:this.state.mergedItems,pageLinks:this.state.mergedLinks,onUnmerge:this.handleUnmerge,onToggleCollapse:p.a.toggleCollapseFingerprints}))}});t.default=he}}]);
//# sourceMappingURL=GroupSimilarView.js.map
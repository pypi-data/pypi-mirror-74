(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[126],{1611:function(e,t,a){"use strict";var n,r,c,o,i,s=a(2),u=a(1),l=a.n(u),m=a(0),d=a.n(m),f=a(3),g=a(11),b=a(337),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,a=e.title,n=e.action,r=e.tabs,c=e.noTitleStyles,o=Object(s.h)(e,["icon","title","action","tabs","noTitleStyles"]);return d.a.createElement("div",Object(s.a)({},o),d.a.createElement(h,null,t&&d.a.createElement(O,null,t),a&&d.a.createElement(j,{tabs:r,styled:c},d.a.createElement(b.a,null,a)),n&&d.a.createElement(v,{tabs:r},n)),r&&d.a.createElement("div",null,r))},t.propTypes={icon:l.a.node,title:l.a.node.isRequired,action:l.a.node,tabs:l.a.node,noTitleStyles:l.a.bool},t.defaultProps={noTitleStyles:!1},t}(d.a.Component),h=Object(f.c)("div",{target:"e1uay4fd0"})(n||(n=Object(s.f)(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"]))),j=Object(f.c)("div",{target:"e1uay4fd1"})(r||(r=Object(s.f)(["\n  ",";\n  margin: ",";\n  flex: 1;\n"],["\n  ",";\n  margin: ",";\n  flex: 1;\n"])),(function(e){return!e.styled&&"\n    font-size: 20px;\n    font-weight: bold;"}),(function(e){return e.tabs?Object(g.a)(4)+" 0 "+Object(g.a)(2):Object(g.a)(4)+" 0"})),O=Object(f.c)("div",{target:"e1uay4fd2"})(c||(c=Object(s.f)(["\n  margin-right: ",";\n"],["\n  margin-right: ",";\n"])),Object(g.a)(1)),v=Object(f.c)("div",{target:"e1uay4fd3"})(o||(o=Object(s.f)(["\n  ",";\n"],["\n  ",";\n"])),(function(e){return e.tabs?"margin-top: "+Object(g.a)(2):null})),E=Object(f.c)(p,{target:"e1uay4fd4"})(i||(i=Object(s.f)(["\n  font-size: 14px;\n  margin-top: -",";\n"],["\n  font-size: 14px;\n  margin-top: -",";\n"])),Object(g.a)(4));t.a=E},1618:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(577),r=a.n(n),c=a(447);function o(e,t){var a,n,o=t.routes,i=t.params,s=t.location,u=t.stepBack,l=o.map((function(e){return e.path||""}));"string"!=typeof e?(n=o.indexOf(e)+1,a=r()(l.slice(0,n),(function(e){return"/"===e[0]}))):a=r()(l,(function(e){return"/"===e[0]}));var m=l.slice(a,n);void 0!==u&&(m=m.slice(0,u));var d=void 0!==s&&s.search?s.search:"",f=""+m.join("")+("string"!=typeof e?"":e)+d;return Object(c.a)(f,i)}},1632:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(251),o=a.n(c);t.a=function(e){var t=e.title+" - "+e.objSlug+" - Sentry";return r.a.createElement(o.a,{title:t},e.children)}},1690:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"g",(function(){return u})),a.d(t,"f",(function(){return l})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return d})),a.d(t,"a",(function(){return f})),a.d(t,"e",(function(){return g}));var n=a(111),r=a(4),c=a(51),o=a(174),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("function"==typeof e[t]){for(var a=arguments.length,n=new Array(a>2?a-2:0),r=2;r<a;r++)n[r-2]=arguments[r];e[t].apply(e,n)}};function s(e,t,a){return n.a.fetchDetails(t.teamId),e.request("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{success:function(e){n.a.fetchDetailsSuccess(t.teamId,e),i(a,"success",e)},error:function(e){n.a.fetchDetailsError(t.teamId,e),i(a,"error",e)}})}function u(e,t){n.a.updateSuccess(e,t)}function l(e,t,a){var r="/teams/".concat(t.orgId,"/").concat(t.teamId,"/");return n.a.update(t.teamId,t.data),e.request(r,{method:"PUT",data:t.data,success:function(e){u(t.teamId,e),i(a,"success",e)},error:function(e){n.a.updateError(t.teamId,e),i(a,"error",e)}})}function m(e,t,a){var r="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),c=Object(o.a)();return n.a.update(c,t.teamId),e.request(r,{method:"POST",data:t.data,success:function(e){n.a.updateSuccess(t.teamId,e),i(a,"success",e)},error:function(e){n.a.updateError(c,t.teamId,e),i(a,"error",e)}})}function d(e,t,a){var r="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),c=Object(o.a)();return n.a.update(c,t.teamId),e.request(r,{method:"DELETE",success:function(e){n.a.updateSuccess(t.teamId,e),i(a,"success",e)},error:function(e){n.a.updateError(c,t.teamId,e),i(a,"error",e)}})}function f(e,t,a,o){return n.a.createTeam(t),e.requestPromise("/organizations/".concat(a.orgId,"/teams/"),{method:"POST",data:t}).then((function(e){return n.a.createTeamSuccess(e),Object(c.d)(Object(r.c)("[team] has been added to the [organization] organization",{team:"#".concat(e.slug),organization:a.orgId})),e}),(function(e){throw n.a.createTeamError(t.slug||t.name,e),Object(c.a)(Object(r.c)("Unable to create [team] in the [organization] organization",{team:"#".concat(t.slug||t.name),organization:a.orgId})),e}))}function g(e,t,a){return n.a.removeTeam(t.teamId),e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{method:"DELETE"}).then((function(e){return n.a.removeTeamSuccess(t.teamId,e),Object(c.d)(Object(r.c)("[team] has been removed from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}),(function(e){throw n.a.removeTeamError(t.teamId,e),Object(c.a)(Object(r.c)("Unable to remove [team] from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}))}},2650:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),c=a(0),o=a.n(c),i=a(18),s=a.n(i),u=a(22),l=a.n(u),m=a(349),d=a(21),f=a(140),g=a(161),b=a(61),p=a(86),h=a(6),j=a.n(h),O=a(7),v=a.n(O),E=a(9),T=a.n(E),y=a(8),z=a.n(y),I=a(10),S=a.n(I),C=a(83),w=a(1632),L=a(4),k=a(27),M=a(250),x=a(1611),P=a(1618),q=a(5),A=a(570),D=a(339),U=a(23),R=a.n(U),Y=a(3),J=a(51),N=a(1690),B=a(345),W=a(11),F=function(e){function t(){var e,a;j()(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=T()(this,(e=z()(t)).call.apply(e,[this].concat(r)))).state={loading:!1,error:!1},a.handleRequestAccess=function(){var e;return R.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e=a.props.team;try{a.joinTeam({successMessage:Object(L.c)("You have requested access to [team]",{team:"#".concat(e.slug)}),errorMessage:Object(L.c)("Unable to request access to [team]",{team:"#".concat(e.slug)})})}catch(e){}case 2:case"end":return t.stop()}}))},a.handleJoinTeam=function(){var e=a.props.team;a.joinTeam({successMessage:Object(L.c)("You have joined [team]",{team:"#".concat(e.slug)}),errorMessage:Object(L.c)("Unable to join [team]",{team:"#".concat(e.slug)})})},a.joinTeam=function(e){var t=e.successMessage,n=e.errorMessage,r=a.props,c=r.api,o=r.organization,i=r.team;return a.setState({loading:!0}),new Promise((function(e,r){return Object(N.c)(c,{orgId:o.slug,teamId:i.slug},{success:function(){a.setState({loading:!1,error:!1}),Object(J.d)(t),e()},error:function(){a.setState({loading:!1,error:!0}),Object(J.a)(n),r(new Error("Unable to join team"))}})}))},a.handleLeaveTeam=function(){var e=a.props,t=e.api,n=e.organization,r=e.team;a.setState({loading:!0}),Object(N.d)(t,{orgId:n.slug,teamId:r.slug},{success:function(){a.setState({loading:!1,error:!1}),Object(J.d)(Object(L.c)("You have left [team]",{team:"#".concat(r.slug)}))},error:function(){a.setState({loading:!1,error:!0}),Object(J.a)(Object(L.c)("Unable to leave [team]",{team:"#".concat(r.slug)}))}})},a}return S()(t,e),v()(t,[{key:"render",value:function(){var e=this.props,t=e.team,a=e.urlPrefix,n=e.openMembership,r=o.a.createElement(B.a,{team:t,avatarSize:36,description:Object(L.d)("%s Member","%s Members",t.memberCount)}),c=t.hasAccess;return o.a.createElement(K,null,o.a.createElement(V,null,c?o.a.createElement(G,{to:"".concat(a,"teams/").concat(t.slug,"/")},r):r),o.a.createElement(Q,null,this.state.loading?o.a.createElement(k.a,{size:"small",disabled:!0},"..."):t.isMember?o.a.createElement(k.a,{size:"small",onClick:this.handleLeaveTeam},Object(L.b)("Leave Team")):t.isPending?o.a.createElement(k.a,{size:"small",disabled:!0},Object(L.b)("Request Pending")):n?o.a.createElement(k.a,{size:"small",onClick:this.handleJoinTeam},Object(L.b)("Join Team")):o.a.createElement(k.a,{size:"small",onClick:this.handleRequestAccess},Object(L.b)("Request Access"))))}}]),t}(o.a.Component);F.displayName="AllTeamsRow";var G=Object(Y.c)(q.Link,{target:"ekr4bwh0"})("display:inline-block;&.focus-visible{margin:-",Object(W.a)(1),";padding:",Object(W.a)(1),";background:#f2eff5;border-radius:3px;outline:none;}"),H=Object(b.a)(F),K=Object(Y.c)(M.f,{target:"ekr4bwh1"})("padding:0;align-items:center;"),Q=Object(Y.c)("div",{target:"ekr4bwh2"})("padding:",Object(W.a)(2),";"),V=Object(Y.c)(Q,{target:"ekr4bwh3"})("flex:1;"),X=function(e){function t(){var e,a;j()(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=T()(this,(e=z()(t)).call.apply(e,[this].concat(r)))).handleCreateTeam=function(e){var t=a.props,n=t.useCreateModal,r=t.organization;n&&(e.preventDefault(),Object(C.e)({organization:r,onClose:function(){}}))},a}return S()(t,e),v()(t,[{key:"render",value:function(){var e=this.props,t=e.access,a=e.organization,n=e.urlPrefix,r=e.openMembership,c=e.useCreateModal,i=this.props.teamList.map((function(e,c){return o.a.createElement(H,{urlPrefix:n,access:t,team:e,organization:a,openMembership:r,key:e.slug})}));if(0!==i.length)return i;var s=c?"#":"/organizations/".concat(a.slug,"/teams/new/");return o.a.createElement(A.a,null,Object(L.c)("No teams here. [teamCreate]",{root:o.a.createElement(D.a,{noMargin:!0}),teamCreate:t.has("project:admin")?Object(L.c)("You can always [link:create one].",{link:o.a.createElement(q.Link,{to:s,onClick:this.handleCreateTeam})}):null}))}}]),t}(o.a.Component);X.displayName="AllTeamsList";var Z=X,$=function(e){function t(){return j()(this,t),T()(this,z()(t).apply(this,arguments))}return S()(t,e),v()(t,[{key:"render",value:function(){var e=this.props,t=e.allTeams,a=e.activeTeams,n=e.organization,r=e.access,c=e.features,i=e.routes,s=e.params,u=n;if(!n)return null;var l=r.has("project:admin"),m=o.a.createElement(k.a,{priority:"primary",size:"small",disabled:!l,title:l?void 0:Object(L.b)("You do not have permission to create teams"),onClick:function(){return Object(C.e)({organization:n})},icon:"icon-circle-add"},Object(L.b)("Create Team")),d=i.find((function(e){return"teams/"===e.path})),f=Object(P.a)(d,{routes:i,params:s,stepBack:-2}),g=new Set(a.map((function(e){return e.id}))),b=t.filter((function(e){return!g.has(e.id)})),p=Object(L.b)("Teams");return o.a.createElement("div",{"data-test-id":"team-list"},o.a.createElement(w.a,{title:p,objSlug:n.slug}),o.a.createElement(x.a,{title:p,action:m}),o.a.createElement(M.a,null,o.a.createElement(M.e,null,Object(L.b)("Your Teams")),o.a.createElement(M.c,null,o.a.createElement(Z,{useCreateModal:!0,urlPrefix:f,organization:u,teamList:a,access:r,openMembership:!1}))),o.a.createElement(M.a,null,o.a.createElement(M.e,null,Object(L.b)("Other Teams")),o.a.createElement(M.c,null,o.a.createElement(Z,{useCreateModal:!0,urlPrefix:f,organization:u,teamList:b,access:r,openMembership:!(!c.has("open-membership")&&!r.has("org:write"))}))))}}]),t}(o.a.Component);$.displayName="OrganizationTeams";var _=$;a.d(t,"OrganizationTeamsContainer",(function(){return ee}));var ee=l()({displayName:"OrganizationTeamsContainer",mixins:[s.a.listenTo(g.a,"onTeamListChange"),s.a.listenTo(f.a,"onProjectListChange")],getInitialState:function(){return{teamList:Object(d.s)(g.a.getAll(),(function(e){return e&&e.name})),projectList:Object(d.s)(f.a.getAll(),(function(e){return e&&e.name})),projectStats:{}}},componentDidMount:function(){this.fetchStats()},fetchStats:function(){Object(m.e)(this.props.api,{orgId:this.props.params.orgId,query:{since:(new Date).getTime()/1e3-86400,stat:"generated",group:"project"}})},onTeamListChange:function(){var e=g.a.getAll();this.setState({teamList:Object(d.s)(e,(function(e){return e.name}))})},onProjectListChange:function(){var e=f.a.getAll();this.setState({projectList:Object(d.s)(e,(function(e){return e.name}))})},render:function(){var e=this.props.organization;if(!e)return null;var t=this.state.teamList,a=this.state.teamList.filter((function(e){return e.isMember}));return o.a.createElement(_,r()({},this.props,{access:new Set(e.access),features:new Set(e.features),organization:e,projectList:this.state.projectList,allTeams:t,activeTeams:a}))}});t.default=Object(b.a)(Object(p.a)(ee))}}]);
//# sourceMappingURL=OrganizationTeams.js.map
(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[82],{1631:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(9),i=n.n(r),o=n(10),a=n.n(o),c=n(11),s=n.n(c),l=n(12),u=n.n(l),p=n(6),f=n.n(p),d=n(282),g=n.n(d),h=(n(1),n(1632)),v=n(0);function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var b=function(t){s()(r,t);var e,n=(e=r,function(){var t,n=f()(e);if(y()){var r=f()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u()(this,t)});function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var t=this.getTitle();return Object(v.f)(g.a,{title:"".concat(t?"".concat(t," - "):"","Sentry")},this.renderComponent())}}]),r}(h.a);b.displayName="AsyncView"},1929:function(t,e,n){"use strict";n.d(e,"a",(function(){return z}));var r=n(16),i=n.n(r),o=n(9),a=n.n(o),c=n(10),s=n.n(c),l=n(11),u=n.n(l),p=n(12),f=n.n(p),d=n(6),g=n.n(d),h=n(1),v=n.n(h),y=n(89),b=n(32),O=n(3),m=n(639);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var z=function(t){u()(r,t);var e,n=(e=r,function(){var t,n=g()(e);if(k()){var r=g()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f()(this,t)});function r(){var t;a()(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))).dialog=null,t.openDialog=function(e){var n=t.props.integrationId;Object(m.k)(w({eventKey:n?"integrations.reauth_start":"integrations.installation_start",eventName:n?"Integrations: Reauth Start":"Integrations: Installation Start",integration:t.props.provider.key,integration_type:"first_party"},t.props.analyticsParams),t.props.organization);var r=t.props.provider.setupDialog,i=r.url,o=r.width,a=r.height,c=t.computeCenteredWindow(o,a),s=c.left,l=c.top,u=w({},e);n&&(u.integration_id=n),t.props.account&&(u.account=t.props.account);var p="".concat(i,"?").concat(y.stringify(u)),f="scrollbars=yes,width=".concat(o,",height=").concat(a,",top=").concat(l,",left=").concat(s);t.dialog=window.open(p,"sentryAddIntegration",f),t.dialog&&t.dialog.focus()},t.didReceiveMessage=function(e){var n=t.props.integrationId;if(e.origin===document.location.origin&&e.source===t.dialog){var r=e.data,i=r.success,o=r.data;t.dialog=null,i?o&&(t.props.onInstall(o),Object(m.k)(w({eventKey:n?"integrations.reauth_complete":"integrations.installation_complete",eventName:n?"Integrations: Reauth Complete":"Integrations: Installation Complete",integration:t.props.provider.key,integration_type:"first_party"},t.props.analyticsParams),t.props.organization),Object(b.d)(Object(O.b)("%s added",t.props.provider.name))):Object(b.a)(o.error)}},t}return s()(r,[{key:"componentDidMount",value:function(){window.addEventListener("message",this.didReceiveMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.didReceiveMessage),this.dialog&&this.dialog.close()}},{key:"computeCenteredWindow",value:function(t,e){var n=void 0!==window.screenLeft?window.screenLeft:window.screenX,r=void 0!==window.screenTop?window.screenTop:window.screenY;return{left:(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-t/2+n,top:(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-e/2+r}}},{key:"render",value:function(){return this.props.children(this.openDialog)}}]),r}(v.a.Component);z.displayName="AddIntegration"},2809:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return T}));var r=n(43),i=n.n(r),o=n(5),a=n.n(o),c=n(16),s=n.n(c),l=n(9),u=n.n(l),p=n(10),f=n.n(p),d=n(141),g=n.n(d),h=n(11),v=n.n(h),y=n(12),b=n.n(y),O=n(6),m=n.n(O),j=n(4),w=n(1),k=n.n(w),z=n(32),I=n(3),P=n(639),S=n(1929),D=n(88),R=n(1631),_=n(31),A=n(632),E=n(340),C=n(165),W=n(0);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function N(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var T=function(t){v()(r,t);var e,n=(e=r,function(){var t,n=m()(e);if(N()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b()(this,t)});function r(){var t;u()(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))).onInstall=function(e){var n=t.state.organization,r=n&&n.slug;t.props.router.push("/settings/".concat(r,"/integrations/").concat(e.provider.key,"/").concat(e.id))},t.onSelectOrg=function(e){var n=e.value;t.setState({selectedOrg:n,reloading:!0});t.api.request("/organizations/".concat(n,"/"),{success:function(e){return t.setState({organization:e,reloading:!1},t.trackOpened)},error:function(){t.setState({reloading:!1}),Object(z.a)(Object(I.b)("Failed to retrieve organization details"))}}),t.api.request("/organizations/".concat(n,"/config/integrations/"),{success:function(e){return t.setState({providers:e.providers,reloading:!1})},error:function(){t.setState({reloading:!1}),Object(z.a)(Object(I.b)("Failed to retrieve integration provider details"))}})},t.hasAccess=function(t){return t.access.includes("org:integrations")},t}return f()(r,[{key:"getDefaultState",value:function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},g()(m()(r.prototype),"getDefaultState",this).call(this),{selectedOrg:null,organization:null,providers:[]})}},{key:"getEndpoints",value:function(){return[["organizations","/organizations/"]]}},{key:"getTitle",value:function(){return Object(I.b)("Choose Installation Organization")}},{key:"trackOpened",value:function(){var t=this.state.organization,e=this.provider;t&&e&&Object(P.k)({eventKey:"integrations.install_modal_opened",eventName:"Integrations: Install Modal Opened",integration_type:"first_party",integration:e.key,already_installed:!1,view:"external_install"},t,{startSession:!0})}},{key:"renderAddButton",value:function(){var t=this,e=this.state,n=e.organization,r=e.reloading,i=this.props.params.installationId,o=function(t){return Object(W.f)(_.a,a()({priority:"primary",busy:r},t),"Install Integration")};return this.provider?Object(W.f)(S.a,{provider:this.provider,onInstall:this.onInstall},(function(e){return Object(W.f)(o,{disabled:!!n&&!t.hasAccess(n),onClick:function(){return e({installation_id:i})}})})):Object(W.f)(o,{disabled:!0})}},{key:"renderBody",value:function(){var t=this,e=this.state,n=e.organization,r=e.selectedOrg,o=this.state.organizations.map((function(t){return[t.slug,t.slug]})),a=Object(P.d)().FeatureList;return Object(W.f)(E.a,null,Object(W.f)("h3",null,Object(I.b)("Finish integration installation")),Object(W.f)("p",null,Object(I.c)("Please pick a specific [organization:organization] to link with\n            your integration installation.",{organization:Object(W.f)("strong",null)})),r&&n&&!this.hasAccess(n)&&Object(W.f)(D.b,{type:"error",icon:"icon-circle-exclamation"},Object(W.f)("p",null,Object(I.c)("You do not have permission to install integrations in\n                  [organization]. Ask an organization owner or manager to\n                  visit this page to finish installing this integration.",{organization:Object(W.f)("strong",null,n.slug)})),Object(W.f)(x,null,window.location.href)),this.provider&&n&&this.hasAccess(n)&&a&&Object(W.f)(k.a.Fragment,null,Object(W.f)("p",null,Object(I.c)("The following features will be available for [organization] when installed.",{organization:Object(W.f)("strong",null,n.slug)})),Object(W.f)(a,{organization:n,features:this.provider.metadata.features,provider:this.provider})),Object(W.f)(A.a,{label:Object(I.b)("Organization"),inline:!1,stacked:!0,required:!0},(function(){return Object(W.f)(C.a,{deprecatedSelectControl:!0,onChange:t.onSelectOrg,value:r,placeholder:Object(I.b)("Select an organization"),options:o.map((function(t){var e=i()(t,2);return{value:e[0],label:e[1]}}))})})),Object(W.f)("div",{className:"form-actions"},this.renderAddButton()))}},{key:"provider",get:function(){var t=this;return this.state.providers.find((function(e){return e.key===t.props.params.providerId}))}}]),r}(R.a),x=Object(j.a)("pre",{target:"emticm40",label:"InstallLink"})({name:"1y327hp",styles:"margin-bottom:0;background:#fbe3e1;"})}}]);
//# sourceMappingURL=ExtensionsIntegrationInstallation.js.map
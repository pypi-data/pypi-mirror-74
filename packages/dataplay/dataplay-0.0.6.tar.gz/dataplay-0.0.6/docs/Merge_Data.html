---

title: Merge Data

keywords: fastai
sidebar: home_sidebar

summary: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
description: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/02_Merge_Data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/content/drive/My Drive/dataplay/dataplay/acsDownload.py:27: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option(&#39;display.max_colwidth&#39;, -1)
/usr/local/lib/python3.6/dist-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use &#34;pip install psycopg2-binary&#34; instead. For details see: &lt;http://initd.org/psycopg/docs/install.html#binary-install-from-pypi&gt;.
  &#34;&#34;&#34;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This Coding Notebook is the <strong>second</strong> in a series.</p>
<p>An Interactive version can be found here <a href="https://colab.research.google.com/github/karpatic/dataplay/blob/master/notebooks/02_Merge_Data.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>.</p>
<p>This colab and more can be found on our <a href="https://karpatic.github.io/dataplay/">webpage</a>.</p>
<ul>
<li><p>Content covered in previous tutorials will be used in later tutorials.</p>
</li>
<li><p><strong>New code and or  information <em>should</em> have explanations and or descriptions</strong> attached.</p>
</li>
<li><p>Concepts or code covered in previous tutorials will be used without being explaining in entirety.</p>
</li>
<li><p>The <a href="https://karpatic.github.io/dataplay/">Dataplay</a> Handbook development techniques covered in the <a href="https://karpatic.github.io/datalabs/">Datalabs</a> Guidebook</p>
</li>
<li><p><strong>If content can not be found in the current tutorial and is not covered in previous tutorials, please let me know.</strong></p>
</li>
<li><p>This notebook has been optimized for Google Colabs ran on a Chrome Browser.</p>
</li>
<li><p>Statements found in the index page on view expressed, responsibility, errors and ommissions, use at risk, and licensing  extend throughout the tutorial.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About-this-Tutorial:">About this Tutorial:<a class="anchor-link" href="#About-this-Tutorial:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Whats-Inside?">Whats Inside?<a class="anchor-link" href="#Whats-Inside?"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-Tutorial"><strong>The Tutorial</strong><a class="anchor-link" href="#The-Tutorial"> </a></h4><p>In this notebook, the basics of how to perform a merge are introduced.</p>
<ul>
<li>We will merge two datasets</li>
<li>We will merge two datasets using a crosswalk</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Objectives"><strong>Objectives</strong><a class="anchor-link" href="#Objectives"> </a></h4><p>By the end of this tutorial users should have an understanding of:</p>
<ul>
<li>How dataset merges are performed</li>
<li>The types different union approaches a merge can take</li>
<li>The 'mergeData' function, and how to use it in the future</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Guided-Walkthrough">Guided Walkthrough<a class="anchor-link" href="#Guided-Walkthrough"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SETUP">SETUP<a class="anchor-link" href="#SETUP"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Install these libraries onto the virtual environment.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install geopandas
<span class="o">!</span>pip install dataplay
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting geopandas
  Downloading https://files.pythonhosted.org/packages/f8/dd/c0a6429cc7692efd5c99420c9df525c40f472b50705871a770449027e244/geopandas-0.8.0-py2.py3-none-any.whl (962kB)
     |████████████████████████████████| 962kB 2.8MB/s 
Collecting pyproj&gt;=2.2.0
  Downloading https://files.pythonhosted.org/packages/e5/c3/071e080230ac4b6c64f1a2e2f9161c9737a2bc7b683d2c90b024825000c0/pyproj-2.6.1.post1-cp36-cp36m-manylinux2010_x86_64.whl (10.9MB)
     |████████████████████████████████| 10.9MB 18.4MB/s 
Requirement already satisfied: pandas&gt;=0.23.0 in /usr/local/lib/python3.6/dist-packages (from geopandas) (1.0.5)
Requirement already satisfied: shapely in /usr/local/lib/python3.6/dist-packages (from geopandas) (1.7.0)
Collecting fiona
  Downloading https://files.pythonhosted.org/packages/ec/20/4e63bc5c6e62df889297b382c3ccd4a7a488b00946aaaf81a118158c6f09/Fiona-1.8.13.post1-cp36-cp36m-manylinux1_x86_64.whl (14.7MB)
     |████████████████████████████████| 14.7MB 251kB/s 
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas&gt;=0.23.0-&gt;geopandas) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.6.1 in /usr/local/lib/python3.6/dist-packages (from pandas&gt;=0.23.0-&gt;geopandas) (2.8.1)
Requirement already satisfied: numpy&gt;=1.13.3 in /usr/local/lib/python3.6/dist-packages (from pandas&gt;=0.23.0-&gt;geopandas) (1.18.5)
Requirement already satisfied: attrs&gt;=17 in /usr/local/lib/python3.6/dist-packages (from fiona-&gt;geopandas) (19.3.0)
Requirement already satisfied: six&gt;=1.7 in /usr/local/lib/python3.6/dist-packages (from fiona-&gt;geopandas) (1.12.0)
Collecting munch
  Downloading https://files.pythonhosted.org/packages/cc/ab/85d8da5c9a45e072301beb37ad7f833cd344e04c817d97e0cc75681d248f/munch-2.5.0-py2.py3-none-any.whl
Requirement already satisfied: click&lt;8,&gt;=4.0 in /usr/local/lib/python3.6/dist-packages (from fiona-&gt;geopandas) (7.1.2)
Collecting click-plugins&gt;=1.0
  Downloading https://files.pythonhosted.org/packages/e9/da/824b92d9942f4e472702488857914bdd50f73021efea15b4cad9aca8ecef/click_plugins-1.1.1-py2.py3-none-any.whl
Collecting cligj&gt;=0.5
  Downloading https://files.pythonhosted.org/packages/e4/be/30a58b4b0733850280d01f8bd132591b4668ed5c7046761098d665ac2174/cligj-0.5.0-py3-none-any.whl
Installing collected packages: pyproj, munch, click-plugins, cligj, fiona, geopandas
Successfully installed click-plugins-1.1.1 cligj-0.5.0 fiona-1.8.13.post1 geopandas-0.8.0 munch-2.5.0 pyproj-2.6.1.post1
Collecting dataplay
  Downloading https://files.pythonhosted.org/packages/36/a1/ca1b0db9be0194aa3cef96087e73e0bbc5348edb7c31f1aaccc42f3e66e2/dataplay-0.0.5-py3-none-any.whl
Installing collected packages: dataplay
Successfully installed dataplay-0.0.5
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># @title Run: Install Modules</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="(Optional)-Local-File-Access">(Optional) Local File Access<a class="anchor-link" href="#(Optional)-Local-File-Access"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Nothing we havent already seen.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Retrieve-Datasets">Retrieve Datasets<a class="anchor-link" href="#Retrieve-Datasets"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our example will merge two simple datasets; pulling CSA names using tract ID's.</p>
<p>The <strong>First</strong> dataset will be obtained from the Census' ACS 5-year serveys.</p>
<p>Functions used to obtain this data were obtained from Tutorial 0) ACS: Explore and Download.</p>
<p>The <strong>Second</strong> dataset will be obtained using using a CSV from a publicly accessible link</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Principal-dataset.">Get the Principal dataset.<a class="anchor-link" href="#Get-the-Principal-dataset."> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use the function we created in our last tutorial to download the data!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Our download function will use Baltimore City&#39;s tract, county and state as internal paramters</span>
<span class="c1"># Change these values in the cell below using different geographic reference codes will change those parameters</span>
<span class="n">tract</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;510&#39;</span>
<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span>

<span class="c1"># Specify the download parameters the function will receieve here</span>
<span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B19001&#39;</span>
<span class="n">year</span> <span class="o">=</span> <span class="s1">&#39;17&#39;</span>
<span class="n">saveAcs</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of Columns 17
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10_000</th>
      <th>B19001_003E_Total_$10_000_to_$14_999</th>
      <th>B19001_004E_Total_$15_000_to_$19_999</th>
      <th>B19001_005E_Total_$20_000_to_$24_999</th>
      <th>B19001_006E_Total_$25_000_to_$29_999</th>
      <th>B19001_007E_Total_$30_000_to_$34_999</th>
      <th>B19001_008E_Total_$35_000_to_$39_999</th>
      <th>B19001_009E_Total_$40_000_to_$44_999</th>
      <th>B19001_010E_Total_$45_000_to_$49_999</th>
      <th>B19001_011E_Total_$50_000_to_$59_999</th>
      <th>B19001_012E_Total_$60_000_to_$74_999</th>
      <th>B19001_013E_Total_$75_000_to_$99_999</th>
      <th>B19001_014E_Total_$100_000_to_$124_999</th>
      <th>B19001_015E_Total_$125_000_to_$149_999</th>
      <th>B19001_016E_Total_$150_000_to_$199_999</th>
      <th>B19001_017E_Total_$200_000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>tract</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Census Tract 1901</th>
      <td>796</td>
      <td>237</td>
      <td>76</td>
      <td>85</td>
      <td>38</td>
      <td>79</td>
      <td>43</td>
      <td>36</td>
      <td>35</td>
      <td>15</td>
      <td>43</td>
      <td>45</td>
      <td>39</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>14</td>
      <td>24</td>
      <td>510</td>
      <td>190100</td>
    </tr>
    <tr>
      <th>Census Tract 1902</th>
      <td>695</td>
      <td>63</td>
      <td>87</td>
      <td>93</td>
      <td>6</td>
      <td>58</td>
      <td>30</td>
      <td>14</td>
      <td>29</td>
      <td>23</td>
      <td>38</td>
      <td>113</td>
      <td>70</td>
      <td>6</td>
      <td>32</td>
      <td>11</td>
      <td>22</td>
      <td>24</td>
      <td>510</td>
      <td>190200</td>
    </tr>
    <tr>
      <th>Census Tract 2201</th>
      <td>2208</td>
      <td>137</td>
      <td>229</td>
      <td>124</td>
      <td>52</td>
      <td>78</td>
      <td>87</td>
      <td>50</td>
      <td>80</td>
      <td>13</td>
      <td>217</td>
      <td>66</td>
      <td>159</td>
      <td>205</td>
      <td>167</td>
      <td>146</td>
      <td>398</td>
      <td>24</td>
      <td>510</td>
      <td>220100</td>
    </tr>
    <tr>
      <th>Census Tract 2303</th>
      <td>632</td>
      <td>3</td>
      <td>20</td>
      <td>0</td>
      <td>39</td>
      <td>7</td>
      <td>0</td>
      <td>29</td>
      <td>8</td>
      <td>9</td>
      <td>44</td>
      <td>29</td>
      <td>98</td>
      <td>111</td>
      <td>63</td>
      <td>94</td>
      <td>78</td>
      <td>24</td>
      <td>510</td>
      <td>230300</td>
    </tr>
    <tr>
      <th>Census Tract 2502.07</th>
      <td>836</td>
      <td>102</td>
      <td>28</td>
      <td>101</td>
      <td>64</td>
      <td>104</td>
      <td>76</td>
      <td>41</td>
      <td>40</td>
      <td>47</td>
      <td>72</td>
      <td>28</td>
      <td>60</td>
      <td>19</td>
      <td>27</td>
      <td>15</td>
      <td>12</td>
      <td>24</td>
      <td>510</td>
      <td>250207</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Secondary-Dataset">Get the Secondary Dataset<a class="anchor-link" href="#Get-the-Secondary-Dataset"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Spatial data can be attained by using the 2010 Census Tract Shapefile Picking <a href="https://www.census.gov/cgi-bin/geo/shapefiles/index.php?year=2010&amp;layergroup=Census+Tracts">Tool</a> or search their website for
Tiger/<a href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2010.html">Line</a> Shapefiles</p>
<blockquote><p>The core TIGER/Line Files and Shapefiles do not include demographic data, but they do contain geographic entity codes (GEOIDs) that can be linked to the Census Bureau’s demographic data, available on data.census.gov.-census.gov</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Boundaries Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Boundaries Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get the Second dataset. </span>
<span class="c1"># Our Example dataset contains Polygon Geometry information. </span>
<span class="c1"># We want to merge this over to our principle dataset. </span>
<span class="c1"># we will grab it by matching on either CSA or Tract</span>

<span class="c1"># The url listed below is public.</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tract 2 CSA Crosswalk : https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span><span class="p">)</span>

<span class="n">inFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Please enter the location of your file : </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>

<span class="n">crosswalk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="n">inFile</span> <span class="p">)</span>
<span class="n">crosswalk</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tract 2 CSA Crosswalk : https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv

 Please enter the location of your file : 
https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRACT2010</th>
      <th>GEOID2010</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10100</td>
      <td>24510010100</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10200</td>
      <td>24510010200</td>
      <td>Patterson Park N...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10300</td>
      <td>24510010300</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10400</td>
      <td>24510010400</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10500</td>
      <td>24510010500</td>
      <td>Fells Point</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Perform-Merge-&amp;-Save">Perform Merge &amp; Save<a class="anchor-link" href="#Perform-Merge-&amp;-Save"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following picture does nothing important but serves as a friendly reminder of the 4 basic join types.</p>
<image src="https://docs.trifacta.com/download/attachments/123830435/JoinVennDiagram.png" height='200px'/>

<ul>
<li>Left - returns all left records, only includes the right record if it has a match</li>
<li>Right - Returns all right records, only includes the left record if it has a match </li>
<li>Full - Returns all records regardless of keys matching</li>
<li>Inner - Returns only records where a key match</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get Columns from both datasets to match on</p>
<p>You can get these values from the column values above.</p>
<p>Our Examples will work with the prompted values</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Princpal Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on principal column: (&#39;tract&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">);</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Crosswalk Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on crosswalk column: (&#39;TRACT2010&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Princpal Columns Index([&#39;B19001_001E_Total&#39;, &#39;B19001_002E_Total_Less_than_$10_000&#39;,
       &#39;B19001_003E_Total_$10_000_to_$14_999&#39;,
       &#39;B19001_004E_Total_$15_000_to_$19_999&#39;,
       &#39;B19001_005E_Total_$20_000_to_$24_999&#39;,
       &#39;B19001_006E_Total_$25_000_to_$29_999&#39;,
       &#39;B19001_007E_Total_$30_000_to_$34_999&#39;,
       &#39;B19001_008E_Total_$35_000_to_$39_999&#39;,
       &#39;B19001_009E_Total_$40_000_to_$44_999&#39;,
       &#39;B19001_010E_Total_$45_000_to_$49_999&#39;,
       &#39;B19001_011E_Total_$50_000_to_$59_999&#39;,
       &#39;B19001_012E_Total_$60_000_to_$74_999&#39;,
       &#39;B19001_013E_Total_$75_000_to_$99_999&#39;,
       &#39;B19001_014E_Total_$100_000_to_$124_999&#39;,
       &#39;B19001_015E_Total_$125_000_to_$149_999&#39;,
       &#39;B19001_016E_Total_$150_000_to_$199_999&#39;,
       &#39;B19001_017E_Total_$200_000_or_more&#39;, &#39;state&#39;, &#39;county&#39;, &#39;tract&#39;],
      dtype=&#39;object&#39;)
Left on principal column: (&#39;tract&#39;) 
tract
 
 
Crosswalk Columns Index([&#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)
Right on crosswalk column: (&#39;TRACT2010&#39;) 
TRACT2010
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Specify how the merge will be performed</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will perform a left merge in this example.</p>
<p>It will return our Principal dataset with columns from the second dataset appended to records where their specified columns match.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (‘left’, ‘right’, ‘outer’, ‘inner’) &quot;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>How: (‘left’, ‘right’, ‘outer’, ‘inner’) left
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Actually perfrom the merge</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crosswalk</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10_000</th>
      <th>B19001_003E_Total_$10_000_to_$14_999</th>
      <th>B19001_004E_Total_$15_000_to_$19_999</th>
      <th>B19001_005E_Total_$20_000_to_$24_999</th>
      <th>B19001_006E_Total_$25_000_to_$29_999</th>
      <th>B19001_007E_Total_$30_000_to_$34_999</th>
      <th>B19001_008E_Total_$35_000_to_$39_999</th>
      <th>B19001_009E_Total_$40_000_to_$44_999</th>
      <th>B19001_010E_Total_$45_000_to_$49_999</th>
      <th>B19001_011E_Total_$50_000_to_$59_999</th>
      <th>B19001_012E_Total_$60_000_to_$74_999</th>
      <th>B19001_013E_Total_$75_000_to_$99_999</th>
      <th>B19001_014E_Total_$100_000_to_$124_999</th>
      <th>B19001_015E_Total_$125_000_to_$149_999</th>
      <th>B19001_016E_Total_$150_000_to_$199_999</th>
      <th>B19001_017E_Total_$200_000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>TRACT2010</th>
      <th>GEOID2010</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>796</td>
      <td>237</td>
      <td>76</td>
      <td>85</td>
      <td>38</td>
      <td>79</td>
      <td>43</td>
      <td>36</td>
      <td>35</td>
      <td>15</td>
      <td>43</td>
      <td>45</td>
      <td>39</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>14</td>
      <td>24</td>
      <td>510</td>
      <td>190100</td>
      <td>24510190100</td>
      <td>Southwest Baltimore</td>
    </tr>
    <tr>
      <th>1</th>
      <td>695</td>
      <td>63</td>
      <td>87</td>
      <td>93</td>
      <td>6</td>
      <td>58</td>
      <td>30</td>
      <td>14</td>
      <td>29</td>
      <td>23</td>
      <td>38</td>
      <td>113</td>
      <td>70</td>
      <td>6</td>
      <td>32</td>
      <td>11</td>
      <td>22</td>
      <td>24</td>
      <td>510</td>
      <td>190200</td>
      <td>24510190200</td>
      <td>Southwest Baltimore</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2208</td>
      <td>137</td>
      <td>229</td>
      <td>124</td>
      <td>52</td>
      <td>78</td>
      <td>87</td>
      <td>50</td>
      <td>80</td>
      <td>13</td>
      <td>217</td>
      <td>66</td>
      <td>159</td>
      <td>205</td>
      <td>167</td>
      <td>146</td>
      <td>398</td>
      <td>24</td>
      <td>510</td>
      <td>220100</td>
      <td>24510220100</td>
      <td>Inner Harbor/Fed...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>632</td>
      <td>3</td>
      <td>20</td>
      <td>0</td>
      <td>39</td>
      <td>7</td>
      <td>0</td>
      <td>29</td>
      <td>8</td>
      <td>9</td>
      <td>44</td>
      <td>29</td>
      <td>98</td>
      <td>111</td>
      <td>63</td>
      <td>94</td>
      <td>78</td>
      <td>24</td>
      <td>510</td>
      <td>230300</td>
      <td>24510230300</td>
      <td>South Baltimore</td>
    </tr>
    <tr>
      <th>4</th>
      <td>836</td>
      <td>102</td>
      <td>28</td>
      <td>101</td>
      <td>64</td>
      <td>104</td>
      <td>76</td>
      <td>41</td>
      <td>40</td>
      <td>47</td>
      <td>72</td>
      <td>28</td>
      <td>60</td>
      <td>19</td>
      <td>27</td>
      <td>15</td>
      <td>12</td>
      <td>24</td>
      <td>510</td>
      <td>250207</td>
      <td>24510250207</td>
      <td>Cherry Hill</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, our Census data will now have a CSA appended to it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save Data to User Specified File</span>
<span class="n">outFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the new Filename to save the data to (&#39;acs_csa_merge_test&#39;: &quot;</span> <span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outFile</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Please enter the new Filename to save the data to (&#39;acs_csa_merge_test&#39;: test123
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Final-Result">Final Result<a class="anchor-link" href="#Final-Result"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flag</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter a URL? If not ACS data will be used. (Y/N):  &quot;</span> <span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">flag</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your Principal file: &quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">tract</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter tract id (*): &quot;</span> <span class="p">)</span>
  <span class="n">county</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter county id (510): &quot;</span> <span class="p">)</span>
  <span class="n">state</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter state id (24): &quot;</span> <span class="p">)</span>
  <span class="n">tableId</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter acs table id (B19001): &quot;</span> <span class="p">)</span> 
  <span class="n">year</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter acs year (18): &quot;</span> <span class="p">)</span>
  <span class="n">saveAcs</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Save ACS? (Y/N): &quot;</span> <span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Principal Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Crosswalk Example: https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span><span class="p">)</span>

<span class="n">crosswalk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your crosswalk file: &quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Crosswalk Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on: &quot;</span> <span class="p">)</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on: &quot;</span> <span class="p">)</span>
<span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (‘left’, ‘right’, ‘outer’, ‘inner’) &quot;</span> <span class="p">)</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crosswalk</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Save the data</span>
<span class="c1"># Save the data</span>
<span class="n">saveFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Save File (&#39;Y&#39; or &#39;N&#39;): &quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span> <span class="ow">or</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
  <span class="n">outFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Saved Filename (Do not include the file extension ): &quot;</span><span class="p">)</span>
  <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outFile</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(               Bank Name          Address(es)  Census Tract  GEOID2010  TRACTCE10      GEOID10   NAME10  CSA  Tract             geometry
 0    Arundel Federal ...  333 E. Patapsco ...      250401.0   2.45e+10     250401  24510250401  2504.01  NaN   2504  POLYGON ((-76.59...
 1                    NaN    3601 S Hanover St      250401.0   2.45e+10     250401  24510250401  2504.01  NaN   2504  POLYGON ((-76.59...
 2    Bank of America,...       20 N Howard St       40100.0   2.45e+10      40100  24510040100   401.00  NaN    401  POLYGON ((-76.61...
 3                    NaN  100 S Charles St...       40100.0   2.45e+10      40100  24510040100   401.00  NaN    401  POLYGON ((-76.61...
 4    Branch Banking a...       2 N CHARLES ST       40100.0   2.45e+10      40100  24510040100   401.00  NaN    401  POLYGON ((-76.61...
 ..                   ...                  ...           ...        ...        ...          ...      ...  ...    ...                  ...
 233                  NaN                  NaN           NaN        NaN     260403  24510260403  2604.03  NaN   2604  POLYGON ((-76.52...
 234                  NaN                  NaN           NaN        NaN      80800  24510080800   808.00  NaN    808  POLYGON ((-76.58...
 235                  NaN                  NaN           NaN        NaN     160500  24510160500  1605.00  NaN   1605  POLYGON ((-76.65...
 236                  NaN                  NaN           NaN        NaN      90100  24510090100   901.00  NaN    901  POLYGON ((-76.60...
 237                  NaN                  NaN           NaN        NaN     260402  24510260402  2604.02  NaN   2604  POLYGON ((-76.54...
 
 [238 rows x 10 columns],
      TRACTCE10      GEOID10   NAME10                  CSA  Tract             geometry
 0       151000  24510151000  1510.00  Dorchester/Ashbu...   1510  POLYGON ((-76.67...
 1        80700  24510080700   807.00      Greenmount East    807  POLYGON ((-76.58...
 2        80500  24510080500   805.00        Clifton-Berea    805  POLYGON ((-76.58...
 3       150500  24510150500  1505.00    Greater Mondawmin   1505  POLYGON ((-76.65...
 4       120100  24510120100  1201.00  North Baltimore/...   1201  POLYGON ((-76.60...
 ..         ...          ...      ...                  ...    ...                  ...
 195      80800  24510080800   808.00  Oldtown/Middle East    808  POLYGON ((-76.58...
 196     160500  24510160500  1605.00     Greater Rosemont   1605  POLYGON ((-76.65...
 197      90100  24510090100   901.00       Greater Govans    901  POLYGON ((-76.60...
 198     260402  24510260402  2604.02  Claremont/Armistead   2604  POLYGON ((-76.54...
 199     260700  24510260700  2607.00  Orangeville/East...   2607  POLYGON ((-76.55...
 
 [200 rows x 6 columns])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Advanced">Advanced<a class="anchor-link" href="#Advanced"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Intro</strong></p>
<p>The following Python function is a bulked out version of the previous notes.</p>
<ul>
<li>It contains everything from the tutorial plus more.</li>
<li>It can be imported and used in future projects or stand alone.</li>
</ul>
<p><strong>Description:</strong> add columns of data from a foreign dataset into a primary dataset along set parameters.</p>
<p><strong>Purpose:</strong> Makes Merging datasets simple</p>
<p><strong>Services</strong></p>
<ul>
<li>Merge two datasets without a crosswalk</li>
<li>Merge two datasets with a crosswalk</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(               Bank Name          Address(es)  Census Tract  GEOID2010  TRACTCE10      GEOID10   NAME10  CSA  Tract             geometry
 0    Arundel Federal ...  333 E. Patapsco ...      250401.0   2.45e+10     250401  24510250401  2504.01  NaN   2504  POLYGON ((-76.59...
 1                    NaN    3601 S Hanover St      250401.0   2.45e+10     250401  24510250401  2504.01  NaN   2504  POLYGON ((-76.59...
 2    Bank of America,...       20 N Howard St       40100.0   2.45e+10      40100  24510040100   401.00  NaN    401  POLYGON ((-76.61...
 3                    NaN  100 S Charles St...       40100.0   2.45e+10      40100  24510040100   401.00  NaN    401  POLYGON ((-76.61...
 4    Branch Banking a...       2 N CHARLES ST       40100.0   2.45e+10      40100  24510040100   401.00  NaN    401  POLYGON ((-76.61...
 ..                   ...                  ...           ...        ...        ...          ...      ...  ...    ...                  ...
 233                  NaN                  NaN           NaN        NaN     260403  24510260403  2604.03  NaN   2604  POLYGON ((-76.52...
 234                  NaN                  NaN           NaN        NaN      80800  24510080800   808.00  NaN    808  POLYGON ((-76.58...
 235                  NaN                  NaN           NaN        NaN     160500  24510160500  1605.00  NaN   1605  POLYGON ((-76.65...
 236                  NaN                  NaN           NaN        NaN      90100  24510090100   901.00  NaN    901  POLYGON ((-76.60...
 237                  NaN                  NaN           NaN        NaN     260402  24510260402  2604.02  NaN   2604  POLYGON ((-76.54...
 
 [238 rows x 10 columns],
      TRACTCE10      GEOID10   NAME10                  CSA  Tract             geometry
 0       151000  24510151000  1510.00  Dorchester/Ashbu...   1510  POLYGON ((-76.67...
 1        80700  24510080700   807.00      Greenmount East    807  POLYGON ((-76.58...
 2        80500  24510080500   805.00        Clifton-Berea    805  POLYGON ((-76.58...
 3       150500  24510150500  1505.00    Greater Mondawmin   1505  POLYGON ((-76.65...
 4       120100  24510120100  1201.00  North Baltimore/...   1201  POLYGON ((-76.60...
 ..         ...          ...      ...                  ...    ...                  ...
 195      80800  24510080800   808.00  Oldtown/Middle East    808  POLYGON ((-76.58...
 196     160500  24510160500  1605.00     Greater Rosemont   1605  POLYGON ((-76.65...
 197      90100  24510090100   901.00       Greater Govans    901  POLYGON ((-76.60...
 198     260402  24510260402  2604.02  Claremont/Armistead   2604  POLYGON ((-76.54...
 199     260700  24510260700  2607.00  Orangeville/East...   2607  POLYGON ((-76.55...
 
 [200 rows x 6 columns])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mergeDatasets" class="doc_header"><code>mergeDatasets</code><a href="https://github.com/karpatic/dataplay/tree/master/dataplay/merge.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mergeDatasets</code>(<strong><code>left_ds</code></strong>=<em><code>False</code></em>, <strong><code>right_ds</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_ds</code></strong>=<em><code>False</code></em>, <strong><code>use_crosswalk</code></strong>=<em><code>True</code></em>, <strong><code>left_col</code></strong>=<em><code>False</code></em>, <strong><code>right_col</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_left_col</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_right_col</code></strong>=<em><code>False</code></em>, <strong><code>merge_how</code></strong>=<em><code>False</code></em>, <strong><code>interactive</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Function-Explanation">Function Explanation<a class="anchor-link" href="#Function-Explanation"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Input(s):</strong></p>
<ul>
<li>Dataset url</li>
<li>Crosswalk Url </li>
<li>Right On </li>
<li>Left On </li>
<li>How </li>
<li>New Filename </li>
</ul>
<p><strong>Output:</strong> File</p>
<p><strong>How it works:</strong></p>
<ul>
<li>Read in datasets</li>
<li><p>Perform Merge</p>
</li>
<li><p>If the 'how' parameter is equal to ['left', 'right', 'outer', 'inner']</p>
</li>
<li><ul>
<li>then a merge will be performed. </li>
</ul>
</li>
<li>If a column name is provided in the 'how' parameter</li>
<li><ul>
<li>then that single column will be pulled from the right dataset as a new column in the left_ds.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Diagrams">Function Diagrams<a class="anchor-link" href="#Function-Diagrams"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Diagram the mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://charleskarpati.com/images/class_diagram_merge_datasets.png&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://charleskarpati.com/images/class_diagram_merge_datasets.png">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>mergeDatasets Flow Chart</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://charleskarpati.com/images/flow_chart_merge_datasets.png&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://charleskarpati.com/images/flow_chart_merge_datasets.png">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gannt Chart  mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://charleskarpati.com/images/gannt_chart_merge_datasets.png&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://charleskarpati.com/images/gannt_chart_merge_datasets.png">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sequence Diagram  mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://charleskarpati.com/images/sequence_diagram_merge_datasets.png&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://charleskarpati.com/images/sequence_diagram_merge_datasets.png">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Examples">Function Examples<a class="anchor-link" href="#Function-Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Example-1">Interactive Example 1<a class="anchor-link" href="#Interactive-Example-1"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Table: FDIC Baltimore Banks</span>
<span class="c1"># Columns: Bank Name, Address(es), Census Tract</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vTViIZu-hbvhM3L7dIRAG95ISa7TNhUwdzlYxYzc1ygJoaYc3_scaXHe8Rtj5iwNA/pub?gid=1078028768&amp;single=true&amp;output=csv&#39;</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;Census Tract&#39;</span>

<span class="c1"># Table: Crosswalk Census Communities</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span>
<span class="n">right_col</span><span class="o">=</span><span class="s1">&#39;TRACT2010&#39;</span>

<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">use_crosswalk</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> 
              <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> 
              <span class="n">merge_how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_crosswalk</span><span class="o">=</span><span class="n">use_crosswalk</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 Handling Left Dataset
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vTViIZu-hbvhM3L7dIRAG95ISa7TNhUwdzlYxYzc1ygJoaYc3_scaXHe8Rtj5iwNA/pub?gid=1078028768&amp;single=true&amp;output=csv
checkDataSetExists False
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vTViIZu-hbvhM3L7dIRAG95ISa7TNhUwdzlYxYzc1ygJoaYc3_scaXHe8Rtj5iwNA/pub?gid=1078028768&amp;single=true&amp;output=csv
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True
Left Dataset and Columns are Valid

 Handling Right Dataset
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
checkDataSetExists False
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True
Right Dataset and Columns are Valid

 Checking the merge_how Parameter
merge_how operator is Valid left
checkDataSetExists False

 Ensuring Left-&gt;Right compatability
Converting Local Key from float64 to Int
PERFORMING MERGE LEFT-&gt;RIGHT
left_col Census Tract right_col TRACT2010 how left

 Local Column Values Not Matched 
[-1321321321321325            400100            401101            401102
            401507            403401            403500            403803
            411306            411406            411408            420100
            420301            420701            420800            430800
            430900            440100            440200            440702
            441101            450300            452000            490601
            490602            491100            491201            491600
            492300            750101]
43

 Crosswalk Unique Column Values
[ 10100  10200  10300  10400  10500  20100  20200  20300  30100  30200
  40100  40200  60100  60200  60300  60400  70100  70200  70300  70400
  80101  80102  80200  80301  80302  80400  80500  80600  80700  80800
  90100  90200  90300  90400  90500  90600  90700  90800  90900 100100
 100200 100300 110100 110200 120100 120201 120202 120300 120400 120500
 120600 120700 130100 130200 130300 130400 130600 130700 130803 130804
 130805 130806 140100 140200 140300 150100 150200 150300 150400 150500
 150600 150701 150702 150800 150900 151000 151100 151200 151300 160100
 160200 160300 160400 160500 160600 160700 160801 160802 170100 170200
 170300 180100 180200 180300 190100 190200 190300 200100 200200 200300
 200400 200500 200600 200701 200702 200800 210100 210200 220100 230100
 230200 230300 240100 240200 240300 240400 250101 250102 250103 250203
 250204 250205 250206 250207 250301 250303 250401 250402 250500 250600
 260101 260102 260201 260202 260203 260301 260302 260303 260401 260402
 260403 260404 260501 260604 260605 260700 260800 260900 261000 261100
 270101 270102 270200 270301 270302 270401 270402 270501 270502 270600
 270701 270702 270703 270801 270802 270803 270804 270805 270901 270902
 270903 271001 271002 271101 271102 271200 271300 271400 271501 271503
 271600 271700 271801 271802 271900 272003 272004 272005 272006 272007
 280101 280102 280200 280301 280302 280401 280402 280403 280404 280500
  10000]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bank Name</th>
      <th>Address(es)</th>
      <th>Census Tract</th>
      <th>TRACT2010</th>
      <th>GEOID2010</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arundel Federal ...</td>
      <td>333 E. Patapsco ...</td>
      <td>250401</td>
      <td>250401.0</td>
      <td>2.45e+10</td>
      <td>Brooklyn/Curtis ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bank of America,...</td>
      <td>20 N Howard St</td>
      <td>40100</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>Downtown/Seton Hill</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>100 S Charles St...</td>
      <td>40100</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>Downtown/Seton Hill</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>1046 Light St</td>
      <td>230200</td>
      <td>230200.0</td>
      <td>2.45e+10</td>
      <td>Inner Harbor/Fed...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>1800 E Monument St</td>
      <td>70400</td>
      <td>70400.0</td>
      <td>2.45e+10</td>
      <td>Oldtown/Middle East</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-1.25-)-Do-it-again-but-to-a-boundary-using-the-previous-dataframe">Example 1.25 ) Do it again but to a boundary using the previous dataframe<a class="anchor-link" href="#Example-1.25-)-Do-it-again-but-to-a-boundary-using-the-previous-dataframe"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID2010&#39;</span>

<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv&#39;</span>
<span class="n">right_col</span> <span class="o">=</span><span class="s1">&#39;GEOID10&#39;</span>


<span class="n">merged_df_geom</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">merged_df</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> 
              <span class="n">use_crosswalk</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="n">crosswalk_right_col</span><span class="p">,</span>
              <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> 
              <span class="n">merge_how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 Handling Left Dataset
retrieveDatasetFromUrl                Bank Name          Address(es)  Census Tract  TRACT2010  GEOID2010              CSA2010
0    Arundel Federal ...  333 E. Patapsco ...        250401   250401.0   2.45e+10  Brooklyn/Curtis ...
1    Bank of America,...       20 N Howard St         40100    40100.0   2.45e+10  Downtown/Seton Hill
3                    NaN  100 S Charles St...         40100    40100.0   2.45e+10  Downtown/Seton Hill
4                    NaN        1046 Light St        230200   230200.0   2.45e+10  Inner Harbor/Fed...
5                    NaN   1800 E Monument St         70400    70400.0   2.45e+10  Oldtown/Middle East
..                   ...                  ...           ...        ...        ...                  ...
126                  NaN      5121 ROLAND AVE        271300   271300.0   2.45e+10  Greater Roland P...
128                  NaN  1726 E NORTHERN ...        270803   270803.0   2.45e+10           Loch Raven
129                  NaN  4735 LIBERTY HEI...        280200   280200.0   2.45e+10  Howard Park/West...
132                  NaN  5701 REISTERSTOW...        271900   271900.0   2.45e+10       Glen-Fallstaff
133  Wilmington Trust...       1 Light Street         40100    40100.0   2.45e+10  Downtown/Seton Hill

[91 rows x 6 columns]
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True
Left Dataset and Columns are Valid

 Handling Right Dataset
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv
checkDataSetExists False
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True
Right Dataset and Columns are Valid

 Checking the merge_how Parameter
merge_how operator is Valid outer
checkDataSetExists False

 Ensuring Left-&gt;Right compatability
Converting Local Key from float64 to Int
PERFORMING MERGE LEFT-&gt;RIGHT
left_col GEOID2010 right_col GEOID10 how outer
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/pandas/core/ops/array_ops.py:253: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  res_values = method(rvalues)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df_geom</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bank Name</th>
      <th>Address(es)</th>
      <th>Census Tract</th>
      <th>TRACT2010</th>
      <th>GEOID2010</th>
      <th>CSA2010</th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>NAME10</th>
      <th>CSA</th>
      <th>Tract</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arundel Federal ...</td>
      <td>333 E. Patapsco ...</td>
      <td>250401.0</td>
      <td>250401.0</td>
      <td>2.45e+10</td>
      <td>Brooklyn/Curtis ...</td>
      <td>250401</td>
      <td>24510250401</td>
      <td>2504.01</td>
      <td>Brooklyn/Curtis ...</td>
      <td>2504</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3601 S Hanover St</td>
      <td>250401.0</td>
      <td>250401.0</td>
      <td>2.45e+10</td>
      <td>Brooklyn/Curtis ...</td>
      <td>250401</td>
      <td>24510250401</td>
      <td>2504.01</td>
      <td>Brooklyn/Curtis ...</td>
      <td>2504</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bank of America,...</td>
      <td>20 N Howard St</td>
      <td>40100.0</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>Downtown/Seton Hill</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>100 S Charles St...</td>
      <td>40100.0</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>Downtown/Seton Hill</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Branch Banking a...</td>
      <td>2 N CHARLES ST</td>
      <td>40100.0</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>Downtown/Seton Hill</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-1.5-)-Get-CSA-and-Geometry-with-a-Crosswalk-using-3-links">Example 1.5 ) Get CSA and Geometry with a Crosswalk using 3 links<a class="anchor-link" href="#Example-1.5-)-Get-CSA-and-Geometry-with-a-Crosswalk-using-3-links"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Primary Table</span>
<span class="c1"># Description: I created a public dataset from a google xlsx sheet &#39;Bank Addresses and Census Tract&#39; from a workbook of the same name.</span>
<span class="c1"># Table: FDIC Baltimore Banks</span>
<span class="c1"># Columns: Bank Name, Address(es), Census Tract</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vTViIZu-hbvhM3L7dIRAG95ISa7TNhUwdzlYxYzc1ygJoaYc3_scaXHe8Rtj5iwNA/pub?gid=1078028768&amp;single=true&amp;output=csv&#39;</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;Census Tract&#39;</span>

<span class="c1"># Alternate Primary Table</span>
<span class="c1"># Description: Same workbook, different Sheet: &#39;Branches per tract&#39; </span>
<span class="c1"># Columns: Census Tract, Number branches per tract</span>
<span class="c1"># left_ds = &#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vSHFrRSHva1f82ZQ7Uxwf3A1phqljj1oa2duGlZDM1vLtrm1GI5yHmpVX2ilTfMHQ/pub?gid=1698745725&amp;single=true&amp;output=csv&#39;</span>
<span class="c1"># lef_col = &#39;Number branches per tract&#39;</span>

<span class="c1"># Crosswalk Table</span>
<span class="c1"># Table: Crosswalk Census Communities</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">crosswalk_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span>
<span class="n">use_crosswalk</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="s1">&#39;TRACT2010&#39;</span>
<span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID2010&#39;</span>

<span class="c1"># Secondary Table</span>
<span class="c1"># Table: Baltimore Boundaries</span>
<span class="c1"># &#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA&#39;, &#39;NAME10&#39;, &#39;Tract&#39;, &#39;geometry&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv&#39;</span>
<span class="n">right_col</span> <span class="o">=</span><span class="s1">&#39;GEOID10&#39;</span>

<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;geometry&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>

<span class="n">merged_df_geom</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> 
              <span class="n">use_crosswalk</span><span class="o">=</span><span class="n">use_crosswalk</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="o">=</span><span class="n">crosswalk_ds</span><span class="p">,</span>
              <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="n">crosswalk_right_col</span><span class="p">,</span>
              <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> 
              <span class="n">merge_how</span><span class="o">=</span><span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="n">interactive</span> <span class="p">)</span>

<span class="n">merged_df_geom</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 Handling Left Dataset
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vTViIZu-hbvhM3L7dIRAG95ISa7TNhUwdzlYxYzc1ygJoaYc3_scaXHe8Rtj5iwNA/pub?gid=1078028768&amp;single=true&amp;output=csv
checkDataSetExists False
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vTViIZu-hbvhM3L7dIRAG95ISa7TNhUwdzlYxYzc1ygJoaYc3_scaXHe8Rtj5iwNA/pub?gid=1078028768&amp;single=true&amp;output=csv
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True
Left Dataset and Columns are Valid

 Handling Right Dataset
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv
checkDataSetExists False
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True
Right Dataset and Columns are Valid

 Checking the merge_how Parameter
merge_how operator is Valid outer
checkDataSetExists False

 Checking the Crosswalk Parameter

 Handling Crosswalk Left Dataset Loading
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
checkDataSetExists False
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True

 Handling Crosswalk Right Dataset Loading
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
checkDataSetExists False
retrieveDatasetFromUrl https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv
checkDataSetExists True
checkDataSetExists True
checkDataSetExists True

 Assessment Completed

 Ensuring Left-&gt;Crosswalk compatability
Converting Local Key from float64 to Int

 Ensuring Crosswalk-&gt;Right compatability
PERFORMING MERGE LEFT-&gt;CROSSWALK
left_on TRACT2010 right_on GEOID2010 how outer

 Local Column Values Not Matched 
[-1321321321321325            400100            401101            401102
            401507            403401            403500            403803
            411306            411406            411408            420100
            420301            420701            420800            430800
            430900            440100            440200            440702
            441101            450300            452000            490601
            490602            491100            491201            491600
            492300            750101]
43

 Crosswalk Unique Column Values
[ 10100  10200  10300  10400  10500  20100  20200  20300  30100  30200
  40100  40200  60100  60200  60300  60400  70100  70200  70300  70400
  80101  80102  80200  80301  80302  80400  80500  80600  80700  80800
  90100  90200  90300  90400  90500  90600  90700  90800  90900 100100
 100200 100300 110100 110200 120100 120201 120202 120300 120400 120500
 120600 120700 130100 130200 130300 130400 130600 130700 130803 130804
 130805 130806 140100 140200 140300 150100 150200 150300 150400 150500
 150600 150701 150702 150800 150900 151000 151100 151200 151300 160100
 160200 160300 160400 160500 160600 160700 160801 160802 170100 170200
 170300 180100 180200 180300 190100 190200 190300 200100 200200 200300
 200400 200500 200600 200701 200702 200800 210100 210200 220100 230100
 230200 230300 240100 240200 240300 240400 250101 250102 250103 250203
 250204 250205 250206 250207 250301 250303 250401 250402 250500 250600
 260101 260102 260201 260202 260203 260301 260302 260303 260401 260402
 260403 260404 260501 260604 260605 260700 260800 260900 261000 261100
 270101 270102 270200 270301 270302 270401 270402 270501 270502 270600
 270701 270702 270703 270801 270802 270803 270804 270805 270901 270902
 270903 271001 271002 271101 271102 271200 271300 271400 271501 271503
 271600 271700 271801 271802 271900 272003 272004 272005 272006 272007
 280101 280102 280200 280301 280302 280401 280402 280403 280404 280500
  10000]
PERFORMING MERGE LEFT-&gt;RIGHT
left_col GEOID2010 right_col GEOID10 how outer
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/pandas/core/ops/array_ops.py:253: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  res_values = method(rvalues)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bank Name</th>
      <th>Address(es)</th>
      <th>Census Tract</th>
      <th>GEOID2010</th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>NAME10</th>
      <th>CSA</th>
      <th>Tract</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arundel Federal ...</td>
      <td>333 E. Patapsco ...</td>
      <td>250401.0</td>
      <td>2.45e+10</td>
      <td>250401</td>
      <td>24510250401</td>
      <td>2504.01</td>
      <td>Brooklyn/Curtis ...</td>
      <td>2504</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3601 S Hanover St</td>
      <td>250401.0</td>
      <td>2.45e+10</td>
      <td>250401</td>
      <td>24510250401</td>
      <td>2504.01</td>
      <td>Brooklyn/Curtis ...</td>
      <td>2504</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bank of America,...</td>
      <td>20 N Howard St</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>100 S Charles St...</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Branch Banking a...</td>
      <td>2 N CHARLES ST</td>
      <td>40100.0</td>
      <td>2.45e+10</td>
      <td>40100</td>
      <td>24510040100</td>
      <td>401.00</td>
      <td>Downtown/Seton Hill</td>
      <td>401</td>
      <td>POLYGON ((-76.61...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we can save the data so that it may be used in later tutorials.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;test_save_data_with_geom_and_csa&#39;</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">string</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Download data by:</p>
<ul>
<li>Clicking the 'Files' tab in the left hand menu of this screen. Locate your file within the file explorer that appears directly under the 'Files' tab button once clicked. Right click the file in the file explorer and select the 'download' option from the dropdown.  </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the next tutorial you will learn how to load this data as a geospatial dataset so that it may be mapped and mapping functionalities may be applied to it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can upload this data into the next tutorial in one of two ways.</p>
<p>1)</p>
<ul>
<li>uploading the saved file to google Drive and connecting to your drive path</li>
</ul>
<p>OR.</p>
<p>2)</p>
<ul>
<li>'by first downloading the dataset as directed above, and then navigating to the next tutorial. Go to their page and:</li>
<li>Uploading data using an file 'upload' button accessible within the 'Files' tab in the left hand menu of this screen. The next tutorial will teach you how to load this data so that it may be mapped.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Example-2">Interactive Example 2<a class="anchor-link" href="#Interactive-Example-2"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># When the prompts come up input the values not included from Interactive Example 1 and you will get the same output.</span>
<span class="c1"># This is to demonstrate that not all parameters must be known prior to executing the function.</span>

<span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergedDataset</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">use_crosswalk</span><span class="o">=</span><span class="n">use_crosswalk</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> <span class="n">merge_how</span> <span class="o">=</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="n">interactive</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergedDataset</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Bank Name        object
Address(es)      object
Census Tract    float64
TRACTCE10       float64
GEOID10         float64
NAME10          float64
CSA              object
Tract           float64
geometry         object
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Run-Alone">Interactive Run Alone<a class="anchor-link" href="#Interactive-Run-Alone"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergeDatasets</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Preconfigured-Example-1">Preconfigured Example 1<a class="anchor-link" href="#Preconfigured-Example-1"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Census Crosswalk</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vREwwa_s8Ix39OYGnnS_wA8flOoEkU7reIV4o3ZhlwYhLXhpNEvnOia_uHUDBvnFptkLLHHlaQNvsQE/pub?output=csv&#39;</span>

<span class="c1"># Baltimore Boundaries</span>
<span class="c1"># &#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA&#39;, &#39;NAME10&#39;, &#39;Tract&#39;, &#39;geometry&#39;</span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vQ8xXdUaT17jkdK0MWTJpg3GOy6jMWeaXTlguXNjCSb8Vr_FanSZQRaTU-m811fQz4kyMFK5wcahMNY/pub?gid=886223646&amp;single=true&amp;output=csv&#39;</span>
<span class="c1"># The Left DS Cols will map to the first three Right DS Cols listed</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID2010&#39;</span>
<span class="n">right_col</span> <span class="o">=</span> <span class="s1">&#39;GEOID10&#39;</span>
<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span> <span class="n">merge_how</span> <span class="o">=</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span> <span class="o">=</span> <span class="n">interactive</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 


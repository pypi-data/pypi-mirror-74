<!doctype html>
<html lang="en">
  <!--

    File        : templates/kanji.html
    Maintainer  : Felix C. Stegerman <flx@obfusk.net>
    Date        : 2020-07-14

    Copyright   : Copyright (C) 2020  Felix C. Stegerman
    Version     : v0.1.1
    License     : AGPLv3+

  -->
  <head>
    {% include "_meta.html" %}
    <title>jiten - kanji</title>
    <style>
      .kanji { font-size: 8em; } /* TODO */
    </style>
  </head>
  <body>
    {% from "_search.html" import kanji with context %}
    {% include "_nav.html" %}
    <div class="container">
      {{ kanji(query) }}
      {% if query %}
        {% for e in results %}
          <br/>
          <div class="card">
            <div class="card-body">
              <div class="d-flex">
                <a class="kanji text-reset text-decoration-none mr-3"
                  href="/jmdict?query={{ e.char }}">{{ e.char }}</a>
                <ul class="list-group flex-grow-1">
                  <li class="list-group-item {{
                        "pb-1 px-2 pt-2" if e.on else "p-2"
                      }}" title="on reading">
                    {% if e.on %}
                      {% for r in e.on %}
                        {% set rc = r.replace("-", "").replace(".", "") %}
                        <a class="jap selbtn btn btn-warning py-1 mb-1"
                          href="/jmdict?query={{ rc }}&exact=yes">{{ r }}</a>
                      {% endfor %}
                    {% else %}
                      <span class="text-muted">no on readings</span>
                    {% endif %}
                  </li>
                  <li class="list-group-item {{
                        "pb-1 px-2 pt-2" if e.kun else "p-2"
                      }}" title="kun reading">
                    {% if e.kun %}
                      {% for r in e.kun %}
                        {% set rc = r.replace("-", "").replace(".", "") %}
                        <a class="jap selbtn btn btn-success py-1 mb-1"
                          href="/jmdict?query={{ rc }}&exact=yes">{{ r }}</a>
                      {% endfor %}
                    {% else %}
                      <span class="text-muted">no kun readings</span>
                    {% endif %}
                  </li>
                  <li class="list-group-item {{
                        "pb-1 px-2 pt-2" if e.nanori else "p-2"
                      }}" title="name reading">
                    {% if e.nanori %}
                      {% for r in e.nanori %}
                        {% set rc = r.replace("-", "").replace(".", "") %}
                        <a class="jap selbtn btn btn-info py-1 mb-1"
                          href="/jmdict?query={{ rc }}&exact=yes">{{ r }}</a>
                      {% endfor %}
                    {% else %}
                      <span class="text-muted">no name readings</span>
                    {% endif %}
                  </li>
                </ul>
              </div>
              <ul class="list-group my-1" title="meanings">
                {% for m in e.meaning %}
                  <li class="list-group-item p-2">{{ m }}</li>
                {% endfor %}
              </ul>
              {% set js = jmdict[e.char]|list %}
              {% if js %}
                <!-- TODO: filter kanji containing char?! -->
                <div title="jmdict">
                  {% for e, r in js %}
                    <a class="jap selbtn btn btn-warning mb-1"
                      title="{{ "; ".join(e.meanings()|sum(start=())) }}"
                      href="/jmdict?query={{ ("+#" + e.seq|string)|urlencode }}"
                      >{{ e.kanji[0].elem }}
                      【{{ e.reading[0].elem }}】</a>
                  {% endfor %}
                </div>
              {% endif %}
              <div class="p-1" title="miscellaneous">
                <span class="nowrap">
                  <a class="badge badge-primary"
                      href="/kanji?query={{ e.char }}">
                    {{ hex(ord(e.char)) }}
                  </a>
                </span>
                <span class="nowrap">
                  »
                  <span class="badge badge-warning">
                    {{ e.strokes }}
                  </span>
                  strokes
                </span>
                {% if e.level %}
                  <span class="nowrap">
                    » level
                    <span class="jap badge badge-info">
                      {{ e.level }}
                    </span>
                  </span>
                {% endif %}
                {% if e.freq %}
                  <span class="nowrap">
                    » freq#
                    <span class="badge badge-danger">
                      {{ e.freq }}
                    </span>
                  </span>
                {% endif %}
                {% if e.jlpt %}
                  <span class="nowrap">
                    » old jlpt
                    <span class="badge badge-primary">
                      {{ e.jlpt }}
                    </span>
                  </span>
                {% endif %}
                {% if e.skip %}
                  <span class="nowrap">
                    » skip
                    <span class="badge badge-warning">
                      {{ e.skip }}
                    </span>
                  </span>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>
    {% include "_footer.html" %}
  </body>
</html>

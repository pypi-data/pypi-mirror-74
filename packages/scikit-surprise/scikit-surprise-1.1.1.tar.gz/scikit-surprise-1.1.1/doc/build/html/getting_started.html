

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started &mdash; Surprise 1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using prediction algorithms" href="prediction_algorithms.html" />
    <link rel="prev" title="Welcome to Surprise’ documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Surprise
          

          
          </a>

          
            
            
              <div class="version">
                0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#automatic-cross-validation">Automatic cross-validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#train-test-split-and-the-fit-method">Train-test split and the fit() method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#train-on-a-whole-trainset-and-the-predict-method">Train on a whole trainset and the predict() method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#use-a-custom-dataset">Use a custom dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-cross-validation-iterators">Use cross-validation iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tune-algorithm-parameters-with-gridsearchcv">Tune algorithm parameters with GridSearchCV</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-usage">Command line usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prediction_algorithms.html">Using prediction algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_custom_algo.html">How to build your own prediction algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="notation_standards.html">Notation standards, References</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prediction_algorithms_package.html">prediction_algorithms package</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_selection.html">The model_selection package</a></li>
<li class="toctree-l1"><a class="reference internal" href="similarities.html">similarities module</a></li>
<li class="toctree-l1"><a class="reference internal" href="accuracy.html">accuracy module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">dataset module</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainset.html">Trainset class</a></li>
<li class="toctree-l1"><a class="reference internal" href="reader.html">Reader class</a></li>
<li class="toctree-l1"><a class="reference internal" href="dump.html">dump module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Surprise</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Getting Started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/getting_started.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started">
<span id="id1"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="automatic-cross-validation">
<span id="cross-validate-example"></span><h3>Automatic cross-validation<a class="headerlink" href="#automatic-cross-validation" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://nicolashug.github.io/Surprise/">Surprise</a> has a set of built-in
<a class="reference internal" href="prediction_algorithms.html#prediction-algorithms"><span class="std std-ref">algorithms</span></a> and <a class="reference internal" href="dataset.html#dataset"><span class="std std-ref">datasets</span></a> for you
to play with. In its simplest form, it only takes a few lines of code to
run a cross-validation procedure:</p>
<div class="literal-block-wrapper docutils container" id="basic-usage-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/basic_usage.py</span></code></span><a class="headerlink" href="#basic-usage-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">SVD</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>


<span class="c1"># Load the movielens-100k dataset (download it if needed),</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_builtin</span><span class="p">(</span><span class="s1">&#39;ml-100k&#39;</span><span class="p">)</span>

<span class="c1"># We&#39;ll use the famous SVD algorithm.</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">SVD</span><span class="p">()</span>

<span class="c1"># Run 5-fold cross-validation and print results</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">measures</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;MAE&#39;</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The result should be as follows (actual values may vary due to randomization):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Evaluating</span> <span class="n">RMSE</span><span class="p">,</span> <span class="n">MAE</span> <span class="n">of</span> <span class="n">algorithm</span> <span class="n">SVD</span> <span class="n">on</span> <span class="mi">5</span> <span class="n">split</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span>

            <span class="n">Fold</span> <span class="mi">1</span>  <span class="n">Fold</span> <span class="mi">2</span>  <span class="n">Fold</span> <span class="mi">3</span>  <span class="n">Fold</span> <span class="mi">4</span>  <span class="n">Fold</span> <span class="mi">5</span>  <span class="n">Mean</span>    <span class="n">Std</span>
<span class="n">RMSE</span>        <span class="mf">0.9311</span>  <span class="mf">0.9370</span>  <span class="mf">0.9320</span>  <span class="mf">0.9317</span>  <span class="mf">0.9391</span>  <span class="mf">0.9342</span>  <span class="mf">0.0032</span>
<span class="n">MAE</span>         <span class="mf">0.7350</span>  <span class="mf">0.7375</span>  <span class="mf">0.7341</span>  <span class="mf">0.7342</span>  <span class="mf">0.7375</span>  <span class="mf">0.7357</span>  <span class="mf">0.0015</span>
<span class="n">Fit</span> <span class="n">time</span>    <span class="mf">6.53</span>    <span class="mf">7.11</span>    <span class="mf">7.23</span>    <span class="mf">7.15</span>    <span class="mf">3.99</span>    <span class="mf">6.40</span>    <span class="mf">1.23</span>
<span class="n">Test</span> <span class="n">time</span>   <span class="mf">0.26</span>    <span class="mf">0.26</span>    <span class="mf">0.25</span>    <span class="mf">0.15</span>    <span class="mf">0.13</span>    <span class="mf">0.21</span>    <span class="mf">0.06</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="dataset.html#surprise.dataset.Dataset.load_builtin" title="surprise.dataset.Dataset.load_builtin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_builtin()</span></code></a> method will
offer to download the <a class="reference external" href="http://grouplens.org/datasets/movielens/">movielens-100k dataset</a> if it has not already been
downloaded, and it will save it in the <code class="docutils literal notranslate"><span class="pre">.surprise_data</span></code> folder in your home
directory (you can also choose to save it <a class="reference internal" href="FAQ.html#data-folder"><span class="std std-ref">somewhere else</span></a>).</p>
<p>We are here using the well-known
<a class="reference internal" href="matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVD" title="surprise.prediction_algorithms.matrix_factorization.SVD"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVD</span></code></a>
algorithm, but many other algorithms are available. See
<a class="reference internal" href="prediction_algorithms.html#prediction-algorithms"><span class="std std-ref">Using prediction algorithms</span></a> for more details.</p>
<p>The <a class="reference internal" href="model_selection.html#surprise.model_selection.validation.cross_validate" title="surprise.model_selection.validation.cross_validate"><code class="xref py py-func docutils literal notranslate"><span class="pre">cross_validate()</span></code></a>
function runs a cross-validation procedure according to the <code class="docutils literal notranslate"><span class="pre">cv</span></code> argument,
and computes some <a class="reference internal" href="accuracy.html#module-surprise.accuracy" title="surprise.accuracy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">accuracy</span></code></a> measures. We are here
using a classical 5-fold cross-validation, but fancier iterators can be used
(see <a class="reference internal" href="model_selection.html#cross-validation-iterators-api"><span class="std std-ref">here</span></a>).</p>
</div>
<div class="section" id="train-test-split-and-the-fit-method">
<h3>Train-test split and the fit() method<a class="headerlink" href="#train-test-split-and-the-fit-method" title="Permalink to this headline">¶</a></h3>
<p id="train-test-split-example">If you don’t want to run a full cross-validation procedure, you can use the
<a class="reference internal" href="model_selection.html#surprise.model_selection.split.train_test_split" title="surprise.model_selection.split.train_test_split"><code class="xref py py-func docutils literal notranslate"><span class="pre">train_test_split()</span></code></a>
to sample a trainset and a testset with given sizes, and use the <a class="reference internal" href="accuracy.html#module-surprise.accuracy" title="surprise.accuracy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">accuracy</span>
<span class="pre">metric</span></code></a> of your chosing. You’ll need to use the <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.fit" title="surprise.prediction_algorithms.algo_base.AlgoBase.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> method which will
train the algorithm on the trainset, and the <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.test" title="surprise.prediction_algorithms.algo_base.AlgoBase.test"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test()</span></code></a> method which will
return the predictions made from the testset:</p>
<div class="literal-block-wrapper docutils container" id="train-test-split-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/train_test_split.py</span></code></span><a class="headerlink" href="#train-test-split-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">SVD</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">accuracy</span>
<span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Load the movielens-100k dataset (download it if needed),</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_builtin</span><span class="p">(</span><span class="s1">&#39;ml-100k&#39;</span><span class="p">)</span>

<span class="c1"># sample random trainset and testset</span>
<span class="c1"># test set is made of 25% of the ratings.</span>
<span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

<span class="c1"># We&#39;ll use the famous SVD algorithm.</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">SVD</span><span class="p">()</span>

<span class="c1"># Train the algorithm on the trainset, and predict ratings for the testset</span>
<span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">testset</span><span class="p">)</span>

<span class="c1"># Then compute RMSE</span>
<span class="n">accuracy</span><span class="o">.</span><span class="n">rmse</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RMSE</span><span class="p">:</span> <span class="mf">0.9411</span>
</pre></div>
</div>
<p>Note that you can train and test an algorithm with the following one-line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">testset</span><span class="p">)</span>
</pre></div>
</div>
<p>In some cases, your trainset and testset are already defined by some files.
Please refer to <a class="reference internal" href="#load-from-folds-example"><span class="std std-ref">this section</span></a> to handle such cases.</p>
</div>
<div class="section" id="train-on-a-whole-trainset-and-the-predict-method">
<span id="train-on-whole-trainset"></span><h3>Train on a whole trainset and the predict() method<a class="headerlink" href="#train-on-a-whole-trainset-and-the-predict-method" title="Permalink to this headline">¶</a></h3>
<p>Obviously, we could also simply fit our algorithm to the whole dataset, rather
than running cross-validation. This can be done by using the
<a class="reference internal" href="dataset.html#surprise.dataset.DatasetAutoFolds.build_full_trainset" title="surprise.dataset.DatasetAutoFolds.build_full_trainset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_full_trainset()</span></code></a> method which will
build a <a class="reference internal" href="trainset.html#surprise.Trainset" title="surprise.Trainset"><code class="xref py py-class docutils literal notranslate"><span class="pre">trainset</span></code></a> object:</p>
<div class="literal-block-wrapper docutils container" id="predict-ratings-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/predict_ratings.py</span></code></span><a class="headerlink" href="#predict-ratings-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">KNNBasic</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="c1"># Load the movielens-100k dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_builtin</span><span class="p">(</span><span class="s1">&#39;ml-100k&#39;</span><span class="p">)</span>

<span class="c1"># Retrieve the trainset.</span>
<span class="n">trainset</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">build_full_trainset</span><span class="p">()</span>

<span class="c1"># Build an algorithm, and train it.</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">KNNBasic</span><span class="p">()</span>
<span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can now predict ratings by directly calling the <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.predict" title="surprise.prediction_algorithms.algo_base.AlgoBase.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></a> method.  Let’s say
you’re interested in user 196 and item 302 (make sure they’re in the
trainset!), and you know that the true rating <span class="math notranslate nohighlight">\(r_{ui} = 4\)</span>:</p>
<div class="literal-block-wrapper docutils container" id="predict-ratings2-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/predict_ratings.py</span></code></span><a class="headerlink" href="#predict-ratings2-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">196</span><span class="p">)</span>  <span class="c1"># raw user id (as in the ratings file). They are **strings**!</span>
<span class="n">iid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">302</span><span class="p">)</span>  <span class="c1"># raw item id (as in the ratings file). They are **strings**!</span>

<span class="c1"># get a prediction for specific users and items.</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">iid</span><span class="p">,</span> <span class="n">r_ui</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The result should be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="p">:</span> <span class="mi">196</span>        <span class="n">item</span><span class="p">:</span> <span class="mi">302</span>        <span class="n">r_ui</span> <span class="o">=</span> <span class="mf">4.00</span>   <span class="n">est</span> <span class="o">=</span> <span class="mf">4.06</span>   <span class="p">{</span><span class="s1">&#39;actual_k&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;was_impossible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.predict" title="surprise.prediction_algorithms.algo_base.AlgoBase.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></a> uses <strong>raw</strong>
ids (please read <a class="reference internal" href="FAQ.html#raw-inner-note"><span class="std std-ref">this</span></a> about raw and inner ids). As
the dataset we have used has been read from a file, the raw ids are strings
(even if they represent numbers).</p>
</div>
<p>We have so far used a built-in dataset, but you can of course use your own.
This is explained in the next section.</p>
</div>
</div>
<div class="section" id="use-a-custom-dataset">
<span id="load-custom"></span><h2>Use a custom dataset<a class="headerlink" href="#use-a-custom-dataset" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://nicolashug.github.io/Surprise/">Surprise</a> has a set of  builtin
<a class="reference internal" href="dataset.html#dataset"><span class="std std-ref">datasets</span></a>, but you can of course use a custom dataset.
Loading a rating dataset can be done either from a file (e.g. a csv file), or
from a pandas dataframe.  Either way, you will need to define a <a class="reference internal" href="reader.html#surprise.reader.Reader" title="surprise.reader.Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reader</span></code></a> object for <a class="reference external" href="https://nicolashug.github.io/Surprise/">Surprise</a> to be able to parse the file or the
dataframe.</p>
<ul id="load-from-file-example">
<li><p>To load a dataset from a file (e.g. a csv file), you will need the
<a class="reference internal" href="dataset.html#surprise.dataset.Dataset.load_from_file" title="surprise.dataset.Dataset.load_from_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_from_file()</span></code></a> method:</p>
<div class="literal-block-wrapper docutils container" id="load-custom-dataset-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/load_custom_dataset.py</span></code></span><a class="headerlink" href="#load-custom-dataset-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">BaselineOnly</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Reader</span>
<span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>

<span class="c1"># path to dataset file</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/.surprise_data/ml-100k/ml-100k/u.data&#39;</span><span class="p">)</span>

<span class="c1"># As we&#39;re loading a custom dataset, we need to define a reader. In the</span>
<span class="c1"># movielens-100k dataset, each line has the following format:</span>
<span class="c1"># &#39;user item rating timestamp&#39;, separated by &#39;\t&#39; characters.</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="n">line_format</span><span class="o">=</span><span class="s1">&#39;user item rating timestamp&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">reader</span><span class="p">)</span>

<span class="c1"># We can now use this dataset as we please, e.g. calling cross_validate</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">BaselineOnly</span><span class="p">(),</span> <span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For more details about readers and how to use them, see the <a class="reference internal" href="reader.html#surprise.reader.Reader" title="surprise.reader.Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reader</span>
<span class="pre">class</span></code></a> documentation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As you already know from the previous section, the Movielens-100k dataset
is built-in so a much quicker way to load the dataset is to do <code class="docutils literal notranslate"><span class="pre">data</span> <span class="pre">=</span>
<span class="pre">Dataset.load_builtin('ml-100k')</span></code>. We will of course ignore this here.</p>
</div>
</li>
</ul>
<ul id="load-from-df-example">
<li><p>To load a dataset from a pandas dataframe, you will need the
<a class="reference internal" href="dataset.html#surprise.dataset.Dataset.load_from_df" title="surprise.dataset.Dataset.load_from_df"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_from_df()</span></code></a> method. You
will also need a <a class="reference internal" href="reader.html#surprise.reader.Reader" title="surprise.reader.Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reader</span></code></a> object, but only
the <code class="docutils literal notranslate"><span class="pre">rating_scale</span></code> parameter must be specified. The dataframe must have
three columns, corresponding to the user (raw) ids, the item (raw) ids, and
the ratings in this order. Each row thus corresponds to a given rating. This
is not restrictive as you can reorder the columns of your dataframe easily.</p>
<div class="literal-block-wrapper docutils container" id="load-dom-dataframe-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/load_from_dataframe.py</span></code></span><a class="headerlink" href="#load-dom-dataframe-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">NormalPredictor</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Reader</span>
<span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>


<span class="c1"># Creation of the dataframe. Column names are irrelevant.</span>
<span class="n">ratings_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;itemID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                <span class="s1">&#39;userID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s1">&#39;user_foo&#39;</span><span class="p">],</span>
                <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ratings_dict</span><span class="p">)</span>

<span class="c1"># A reader is still needed but only the rating_scale param is requiered.</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="n">rating_scale</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># The columns must correspond to user id, item id and ratings (in that order).</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_from_df</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;userID&#39;</span><span class="p">,</span> <span class="s1">&#39;itemID&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">]],</span> <span class="n">reader</span><span class="p">)</span>

<span class="c1"># We can now use this dataset as we please, e.g. calling cross_validate</span>
<span class="n">cross_validate</span><span class="p">(</span><span class="n">NormalPredictor</span><span class="p">(),</span> <span class="n">data</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The dataframe initially looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">itemID</span>  <span class="n">rating</span>    <span class="n">userID</span>
<span class="mi">0</span>       <span class="mi">1</span>       <span class="mi">3</span>         <span class="mi">9</span>
<span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">2</span>        <span class="mi">32</span>
<span class="mi">2</span>       <span class="mi">1</span>       <span class="mi">4</span>         <span class="mi">2</span>
<span class="mi">3</span>       <span class="mi">2</span>       <span class="mi">3</span>        <span class="mi">45</span>
<span class="mi">4</span>       <span class="mi">2</span>       <span class="mi">1</span>  <span class="n">user_foo</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="use-cross-validation-iterators">
<span id="id4"></span><h2>Use cross-validation iterators<a class="headerlink" href="#use-cross-validation-iterators" title="Permalink to this headline">¶</a></h2>
<p>For cross-validation, we can use the <a class="reference internal" href="model_selection.html#surprise.model_selection.validation.cross_validate" title="surprise.model_selection.validation.cross_validate"><code class="xref py py-func docutils literal notranslate"><span class="pre">cross_validate()</span></code></a> function that does all
the hard work for us. But for a better control, we can also instanciate a
cross-validation iterator, and make predictions over each split using the
<code class="docutils literal notranslate"><span class="pre">split()</span></code> method of the iterator, and the
<a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.test" title="surprise.prediction_algorithms.algo_base.AlgoBase.test"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test()</span></code></a> method
of the algorithm. Here is an example where we use a classical K-fold
cross-validation procedure with 3 splits:</p>
<div class="literal-block-wrapper docutils container" id="use-cross-validation-iterators-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/use_cross_validation_iterators.py</span></code></span><a class="headerlink" href="#use-cross-validation-iterators-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">SVD</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">accuracy</span>
<span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>

<span class="c1"># Load the movielens-100k dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_builtin</span><span class="p">(</span><span class="s1">&#39;ml-100k&#39;</span><span class="p">)</span>

<span class="c1"># define a cross-validation iterator</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">algo</span> <span class="o">=</span> <span class="n">SVD</span><span class="p">()</span>

<span class="k">for</span> <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>

    <span class="c1"># train and test algorithm.</span>
    <span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">testset</span><span class="p">)</span>

    <span class="c1"># Compute and print Root Mean Squared Error</span>
    <span class="n">accuracy</span><span class="o">.</span><span class="n">rmse</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Result could be, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RMSE</span><span class="p">:</span> <span class="mf">0.9374</span>
<span class="n">RMSE</span><span class="p">:</span> <span class="mf">0.9476</span>
<span class="n">RMSE</span><span class="p">:</span> <span class="mf">0.9478</span>
</pre></div>
</div>
<p>Other cross-validation iterator can be used, like LeaveOneOut or ShuffleSplit.
See all the available iterators <a class="reference internal" href="model_selection.html#cross-validation-iterators-api"><span class="std std-ref">here</span></a>.
The design of Surprise’s cross-validation tools is heavily inspired from the
excellent scikit-learn API.</p>
<hr class="docutils" />
<p id="load-from-folds-example">A special case of cross-validation is when the folds are already predefined by
some files. For instance, the movielens-100K dataset already provides 5 train
and test files (u1.base, u1.test … u5.base, u5.test). Surprise can handle
this case by using a <a class="reference internal" href="model_selection.html#surprise.model_selection.split.PredefinedKFold" title="surprise.model_selection.split.PredefinedKFold"><code class="xref py py-class docutils literal notranslate"><span class="pre">surprise.model_selection.split.PredefinedKFold</span></code></a>
object:</p>
<div class="literal-block-wrapper docutils container" id="load-custom-dataset-predefined-folds-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/load_custom_dataset_predefined_folds.py</span></code></span><a class="headerlink" href="#load-custom-dataset-predefined-folds-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">SVD</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Reader</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">accuracy</span>
<span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">PredefinedKFold</span>

<span class="c1"># path to dataset folder</span>
<span class="n">files_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/.surprise_data/ml-100k/ml-100k/&#39;</span><span class="p">)</span>

<span class="c1"># This time, we&#39;ll use the built-in reader.</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="s1">&#39;ml-100k&#39;</span><span class="p">)</span>

<span class="c1"># folds_files is a list of tuples containing file paths:</span>
<span class="c1"># [(u1.base, u1.test), (u2.base, u2.test), ... (u5.base, u5.test)]</span>
<span class="n">train_file</span> <span class="o">=</span> <span class="n">files_dir</span> <span class="o">+</span> <span class="s1">&#39;u</span><span class="si">%d</span><span class="s1">.base&#39;</span>
<span class="n">test_file</span> <span class="o">=</span> <span class="n">files_dir</span> <span class="o">+</span> <span class="s1">&#39;u</span><span class="si">%d</span><span class="s1">.test&#39;</span>
<span class="n">folds_files</span> <span class="o">=</span> <span class="p">[(</span><span class="n">train_file</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">test_file</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_from_folds</span><span class="p">(</span><span class="n">folds_files</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">reader</span><span class="p">)</span>
<span class="n">pkf</span> <span class="o">=</span> <span class="n">PredefinedKFold</span><span class="p">()</span>

<span class="n">algo</span> <span class="o">=</span> <span class="n">SVD</span><span class="p">()</span>

<span class="k">for</span> <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="ow">in</span> <span class="n">pkf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>

    <span class="c1"># train and test algorithm.</span>
    <span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">testset</span><span class="p">)</span>

    <span class="c1"># Compute and print Root Mean Squared Error</span>
    <span class="n">accuracy</span><span class="o">.</span><span class="n">rmse</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Of course, nothing prevents you from only loading a single file for training
and a single file for testing. However, the <code class="docutils literal notranslate"><span class="pre">folds_files</span></code> parameter still
needs to be a <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p>
</div>
<div class="section" id="tune-algorithm-parameters-with-gridsearchcv">
<span id="tuning-algorithm-parameters"></span><h2>Tune algorithm parameters with GridSearchCV<a class="headerlink" href="#tune-algorithm-parameters-with-gridsearchcv" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="model_selection.html#surprise.model_selection.validation.cross_validate" title="surprise.model_selection.validation.cross_validate"><code class="xref py py-func docutils literal notranslate"><span class="pre">cross_validate()</span></code></a> function reports accuracy
metric over a cross-validation procedure for a given set of parameters.  If you
want to know which parameter combination yields the best results, the
<a class="reference internal" href="model_selection.html#surprise.model_selection.search.GridSearchCV" title="surprise.model_selection.search.GridSearchCV"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridSearchCV</span></code></a> class
comes to the rescue.  Given a <code class="docutils literal notranslate"><span class="pre">dict</span></code> of parameters, this class exhaustively
tries all the combinations of parameters and reports the best parameters for any
accuracy measure (averaged over the different splits). It is heavily inspired
from scikit-learn’s <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">GridSearchCV</a>.</p>
<p>Here is an example where we try different values for parameters <code class="docutils literal notranslate"><span class="pre">n_epochs</span></code>,
<code class="docutils literal notranslate"><span class="pre">lr_all</span></code> and <code class="docutils literal notranslate"><span class="pre">reg_all</span></code> of the <a class="reference internal" href="matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVD" title="surprise.prediction_algorithms.matrix_factorization.SVD"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVD</span></code></a> algorithm.</p>
<div class="literal-block-wrapper docutils container" id="grid-search-usage-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/grid_search_usage.py</span></code></span><a class="headerlink" href="#grid-search-usage-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">SVD</span>
<span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">surprise.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="c1"># Use movielens-100K</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load_builtin</span><span class="p">(</span><span class="s1">&#39;ml-100k&#39;</span><span class="p">)</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">],</span>
              <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]}</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">SVD</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">measures</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># best RMSE score</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_score</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span>

<span class="c1"># combination of parameters that gave the best RMSE score</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.961300130118</span>
<span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">}</span>
</pre></div>
</div>
<p>We are here evaluating the average RMSE and MAE over a 3-fold cross-validation
procedure, but any <a class="reference internal" href="model_selection.html#cross-validation-iterators-api"><span class="std std-ref">cross-validation iterator</span></a> can used.</p>
<p>Once <code class="docutils literal notranslate"><span class="pre">fit()</span></code> has been called, the <code class="docutils literal notranslate"><span class="pre">best_estimator</span></code> attribute gives us an
algorithm instance with the optimal set of parameters, which can be used how we
please:</p>
<div class="literal-block-wrapper docutils container" id="grid-search-usage2-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/grid_search_usage.py</span></code></span><a class="headerlink" href="#grid-search-usage2-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can now use the algorithm that yields the best rmse:</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span>
<span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">build_full_trainset</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="admonition note" id="grid-search-note">
<p class="admonition-title">Note</p>
<p>Dictionary parameters such as <code class="docutils literal notranslate"><span class="pre">bsl_options</span></code> and <code class="docutils literal notranslate"><span class="pre">sim_options</span></code> require
particular treatment. See usage example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
              <span class="s1">&#39;sim_options&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;msd&#39;</span><span class="p">,</span> <span class="s1">&#39;cosine&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;min_support&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                              <span class="s1">&#39;user_based&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">]}</span>
              <span class="p">}</span>
</pre></div>
</div>
<p>Naturally, both can be combined, for example for the
<a class="reference internal" href="knn_inspired.html#surprise.prediction_algorithms.knns.KNNBaseline" title="surprise.prediction_algorithms.knns.KNNBaseline"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNNBaseline</span></code></a>
algorithm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bsl_options&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;als&#39;</span><span class="p">,</span> <span class="s1">&#39;sgd&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;reg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
              <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="s1">&#39;sim_options&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;msd&#39;</span><span class="p">,</span> <span class="s1">&#39;cosine&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;min_support&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                              <span class="s1">&#39;user_based&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">]}</span>
              <span class="p">}</span>
</pre></div>
</div>
</div>
<p id="cv-results-example">For further analysis, the <code class="docutils literal notranslate"><span class="pre">cv_results</span></code> attribute has all the needed
information and can be imported in a pandas dataframe:</p>
<div class="literal-block-wrapper docutils container" id="grid-search-usage3-py">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/grid_search_usage.py</span></code></span><a class="headerlink" href="#grid-search-usage3-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">cv_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In our example, the <code class="docutils literal notranslate"><span class="pre">cv_results</span></code> attribute looks like this (floats are
formatted):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;split0_test_rmse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">]</span>
<span class="s1">&#39;split1_test_rmse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">]</span>
<span class="s1">&#39;split2_test_rmse&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">]</span>
<span class="s1">&#39;mean_test_rmse&#39;</span><span class="p">:</span>   <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">]</span>
<span class="s1">&#39;std_test_rmse&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="s1">&#39;rank_test_rmse&#39;</span><span class="p">:</span>   <span class="p">[</span><span class="mi">7</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
<span class="s1">&#39;split0_test_mae&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">]</span>
<span class="s1">&#39;split1_test_mae&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">]</span>
<span class="s1">&#39;split2_test_mae&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">]</span>
<span class="s1">&#39;mean_test_mae&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">]</span>
<span class="s1">&#39;std_test_mae&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="s1">&#39;rank_test_mae&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mi">7</span> <span class="mi">8</span> <span class="mi">2</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">1</span> <span class="mi">3</span><span class="p">]</span>
<span class="s1">&#39;mean_fit_time&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mf">1.53</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">,</span> <span class="mf">1.53</span><span class="p">,</span> <span class="mf">1.53</span><span class="p">,</span> <span class="mf">3.04</span><span class="p">,</span> <span class="mf">3.05</span><span class="p">,</span> <span class="mf">3.06</span><span class="p">,</span> <span class="mf">3.02</span><span class="p">]</span>
<span class="s1">&#39;std_fit_time&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
<span class="s1">&#39;mean_test_time&#39;</span><span class="p">:</span>   <span class="p">[</span><span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">]</span>
<span class="s1">&#39;std_test_time&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">]</span>
<span class="s1">&#39;params&#39;</span><span class="p">:</span>           <span class="p">[{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.002</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.002</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.002</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.002</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;lr_all&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> <span class="s1">&#39;reg_all&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}]</span>
<span class="s1">&#39;param_n_epochs&#39;</span><span class="p">:</span>   <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="s1">&#39;param_lr_all&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
<span class="s1">&#39;param_reg_all&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
</pre></div>
</div>
<p>As you can see, each list has the same size of the number of parameter
combination. It corresponds to the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 14%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>split0_test_rmse</p></th>
<th class="head"><p>split1_test_rmse</p></th>
<th class="head"><p>split2_test_rmse</p></th>
<th class="head"><p>mean_test_rmse</p></th>
<th class="head"><p>std_test_rmse</p></th>
<th class="head"><p>rank_test_rmse</p></th>
<th class="head"><p>split0_test_mae</p></th>
<th class="head"><p>split1_test_mae</p></th>
<th class="head"><p>split2_test_mae</p></th>
<th class="head"><p>mean_test_mae</p></th>
<th class="head"><p>std_test_mae</p></th>
<th class="head"><p>rank_test_mae</p></th>
<th class="head"><p>mean_fit_time</p></th>
<th class="head"><p>std_fit_time</p></th>
<th class="head"><p>mean_test_time</p></th>
<th class="head"><p>std_test_time</p></th>
<th class="head"><p>params</p></th>
<th class="head"><p>param_n_epochs</p></th>
<th class="head"><p>param_lr_all</p></th>
<th class="head"><p>param_reg_all</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.99775</p></td>
<td><p>0.997744</p></td>
<td><p>0.996378</p></td>
<td><p>0.997291</p></td>
<td><p>0.000645508</p></td>
<td><p>7</p></td>
<td><p>0.807862</p></td>
<td><p>0.804626</p></td>
<td><p>0.805282</p></td>
<td><p>0.805923</p></td>
<td><p>0.00139657</p></td>
<td><p>7</p></td>
<td><p>1.53341</p></td>
<td><p>0.0305216</p></td>
<td><p>0.455831</p></td>
<td><p>0.000922113</p></td>
<td><p>{‘n_epochs’: 5, ‘lr_all’: 0.002, ‘reg_all’: 0.4}</p></td>
<td><p>5</p></td>
<td><p>0.002</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p>1.00381</p></td>
<td><p>1.00304</p></td>
<td><p>1.00257</p></td>
<td><p>1.00314</p></td>
<td><p>0.000508358</p></td>
<td><p>8</p></td>
<td><p>0.816559</p></td>
<td><p>0.812905</p></td>
<td><p>0.813772</p></td>
<td><p>0.814412</p></td>
<td><p>0.00155866</p></td>
<td><p>8</p></td>
<td><p>1.5199</p></td>
<td><p>0.0367117</p></td>
<td><p>0.451068</p></td>
<td><p>0.00938646</p></td>
<td><p>{‘n_epochs’: 5, ‘lr_all’: 0.002, ‘reg_all’: 0.6}</p></td>
<td><p>5</p></td>
<td><p>0.002</p></td>
<td><p>0.6</p></td>
</tr>
<tr class="row-even"><td><p>0.973524</p></td>
<td><p>0.973595</p></td>
<td><p>0.972495</p></td>
<td><p>0.973205</p></td>
<td><p>0.000502609</p></td>
<td><p>3</p></td>
<td><p>0.783361</p></td>
<td><p>0.780242</p></td>
<td><p>0.78067</p></td>
<td><p>0.781424</p></td>
<td><p>0.00138049</p></td>
<td><p>2</p></td>
<td><p>1.53449</p></td>
<td><p>0.00496203</p></td>
<td><p>0.441558</p></td>
<td><p>0.00529696</p></td>
<td><p>{‘n_epochs’: 5, ‘lr_all’: 0.005, ‘reg_all’: 0.4}</p></td>
<td><p>5</p></td>
<td><p>0.005</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p>0.98229</p></td>
<td><p>0.982059</p></td>
<td><p>0.981486</p></td>
<td><p>0.981945</p></td>
<td><p>0.000338056</p></td>
<td><p>5</p></td>
<td><p>0.794481</p></td>
<td><p>0.790781</p></td>
<td><p>0.79186</p></td>
<td><p>0.792374</p></td>
<td><p>0.00155377</p></td>
<td><p>5</p></td>
<td><p>1.52739</p></td>
<td><p>0.00859185</p></td>
<td><p>0.44463</p></td>
<td><p>0.000888907</p></td>
<td><p>{‘n_epochs’: 5, ‘lr_all’: 0.005, ‘reg_all’: 0.6}</p></td>
<td><p>5</p></td>
<td><p>0.005</p></td>
<td><p>0.6</p></td>
</tr>
<tr class="row-even"><td><p>0.978034</p></td>
<td><p>0.978407</p></td>
<td><p>0.976919</p></td>
<td><p>0.977787</p></td>
<td><p>0.000632049</p></td>
<td><p>4</p></td>
<td><p>0.787643</p></td>
<td><p>0.784723</p></td>
<td><p>0.784957</p></td>
<td><p>0.785774</p></td>
<td><p>0.00132486</p></td>
<td><p>4</p></td>
<td><p>3.03572</p></td>
<td><p>0.0431101</p></td>
<td><p>0.466606</p></td>
<td><p>0.0254965</p></td>
<td><p>{‘n_epochs’: 10, ‘lr_all’: 0.002, ‘reg_all’: 0.4}</p></td>
<td><p>10</p></td>
<td><p>0.002</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p>0.986263</p></td>
<td><p>0.985817</p></td>
<td><p>0.985004</p></td>
<td><p>0.985695</p></td>
<td><p>0.000520899</p></td>
<td><p>6</p></td>
<td><p>0.798218</p></td>
<td><p>0.794457</p></td>
<td><p>0.795373</p></td>
<td><p>0.796016</p></td>
<td><p>0.00160135</p></td>
<td><p>6</p></td>
<td><p>3.0544</p></td>
<td><p>0.00636185</p></td>
<td><p>0.488357</p></td>
<td><p>0.0576194</p></td>
<td><p>{‘n_epochs’: 10, ‘lr_all’: 0.002, ‘reg_all’: 0.6}</p></td>
<td><p>10</p></td>
<td><p>0.002</p></td>
<td><p>0.6</p></td>
</tr>
<tr class="row-even"><td><p>0.963751</p></td>
<td><p>0.963463</p></td>
<td><p>0.962676</p></td>
<td><p>0.963297</p></td>
<td><p>0.000454661</p></td>
<td><p>1</p></td>
<td><p>0.774036</p></td>
<td><p>0.770548</p></td>
<td><p>0.771588</p></td>
<td><p>0.772057</p></td>
<td><p>0.00146201</p></td>
<td><p>1</p></td>
<td><p>3.0636</p></td>
<td><p>0.0597982</p></td>
<td><p>0.456484</p></td>
<td><p>0.00510321</p></td>
<td><p>{‘n_epochs’: 10, ‘lr_all’: 0.005, ‘reg_all’: 0.4}</p></td>
<td><p>10</p></td>
<td><p>0.005</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p>0.973605</p></td>
<td><p>0.972868</p></td>
<td><p>0.972765</p></td>
<td><p>0.973079</p></td>
<td><p>0.000374222</p></td>
<td><p>2</p></td>
<td><p>0.78607</p></td>
<td><p>0.781918</p></td>
<td><p>0.783537</p></td>
<td><p>0.783842</p></td>
<td><p>0.00170855</p></td>
<td><p>3</p></td>
<td><p>3.01907</p></td>
<td><p>0.011834</p></td>
<td><p>0.338839</p></td>
<td><p>0.075346</p></td>
<td><p>{‘n_epochs’: 10, ‘lr_all’: 0.005, ‘reg_all’: 0.6}</p></td>
<td><p>10</p></td>
<td><p>0.005</p></td>
<td><p>0.6</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="command-line-usage">
<h2>Command line usage<a class="headerlink" href="#command-line-usage" title="Permalink to this headline">¶</a></h2>
<p>Surprise can also be used from the command line, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">surprise</span> <span class="o">-</span><span class="n">algo</span> <span class="n">SVD</span> <span class="o">-</span><span class="n">params</span> <span class="s2">&quot;{&#39;n_epochs&#39;: 5, &#39;verbose&#39;: True}&quot;</span> <span class="o">-</span><span class="n">load</span><span class="o">-</span><span class="n">builtin</span> <span class="n">ml</span><span class="o">-</span><span class="mi">100</span><span class="n">k</span> <span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">folds</span> <span class="mi">3</span>
</pre></div>
</div>
<p>See detailed usage by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">surprise</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="prediction_algorithms.html" class="btn btn-neutral float-right" title="Using prediction algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Surprise’ documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Nicolas Hug

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
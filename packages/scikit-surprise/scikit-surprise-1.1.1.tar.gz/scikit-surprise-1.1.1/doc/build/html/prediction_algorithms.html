

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using prediction algorithms &mdash; Surprise 1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to build your own prediction algorithm" href="building_custom_algo.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Surprise
          

          
          </a>

          
            
            
              <div class="version">
                0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using prediction algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#baselines-estimates-configuration">Baselines estimates configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#similarity-measure-configuration">Similarity measure configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="building_custom_algo.html">How to build your own prediction algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="notation_standards.html">Notation standards, References</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prediction_algorithms_package.html">prediction_algorithms package</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_selection.html">The model_selection package</a></li>
<li class="toctree-l1"><a class="reference internal" href="similarities.html">similarities module</a></li>
<li class="toctree-l1"><a class="reference internal" href="accuracy.html">accuracy module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">dataset module</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainset.html">Trainset class</a></li>
<li class="toctree-l1"><a class="reference internal" href="reader.html">Reader class</a></li>
<li class="toctree-l1"><a class="reference internal" href="dump.html">dump module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Surprise</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using prediction algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/prediction_algorithms.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-prediction-algorithms">
<span id="prediction-algorithms"></span><h1>Using prediction algorithms<a class="headerlink" href="#using-prediction-algorithms" title="Permalink to this headline">¶</a></h1>
<p>Surprise provides a bunch of built-in algorithms. All algorithms derive from
the <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase" title="surprise.prediction_algorithms.algo_base.AlgoBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgoBase</span></code></a> base
class, where are implemented some key methods (e.g. <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.predict" title="surprise.prediction_algorithms.algo_base.AlgoBase.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict</span></code></a>, <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.fit" title="surprise.prediction_algorithms.algo_base.AlgoBase.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> and <a class="reference internal" href="algobase.html#surprise.prediction_algorithms.algo_base.AlgoBase.test" title="surprise.prediction_algorithms.algo_base.AlgoBase.test"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test</span></code></a>). The list and
details of the available prediction algorithms can be found in the
<a class="reference internal" href="prediction_algorithms_package.html#module-surprise.prediction_algorithms" title="surprise.prediction_algorithms"><code class="xref py py-mod docutils literal notranslate"><span class="pre">prediction_algorithms</span></code></a> package
documentation.</p>
<p>Every algorithm is part of the global Surprise namespace, so you only need to
import their names from the Surprise package, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">surprise</span> <span class="kn">import</span> <span class="n">KNNBasic</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">KNNBasic</span><span class="p">()</span>
</pre></div>
</div>
<p>Some of these algorithms may use <a class="reference internal" href="#baseline-estimates-configuration"><span class="std std-ref">baseline estimates</span></a>, some may use a <a class="reference internal" href="#similarity-measures-configuration"><span class="std std-ref">similarity measure</span></a>. We will here review how to configure the
way baselines and similarities are computed.</p>
<div class="section" id="baselines-estimates-configuration">
<span id="baseline-estimates-configuration"></span><h2>Baselines estimates configuration<a class="headerlink" href="#baselines-estimates-configuration" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section only applies to algorithms (or similarity measures) that try to
minimize the following regularized squared error (or equivalent):</p>
<div class="math notranslate nohighlight">
\[\sum_{r_{ui} \in R_{train}} \left(r_{ui} - (\mu + b_u + b_i)\right)^2 +
\lambda \left(b_u^2 + b_i^2 \right).\]</div>
<p>For algorithms using baselines in another objective function (e.g. the
<a class="reference internal" href="matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVD" title="surprise.prediction_algorithms.matrix_factorization.SVD"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVD</span></code></a>
algorithm), the baseline configuration is done differently and is specific to
each algorithm. Please refer to their own documentation.</p>
</div>
<p>First of all, if you do not want to configure the way baselines are computed,
you don’t have to: the default parameters will do just fine. If you do want to
well… This is for you.</p>
<p>You may want to read section 2.1 of <a class="bibtex reference internal" href="notation_standards.html#koren-2010" id="id1">[Kor10]</a> to get a good idea of
what are baseline estimates.</p>
<p>Baselines can be estimated in two different ways:</p>
<ul class="simple">
<li><p>Using Stochastic Gradient Descent (SGD).</p></li>
<li><p>Using Alternating Least Squares (ALS).</p></li>
</ul>
<p>You can configure the way baselines are computed using the <code class="docutils literal notranslate"><span class="pre">bsl_options</span></code>
parameter passed at the creation of an algorithm. This parameter is a
dictionary for which the key <code class="docutils literal notranslate"><span class="pre">'method'</span></code> indicates the method to use. Accepted
values are <code class="docutils literal notranslate"><span class="pre">'als'</span></code> (default) and <code class="docutils literal notranslate"><span class="pre">'sgd'</span></code>. Depending on its value, other
options may be set. For ALS:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'reg_i'</span></code>: The regularization parameter for items. Corresponding to
<span class="math notranslate nohighlight">\(\lambda_2\)</span> in <a class="bibtex reference internal" href="notation_standards.html#koren-2010" id="id2">[Kor10]</a>.  Default is <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'reg_u'</span></code>: The regularization parameter for users. Corresponding to
<span class="math notranslate nohighlight">\(\lambda_3\)</span> in <a class="bibtex reference internal" href="notation_standards.html#koren-2010" id="id3">[Kor10]</a>.  Default is <code class="docutils literal notranslate"><span class="pre">15</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'n_epochs'</span></code>: The number of iteration of the ALS procedure. Default is
<code class="docutils literal notranslate"><span class="pre">10</span></code>.  Note that in <a class="bibtex reference internal" href="notation_standards.html#koren-2010" id="id4">[Kor10]</a>, what is described is a <strong>single</strong>
iteration ALS process.</p></li>
</ul>
<p>And for SGD:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'reg'</span></code>: The regularization parameter of the cost function that is
optimized, corresponding to <span class="math notranslate nohighlight">\(\lambda_1\)</span> in
<a class="bibtex reference internal" href="notation_standards.html#koren-2010" id="id5">[Kor10]</a>. Default is <code class="docutils literal notranslate"><span class="pre">0.02</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'learning_rate'</span></code>: The learning rate of SGD, corresponding to
<span class="math notranslate nohighlight">\(\gamma\)</span> in <a class="bibtex reference internal" href="notation_standards.html#koren-2010" id="id6">[Kor10]</a>.  Default is <code class="docutils literal notranslate"><span class="pre">0.005</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'n_epochs'</span></code>: The number of iteration of the SGD procedure. Default is 20.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For both procedures (ALS and SGD), user and item biases (<span class="math notranslate nohighlight">\(b_u\)</span> and
<span class="math notranslate nohighlight">\(b_i\)</span>) are initialized to zero.</p>
</div>
<p>Usage examples:</p>
<div class="literal-block-wrapper docutils container" id="baselines-als">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/baselines_conf.py</span></code></span><a class="headerlink" href="#baselines-als" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Using ALS&#39;</span><span class="p">)</span>
<span class="n">bsl_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;als&#39;</span><span class="p">,</span>
               <span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="s1">&#39;reg_u&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
               <span class="s1">&#39;reg_i&#39;</span><span class="p">:</span> <span class="mi">5</span>
               <span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">BaselineOnly</span><span class="p">(</span><span class="n">bsl_options</span><span class="o">=</span><span class="n">bsl_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="baselines-sgd">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/baselines_conf.py</span></code></span><a class="headerlink" href="#baselines-sgd" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Using SGD&#39;</span><span class="p">)</span>
<span class="n">bsl_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;sgd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">00005</span><span class="p">,</span>
               <span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">BaselineOnly</span><span class="p">(</span><span class="n">bsl_options</span><span class="o">=</span><span class="n">bsl_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note that some similarity measures may use baselines, such as the
<a class="reference internal" href="similarities.html#surprise.similarities.pearson_baseline" title="surprise.similarities.pearson_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pearson_baseline</span></code></a> similarity.
Configuration works just the same, whether the baselines are used in the actual
prediction <span class="math notranslate nohighlight">\(\hat{r}_{ui}\)</span> or not:</p>
<div class="literal-block-wrapper docutils container" id="baselines-als-pearson-sim">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/baselines_conf.py</span></code></span><a class="headerlink" href="#baselines-als-pearson-sim" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bsl_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;als&#39;</span><span class="p">,</span>
               <span class="s1">&#39;n_epochs&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
               <span class="p">}</span>
<span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;pearson_baseline&#39;</span><span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">KNNBasic</span><span class="p">(</span><span class="n">bsl_options</span><span class="o">=</span><span class="n">bsl_options</span><span class="p">,</span> <span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This leads us to similarity measure configuration, which we will review right
now.</p>
</div>
<div class="section" id="similarity-measure-configuration">
<span id="similarity-measures-configuration"></span><h2>Similarity measure configuration<a class="headerlink" href="#similarity-measure-configuration" title="Permalink to this headline">¶</a></h2>
<p>Many algorithms use a similarity measure to estimate a rating. The way they can
be configured is done in a similar fashion as for baseline ratings: you just
need to pass a <code class="docutils literal notranslate"><span class="pre">sim_options</span></code> argument at the creation of an algorithm. This
argument is a dictionary with the following (all optional) keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'name'</span></code>: The name of the similarity to use, as defined in the
<a class="reference internal" href="similarities.html#module-surprise.similarities" title="surprise.similarities"><code class="xref py py-mod docutils literal notranslate"><span class="pre">similarities</span></code></a> module. Default is <code class="docutils literal notranslate"><span class="pre">'MSD'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'user_based'</span></code>: Whether similarities will be computed between users or
between items. This has a <strong>huge</strong> impact on the performance of a prediction
algorithm.  Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'min_support'</span></code>: The minimum number of common items (when <code class="docutils literal notranslate"><span class="pre">'user_based'</span></code>
is <code class="docutils literal notranslate"><span class="pre">'True'</span></code>) or minimum number of common users (when <code class="docutils literal notranslate"><span class="pre">'user_based'</span></code> is
<code class="docutils literal notranslate"><span class="pre">'False'</span></code>) for the similarity not to be zero. Simply put, if
<span class="math notranslate nohighlight">\(|I_{uv}| &lt; \text{min_support}\)</span> then <span class="math notranslate nohighlight">\(\text{sim}(u, v) = 0\)</span>. The
same goes for items.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'shrinkage'</span></code>: Shrinkage parameter to apply (only relevant for
<a class="reference internal" href="similarities.html#surprise.similarities.pearson_baseline" title="surprise.similarities.pearson_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pearson_baseline</span></code></a> similarity).
Default is 100.</p></li>
</ul>
<p>Usage examples:</p>
<div class="literal-block-wrapper docutils container" id="sim-conf-cos">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/similarity_conf.py</span></code></span><a class="headerlink" href="#sim-conf-cos" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
               <span class="s1">&#39;user_based&#39;</span><span class="p">:</span> <span class="kc">False</span>  <span class="c1"># compute  similarities between items</span>
               <span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">KNNBasic</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="sim-conf-pearson-baseline">
<div class="code-block-caption"><span class="caption-text">From file <code class="docutils literal notranslate"><span class="pre">examples/similarity_conf.py</span></code></span><a class="headerlink" href="#sim-conf-pearson-baseline" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sim_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;pearson_baseline&#39;</span><span class="p">,</span>
               <span class="s1">&#39;shrinkage&#39;</span><span class="p">:</span> <span class="mi">0</span>  <span class="c1"># no shrinkage</span>
               <span class="p">}</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">KNNBasic</span><span class="p">(</span><span class="n">sim_options</span><span class="o">=</span><span class="n">sim_options</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <a class="reference internal" href="similarities.html#module-surprise.similarities" title="surprise.similarities"><code class="xref py py-mod docutils literal notranslate"><span class="pre">similarities</span></code></a> module.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="building_custom_algo.html" class="btn btn-neutral float-right" title="How to build your own prediction algorithm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Nicolas Hug

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
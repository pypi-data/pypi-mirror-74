

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>k-NN inspired algorithms &mdash; Surprise 1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Matrix Factorization-based algorithms" href="matrix_factorization.html" />
    <link rel="prev" title="Basic algorithms" href="basic_algorithms.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Surprise
          

          
          </a>

          
            
            
              <div class="version">
                0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="prediction_algorithms.html">Using prediction algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_custom_algo.html">How to build your own prediction algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="notation_standards.html">Notation standards, References</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="prediction_algorithms_package.html">prediction_algorithms package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="algobase.html">The algorithm base class</a></li>
<li class="toctree-l2"><a class="reference internal" href="predictions_module.html">The predictions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_algorithms.html">Basic algorithms</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">k-NN inspired algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix_factorization.html">Matrix Factorization-based algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="slope_one.html">Slope One</a></li>
<li class="toctree-l2"><a class="reference internal" href="co_clustering.html">Co-clustering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_selection.html">The model_selection package</a></li>
<li class="toctree-l1"><a class="reference internal" href="similarities.html">similarities module</a></li>
<li class="toctree-l1"><a class="reference internal" href="accuracy.html">accuracy module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">dataset module</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainset.html">Trainset class</a></li>
<li class="toctree-l1"><a class="reference internal" href="reader.html">Reader class</a></li>
<li class="toctree-l1"><a class="reference internal" href="dump.html">dump module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Surprise</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="prediction_algorithms_package.html">prediction_algorithms package</a> &raquo;</li>
        
      <li>k-NN inspired algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/knn_inspired.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="k-nn-inspired-algorithms">
<span id="pred-package-knn-inpired"></span><h1>k-NN inspired algorithms<a class="headerlink" href="#k-nn-inspired-algorithms" title="Permalink to this headline">¶</a></h1>
<p>These are algorithms that are directly derived from a basic nearest neighbors
approach.</p>
<div class="admonition note" id="actual-k-note">
<p class="admonition-title">Note</p>
<p>For each of these algorithms, the actual number of neighbors that are
aggregated to compute an estimation is necessarily less than or equal to
<span class="math notranslate nohighlight">\(k\)</span>. First, there might just not exist enough neighbors and second, the
sets <span class="math notranslate nohighlight">\(N_i^k(u)\)</span> and <span class="math notranslate nohighlight">\(N_u^k(i)\)</span> only include neighbors for which
the similarity measure is <strong>positive</strong>. It would make no sense to aggregate
ratings from users (or items) that are negatively correlated. For a given
prediction, the actual number of neighbors can be retrieved in the
<code class="docutils literal notranslate"><span class="pre">'actual_k'</span></code> field of the <code class="docutils literal notranslate"><span class="pre">details</span></code> dictionary of the <a class="reference internal" href="predictions_module.html#surprise.prediction_algorithms.predictions.Prediction" title="surprise.prediction_algorithms.predictions.Prediction"><code class="xref py py-class docutils literal notranslate"><span class="pre">prediction</span></code></a>.</p>
</div>
<p>You may want to read the <a class="reference internal" href="prediction_algorithms.html#similarity-measures-configuration"><span class="std std-ref">User Guide</span></a>
on how to configure the <code class="docutils literal notranslate"><span class="pre">sim_options</span></code> parameter.</p>
<dl class="py class">
<dt id="surprise.prediction_algorithms.knns.KNNBasic">
<em class="property">class </em><code class="sig-prename descclassname">surprise.prediction_algorithms.knns.</code><code class="sig-name descname">KNNBasic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">40</span></em>, <em class="sig-param"><span class="n">min_k</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sim_options</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/surprise/prediction_algorithms/knns.html#KNNBasic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#surprise.prediction_algorithms.knns.KNNBasic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">surprise.prediction_algorithms.knns.SymmetricAlgo</span></code></p>
<p>A basic collaborative filtering algorithm.</p>
<p>The prediction <span class="math notranslate nohighlight">\(\hat{r}_{ui}\)</span> is set as:</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = \frac{
\sum\limits_{v \in N^k_i(u)} \text{sim}(u, v) \cdot r_{vi}}
{\sum\limits_{v \in N^k_i(u)} \text{sim}(u, v)}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = \frac{
\sum\limits_{j \in N^k_u(i)} \text{sim}(i, j) \cdot r_{uj}}
{\sum\limits_{j \in N^k_u(i)} \text{sim}(i, j)}\]</div>
<p>depending on the <code class="docutils literal notranslate"><span class="pre">user_based</span></code> field of the <code class="docutils literal notranslate"><span class="pre">sim_options</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em>) – The (max) number of neighbors to take into account for
aggregation (see <a class="reference internal" href="#actual-k-note"><span class="std std-ref">this note</span></a>). Default is
<code class="docutils literal notranslate"><span class="pre">40</span></code>.</p></li>
<li><p><strong>min_k</strong> (<em>int</em>) – The minimum number of neighbors to take into account for
aggregation. If there are not enough neighbors, the prediction is
set to the global mean of all ratings. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>sim_options</strong> (<em>dict</em>) – A dictionary of options for the similarity
measure. See <a class="reference internal" href="prediction_algorithms.html#similarity-measures-configuration"><span class="std std-ref">Similarity measure configuration</span></a> for accepted
options.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print trace messages of bias estimation,
similarity, etc.  Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="surprise.prediction_algorithms.knns.KNNWithMeans">
<em class="property">class </em><code class="sig-prename descclassname">surprise.prediction_algorithms.knns.</code><code class="sig-name descname">KNNWithMeans</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">40</span></em>, <em class="sig-param"><span class="n">min_k</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sim_options</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/surprise/prediction_algorithms/knns.html#KNNWithMeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#surprise.prediction_algorithms.knns.KNNWithMeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">surprise.prediction_algorithms.knns.SymmetricAlgo</span></code></p>
<p>A basic collaborative filtering algorithm, taking into account the mean
ratings of each user.</p>
<p>The prediction <span class="math notranslate nohighlight">\(\hat{r}_{ui}\)</span> is set as:</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = \mu_u + \frac{ \sum\limits_{v \in N^k_i(u)}
\text{sim}(u, v) \cdot (r_{vi} - \mu_v)} {\sum\limits_{v \in
N^k_i(u)} \text{sim}(u, v)}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = \mu_i + \frac{ \sum\limits_{j \in N^k_u(i)}
\text{sim}(i, j) \cdot (r_{uj} - \mu_j)} {\sum\limits_{j \in
N^k_u(i)} \text{sim}(i, j)}\]</div>
<p>depending on the <code class="docutils literal notranslate"><span class="pre">user_based</span></code> field of the <code class="docutils literal notranslate"><span class="pre">sim_options</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em>) – The (max) number of neighbors to take into account for
aggregation (see <a class="reference internal" href="#actual-k-note"><span class="std std-ref">this note</span></a>). Default is
<code class="docutils literal notranslate"><span class="pre">40</span></code>.</p></li>
<li><p><strong>min_k</strong> (<em>int</em>) – The minimum number of neighbors to take into account for
aggregation. If there are not enough neighbors, the neighbor
aggregation is set to zero (so the prediction ends up being
equivalent to the mean <span class="math notranslate nohighlight">\(\mu_u\)</span> or <span class="math notranslate nohighlight">\(\mu_i\)</span>). Default is
<code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>sim_options</strong> (<em>dict</em>) – A dictionary of options for the similarity
measure. See <a class="reference internal" href="prediction_algorithms.html#similarity-measures-configuration"><span class="std std-ref">Similarity measure configuration</span></a> for accepted
options.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print trace messages of bias estimation,
similarity, etc.  Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="surprise.prediction_algorithms.knns.KNNWithZScore">
<em class="property">class </em><code class="sig-prename descclassname">surprise.prediction_algorithms.knns.</code><code class="sig-name descname">KNNWithZScore</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">40</span></em>, <em class="sig-param"><span class="n">min_k</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sim_options</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/surprise/prediction_algorithms/knns.html#KNNWithZScore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#surprise.prediction_algorithms.knns.KNNWithZScore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">surprise.prediction_algorithms.knns.SymmetricAlgo</span></code></p>
<p>A basic collaborative filtering algorithm, taking into account
the z-score normalization of each user.</p>
<p>The prediction <span class="math notranslate nohighlight">\(\hat{r}_{ui}\)</span> is set as:</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = \mu_u + \sigma_u \frac{ \sum\limits_{v \in N^k_i(u)}
\text{sim}(u, v) \cdot (r_{vi} - \mu_v) / \sigma_v} {\sum\limits_{v
\in N^k_i(u)} \text{sim}(u, v)}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = \mu_i + \sigma_i \frac{ \sum\limits_{j \in N^k_u(i)}
\text{sim}(i, j) \cdot (r_{uj} - \mu_j) / \sigma_j} {\sum\limits_{j
\in N^k_u(i)} \text{sim}(i, j)}\]</div>
<p>depending on the <code class="docutils literal notranslate"><span class="pre">user_based</span></code> field of the <code class="docutils literal notranslate"><span class="pre">sim_options</span></code> parameter.</p>
<p>If <span class="math notranslate nohighlight">\(\sigma\)</span> is 0, than the overall sigma is used in that case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em>) – The (max) number of neighbors to take into account for
aggregation (see <a class="reference internal" href="#actual-k-note"><span class="std std-ref">this note</span></a>). Default is
<code class="docutils literal notranslate"><span class="pre">40</span></code>.</p></li>
<li><p><strong>min_k</strong> (<em>int</em>) – The minimum number of neighbors to take into account for
aggregation. If there are not enough neighbors, the neighbor
aggregation is set to zero (so the prediction ends up being
equivalent to the mean <span class="math notranslate nohighlight">\(\mu_u\)</span> or <span class="math notranslate nohighlight">\(\mu_i\)</span>). Default is
<code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>sim_options</strong> (<em>dict</em>) – A dictionary of options for the similarity
measure. See <a class="reference internal" href="prediction_algorithms.html#similarity-measures-configuration"><span class="std std-ref">Similarity measure configuration</span></a> for accepted
options.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print trace messages of bias estimation,
similarity, etc.  Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="surprise.prediction_algorithms.knns.KNNBaseline">
<em class="property">class </em><code class="sig-prename descclassname">surprise.prediction_algorithms.knns.</code><code class="sig-name descname">KNNBaseline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">40</span></em>, <em class="sig-param"><span class="n">min_k</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sim_options</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">bsl_options</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/surprise/prediction_algorithms/knns.html#KNNBaseline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#surprise.prediction_algorithms.knns.KNNBaseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">surprise.prediction_algorithms.knns.SymmetricAlgo</span></code></p>
<p>A basic collaborative filtering algorithm taking into account a
<em>baseline</em> rating.</p>
<p>The prediction <span class="math notranslate nohighlight">\(\hat{r}_{ui}\)</span> is set as:</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = b_{ui} + \frac{ \sum\limits_{v \in N^k_i(u)}
\text{sim}(u, v) \cdot (r_{vi} - b_{vi})} {\sum\limits_{v \in
N^k_i(u)} \text{sim}(u, v)}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{ui} = b_{ui} + \frac{ \sum\limits_{j \in N^k_u(i)}
\text{sim}(i, j) \cdot (r_{uj} - b_{uj})} {\sum\limits_{j \in
N^k_u(i)} \text{sim}(i, j)}\]</div>
<p>depending on the <code class="docutils literal notranslate"><span class="pre">user_based</span></code> field of the <code class="docutils literal notranslate"><span class="pre">sim_options</span></code> parameter. For
the best predictions, use the <a class="reference internal" href="similarities.html#surprise.similarities.pearson_baseline" title="surprise.similarities.pearson_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pearson_baseline</span></code></a> similarity measure.</p>
<p>This algorithm corresponds to formula (3), section 2.2 of
<a class="bibtex reference internal" href="notation_standards.html#koren-2010" id="id1">[Kor10]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em>) – The (max) number of neighbors to take into account for
aggregation (see <a class="reference internal" href="#actual-k-note"><span class="std std-ref">this note</span></a>). Default is
<code class="docutils literal notranslate"><span class="pre">40</span></code>.</p></li>
<li><p><strong>min_k</strong> (<em>int</em>) – The minimum number of neighbors to take into account for
aggregation. If there are not enough neighbors, the neighbor
aggregation is set to zero (so the prediction ends up being
equivalent to the baseline). Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>sim_options</strong> (<em>dict</em>) – A dictionary of options for the similarity
measure. See <a class="reference internal" href="prediction_algorithms.html#similarity-measures-configuration"><span class="std std-ref">Similarity measure configuration</span></a> for accepted
options. It is recommended to use the <a class="reference internal" href="similarities.html#surprise.similarities.pearson_baseline" title="surprise.similarities.pearson_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pearson_baseline</span></code></a> similarity measure.</p></li>
<li><p><strong>bsl_options</strong> (<em>dict</em>) – A dictionary of options for the baseline estimates
computation. See <a class="reference internal" href="prediction_algorithms.html#baseline-estimates-configuration"><span class="std std-ref">Baselines estimates configuration</span></a> for
accepted options.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print trace messages of bias estimation,
similarity, etc.  Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="matrix_factorization.html" class="btn btn-neutral float-right" title="Matrix Factorization-based algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basic_algorithms.html" class="btn btn-neutral float-left" title="Basic algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Nicolas Hug

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
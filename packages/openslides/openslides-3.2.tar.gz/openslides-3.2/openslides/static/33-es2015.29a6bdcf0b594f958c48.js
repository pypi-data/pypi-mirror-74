(window.webpackJsonp=window.webpackJsonp||[]).push([[33,36],{F48D:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var c=n("mrSG"),a=n("LBBb"),o=n("fXoL"),i=n("0IaG");let l=(()=>{class t{constructor(t){this.dialog=t}open(t,e=""){return Object(c.a)(this,void 0,void 0,(function*(){return this.dialog.open(a.a,{width:"250px",data:{title:t,content:e}}).afterClosed().toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(o.ec(i.b))},t.\u0275prov=o.Qb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},LBBb:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var c=n("0IaG"),a=n("fXoL"),o=n("ofXK"),i=n("bTqV"),l=n("sYmb");function s(t,e){if(1&t&&(a.ac(0,"div"),a.ac(1,"h2",1),a.Tc(2),a.Zb(),a.Vb(3,"mat-dialog-content",2),a.ac(4,"mat-dialog-actions"),a.ac(5,"button",3),a.Tc(6),a.nc(7,"translate"),a.Zb(),a.ac(8,"button",4),a.Tc(9),a.nc(10,"translate"),a.Zb(),a.Zb(),a.Zb()),2&t){const t=a.mc();a.Hb(2),a.Uc(t.data.title),a.Hb(1),a.uc("innerHTML",t.data.content,a.Kc),a.Hb(2),a.uc("mat-dialog-close",!0),a.Hb(1),a.Uc(a.oc(7,6,"Yes")),a.Hb(2),a.uc("mat-dialog-close",!1),a.Hb(1),a.Uc(a.oc(10,8,"Cancel"))}}let r=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}}return t.\u0275fac=function(e){return new(e||t)(a.Ub(c.h),a.Ub(c.a))},t.\u0275cmp=a.Ob({type:t,selectors:[["os-prompt-dialog"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-dialog-title",""],[3,"innerHTML"],["mat-button","","color","warn",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&a.Rc(0,s,11,10,"div",0),2&t&&a.uc("ngIf",e.data)},directives:[o.t,c.i,c.f,c.c,i.b,c.d],pipes:[l.j],encapsulation:2}),t})()},moyA:function(t,e,n){"use strict";n.r(e),n.d(e,"MotionWorkflowModule",(function(){return yt}));var c=n("ofXK"),a=n("PCNd"),o=n("tyNb"),i=n("+0xr"),l=n("lJxs"),s=n("ZvXm"),r=n("s3dr"),m=n("F48D"),u=n("gtli"),b=n("Izkr"),d=n("mV3u"),f=n("fXoL"),g=n("jhN1"),p=n("sYmb"),h=n("dNgK"),w=n("0IaG"),v=n("mksl"),k=n("bTqV"),M=n("NFeN"),C=n("STbY"),Z=n("bSwM"),_=n("A5z7"),R=n("kmnG"),H=n("qFsG"),O=n("3Pt+"),P=n("IZUe");const T=["workflowDialog"];function D(t,e){if(1&t&&(f.ac(0,"h2"),f.Tc(1),f.nc(2,"translate"),f.Zb()),2&t){const t=f.mc();f.Hb(1),f.Vc(" ",f.oc(2,1,t.workflow.name)," ")}}function y(t,e){1&t&&(f.ac(0,"th",20),f.Tc(1),f.nc(2,"translate"),f.Zb()),2&t&&(f.Hb(1),f.Uc(f.oc(2,1,"Permissions")))}function S(t,e){if(1&t&&(f.ac(0,"td",21),f.ac(1,"div",22),f.Tc(2),f.nc(3,"translate"),f.Zb(),f.Zb()),2&t){const t=e.$implicit;f.Hb(2),f.Vc(" ",f.oc(3,1,t.name)," ")}}function x(t,e){if(1&t){const t=f.bc();f.ac(0,"th",25),f.ic("click",(function(){f.Jc(t);const e=f.mc().$implicit;return f.mc(2).onClickStateName(e)})),f.ac(1,"div",26),f.ac(2,"div",27),f.Tc(3),f.nc(4,"translate"),f.Zb(),f.Zb(),f.Zb()}if(2&t){const t=f.mc().$implicit;f.Hb(3),f.Vc(" ",f.oc(4,1,t.name)," ")}}function I(t,e){if(1&t){const t=f.bc();f.ac(0,"div",27),f.ac(1,"mat-checkbox",29),f.ic("change",(function(e){f.Jc(t);const n=f.mc().$implicit,c=f.mc().$implicit;return f.mc(2).onToggleStatePerm(c,n.selector,e)})),f.Zb(),f.Zb()}if(2&t){const t=f.mc().$implicit,e=f.mc().$implicit;f.Hb(1),f.uc("checked",e[t.selector])}}function U(t,e){if(1&t){const t=f.bc();f.ac(0,"div"),f.ac(1,"div",27),f.Tc(2),f.nc(3,"translate"),f.Zb(),f.ac(4,"div",30),f.ic("click",(function(){f.Jc(t);const e=f.mc().$implicit,n=f.mc().$implicit;return f.mc(2).onClickInputPerm(e,n)})),f.Zb(),f.Zb()}if(2&t){const t=f.mc().$implicit,e=f.mc().$implicit;f.Hb(2),f.Vc(" ",f.oc(3,1,e[t.selector])||"\u2013"," ")}}const F=function(t){return{state:t}};function E(t,e){if(1&t&&(f.ac(0,"div",27),f.ac(1,"mat-basic-chip",31),f.Tc(2),f.nc(3,"translate"),f.Zb(),f.Zb()),2&t){const t=f.mc().$implicit,e=f.mc().$implicit;f.mc(2);const n=f.Fc(11);f.Hb(1),f.uc("matMenuTriggerFor",n)("matMenuTriggerData",f.Ac(7,F,e))("disableRipple",!0)("ngClass",e[t.selector]),f.Hb(1),f.Vc(" ",f.oc(3,5,e[t.selector])," ")}}function $(t,e){1&t&&(f.ac(0,"div"),f.Tc(1," - "),f.Zb())}function N(t,e){1&t&&(f.ac(0,"span"),f.Tc(1,",\xa0"),f.Zb())}function A(t,e){if(1&t&&(f.ac(0,"div"),f.Tc(1),f.nc(2,"translate"),f.Rc(3,N,2,0,"span",2),f.Zb()),2&t){const t=e.$implicit,n=e.last;f.Hb(1),f.Vc(" ",f.oc(2,2,t.name),""),f.Hb(2),f.uc("ngIf",!n)}}function L(t,e){if(1&t&&(f.ac(0,"div"),f.Rc(1,A,4,4,"div",33),f.Zb()),2&t){const t=f.mc(3).$implicit;f.Hb(1),f.uc("ngForOf",t.next_states)}}function V(t,e){if(1&t&&(f.ac(0,"div"),f.ac(1,"div",27),f.Rc(2,$,2,0,"div",2),f.Rc(3,L,2,1,"div",2),f.Zb(),f.Vb(4,"div",32),f.Zb()),2&t){const t=f.mc(2).$implicit;f.mc(2);const e=f.Fc(14);f.Hb(2),f.uc("ngIf",!t.next_states.length),f.Hb(1),f.uc("ngIf",t.next_states.length),f.Hb(1),f.uc("matMenuTriggerFor",e)("matMenuTriggerData",f.Ac(4,F,t))}}function B(t,e){if(1&t&&(f.ac(0,"div"),f.ac(1,"div",27),f.Tc(2),f.nc(3,"translate"),f.Zb(),f.Vb(4,"div",32),f.Zb()),2&t){const t=f.mc(2).$implicit,e=f.mc(2),n=f.Fc(20);f.Hb(2),f.Vc(" ",f.oc(3,3,e.getMergeAmendmentLabel(t.merge_amendment_into_final))," "),f.Hb(2),f.uc("matMenuTriggerFor",n)("matMenuTriggerData",f.Ac(5,F,t))}}function j(t,e){1&t&&(f.ac(0,"div"),f.Tc(1," - "),f.Zb())}function W(t,e){1&t&&(f.ac(0,"span"),f.Tc(1,",\xa0"),f.Zb())}function J(t,e){if(1&t&&(f.ac(0,"div"),f.Tc(1),f.nc(2,"translate"),f.Rc(3,W,2,0,"span",2),f.Zb()),2&t){const t=e.$implicit,n=e.last,c=f.mc(6);f.Hb(1),f.Vc(" ",f.oc(2,2,c.getRestrictionLabel(t))," "),f.Hb(2),f.uc("ngIf",!n)}}function z(t,e){if(1&t&&(f.ac(0,"div"),f.Rc(1,J,4,4,"div",33),f.Zb()),2&t){const t=f.mc(3).$implicit;f.Hb(1),f.uc("ngForOf",t.restriction)}}function X(t,e){if(1&t&&(f.ac(0,"div"),f.ac(1,"div",27),f.Rc(2,j,2,0,"div",2),f.Rc(3,z,2,1,"div",2),f.Zb(),f.Vb(4,"div",32),f.Zb()),2&t){const t=f.mc(2).$implicit;f.mc(2);const e=f.Fc(17);f.Hb(2),f.uc("ngIf",!t.restriction.length),f.Hb(1),f.uc("ngIf",t.restriction.length),f.Hb(1),f.uc("matMenuTriggerFor",e)("matMenuTriggerData",f.Ac(4,F,t))}}function Y(t,e){if(1&t&&(f.ac(0,"td",21),f.Rc(1,I,2,1,"div",28),f.Rc(2,U,5,3,"div",2),f.Rc(3,E,4,9,"div",28),f.Rc(4,V,5,6,"div",2),f.Rc(5,B,5,7,"div",2),f.Rc(6,X,5,6,"div",2),f.Zb()),2&t){const t=e.$implicit;f.Hb(1),f.uc("ngIf","check"===t.type),f.Hb(1),f.uc("ngIf","input"===t.type),f.Hb(1),f.uc("ngIf","color"===t.type),f.Hb(1),f.uc("ngIf","state"===t.type),f.Hb(1),f.uc("ngIf","amendment"===t.type),f.Hb(1),f.uc("ngIf","restriction"===t.type)}}function G(t,e){if(1&t&&(f.Yb(0,23),f.Rc(1,x,5,3,"th",24),f.Rc(2,Y,7,6,"td",16),f.Xb()),2&t){const t=e.$implicit,n=f.mc(2);f.uc("matColumnDef",n.getColumnDef(t))}}function q(t,e){1&t&&f.Vb(0,"tr",34)}function K(t,e){1&t&&f.Vb(0,"tr",35)}function Q(t,e){if(1&t&&(f.ac(0,"div"),f.ac(1,"div",11),f.ac(2,"strong"),f.ac(3,"span"),f.Tc(4),f.nc(5,"translate"),f.Zb(),f.Tc(6,": "),f.ac(7,"span"),f.Tc(8),f.nc(9,"translate"),f.Zb(),f.Zb(),f.Zb(),f.ac(10,"div",12),f.ac(11,"table",13),f.Yb(12,14),f.Rc(13,y,3,3,"th",15),f.Rc(14,S,4,3,"td",16),f.Xb(),f.Rc(15,G,3,1,"ng-container",17),f.Rc(16,q,1,0,"tr",18),f.Rc(17,K,1,0,"tr",19),f.Zb(),f.Zb(),f.Zb()),2&t){const t=f.mc();f.Hb(4),f.Uc(f.oc(5,7,"First state")),f.Hb(4),f.Uc(f.oc(9,9,t.workflow.first_state.name)),f.Hb(3),f.uc("dataSource",t.getTableDataSource()),f.Hb(4),f.uc("ngForOf",t.workflow.states)("ngForTrackBy",t.trackByIndex),f.Hb(1),f.uc("matHeaderRowDef",t.headerRowDef),f.Hb(1),f.uc("matRowDefColumns",t.headerRowDef)}}const tt=function(){return{action:"delete"}};function et(t,e){1&t&&(f.ac(0,"button",43),f.ac(1,"span"),f.Tc(2),f.nc(3,"translate"),f.Zb(),f.Zb()),2&t&&(f.uc("mat-dialog-close",f.zc(4,tt)),f.Hb(2),f.Uc(f.oc(3,2,"Delete")))}const nt=function(t){return{action:"update",value:t}};function ct(t,e){if(1&t){const t=f.bc();f.ac(0,"h1",36),f.ac(1,"span"),f.Tc(2),f.nc(3,"translate"),f.Zb(),f.Zb(),f.ac(4,"div",37),f.ac(5,"p"),f.Tc(6),f.nc(7,"translate"),f.Zb(),f.ac(8,"mat-form-field"),f.ac(9,"input",38),f.ic("ngModelChange",(function(e){return f.Jc(t),f.mc().dialogData.value=e})),f.Zb(),f.Zb(),f.Zb(),f.ac(10,"div",39),f.ac(11,"button",40),f.ac(12,"span"),f.Tc(13),f.nc(14,"translate"),f.Zb(),f.Zb(),f.ac(15,"button",41),f.ac(16,"span"),f.Tc(17),f.nc(18,"translate"),f.Zb(),f.Zb(),f.Rc(19,et,4,5,"button",42),f.Zb()}if(2&t){const t=f.mc();f.Hb(2),f.Uc(f.oc(3,9,t.dialogData.title)),f.Hb(4),f.Uc(f.oc(7,11,t.dialogData.description)),f.Hb(3),f.uc("ngModel",t.dialogData.value),f.Hb(2),f.uc("disabled",""===t.dialogData.value&&!t.dialogData.allowEmpty)("mat-dialog-close",f.Ac(17,nt,t.dialogData.value)),f.Hb(2),f.Uc(f.oc(14,13,"Save")),f.Hb(2),f.uc("mat-dialog-close",null),f.Hb(2),f.Uc(f.oc(18,15,"Cancel")),f.Hb(2),f.uc("ngIf",t.dialogData.deletable)}}function at(t,e){1&t&&(f.ac(0,"mat-icon"),f.Tc(1,"check"),f.Zb())}function ot(t,e){if(1&t){const t=f.bc();f.ac(0,"button",45),f.ic("click",(function(){f.Jc(t);const n=e.$implicit,c=f.mc().state;return f.mc().onSelectColor(c,n)})),f.Rc(1,at,2,0,"mat-icon",2),f.ac(2,"span"),f.Tc(3),f.nc(4,"translate"),f.Zb(),f.Zb()}if(2&t){const t=e.$implicit,n=f.mc().state;f.Hb(1),f.uc("ngIf",t===n.css_class),f.Hb(2),f.Uc(f.oc(4,2,t))}}function it(t,e){if(1&t&&f.Rc(0,ot,5,4,"button",44),2&t){const t=f.mc();f.uc("ngForOf",t.labelColors)}}function lt(t,e){1&t&&(f.ac(0,"mat-icon"),f.Tc(1,"check"),f.Zb())}function st(t,e){if(1&t){const t=f.bc();f.ac(0,"button",45),f.ic("click",(function(){f.Jc(t);const e=f.mc().$implicit,n=f.mc().state;return f.mc().onSetNextState(e,n)})),f.Rc(1,lt,2,0,"mat-icon",2),f.ac(2,"span"),f.Tc(3),f.nc(4,"translate"),f.Zb(),f.Zb()}if(2&t){const t=f.mc().$implicit,e=f.mc().state;f.Hb(1),f.uc("ngIf",e.next_states_id.includes(t.id)),f.Hb(2),f.Uc(f.oc(4,2,t.name))}}function rt(t,e){if(1&t&&(f.ac(0,"div"),f.Rc(1,st,5,4,"button",46),f.Zb()),2&t){const t=e.$implicit,n=f.mc().state;f.Hb(1),f.uc("ngIf",t.name!==n.name)}}function mt(t,e){if(1&t&&f.Rc(0,rt,2,1,"div",33),2&t){const t=f.mc();f.uc("ngForOf",t.workflow.states)}}function ut(t,e){1&t&&(f.ac(0,"mat-icon"),f.Tc(1,"check"),f.Zb())}function bt(t,e){if(1&t){const t=f.bc();f.ac(0,"button",45),f.ic("click",(function(){f.Jc(t);const n=e.$implicit,c=f.mc().state;return f.mc().onSetRestriction(n.key,c)})),f.Rc(1,ut,2,0,"mat-icon",2),f.ac(2,"span"),f.Tc(3),f.nc(4,"translate"),f.Zb(),f.Zb()}if(2&t){const t=e.$implicit,n=f.mc().state;f.Hb(1),f.uc("ngIf",n.restriction.includes(t.key)),f.Hb(2),f.Uc(f.oc(4,2,t.label))}}function dt(t,e){if(1&t&&f.Rc(0,bt,5,4,"button",44),2&t){const t=f.mc();f.uc("ngForOf",t.restrictions)}}function ft(t,e){1&t&&(f.ac(0,"mat-icon"),f.Tc(1,"check"),f.Zb())}function gt(t,e){if(1&t){const t=f.bc();f.ac(0,"div"),f.ac(1,"button",45),f.ic("click",(function(){f.Jc(t);const n=e.$implicit,c=f.mc().state;return f.mc().setMergeAmendment(n.merge,c)})),f.Rc(2,ft,2,0,"mat-icon",2),f.ac(3,"span"),f.Tc(4),f.nc(5,"translate"),f.Zb(),f.Zb(),f.Zb()}if(2&t){const t=e.$implicit,n=f.mc().state;f.Hb(2),f.uc("ngIf",t.merge===n.merge_amendment_into_final),f.Hb(2),f.Uc(f.oc(5,2,t.label))}}function pt(t,e){if(1&t&&f.Rc(0,gt,6,4,"div",33),2&t){const t=f.mc();f.uc("ngForOf",t.amendmentIntoFinal)}}let ht=(()=>{class t extends d.a{constructor(t,e,n,c,a,o,i,l,s){super(t,e,n),this.translate=e,this.promptService=c,this.dialog=a,this.workflowRepo=o,this.stateRepo=i,this.route=l,this.cd=s,this.headerRowDef=[],this.labelColors=["grey","red","green","lightblue","yellow"],this.statePermissionsList=[{name:"Recommendation label",selector:"recommendation_label",type:"input"},{name:"Allow support",selector:"allow_support",type:"check"},{name:"Allow create poll",selector:"allow_create_poll",type:"check"},{name:"Allow submitter edit",selector:"allow_submitter_edit",type:"check"},{name:"Do not set identifier",selector:"dont_set_identifier",type:"check"},{name:"Show state extension field",selector:"show_state_extension_field",type:"check"},{name:"Show recommendation extension field",selector:"show_recommendation_extension_field",type:"check"},{name:"Show amendment in parent motion",selector:"merge_amendment_into_final",type:"amendment"},{name:"Restrictions",selector:"restriction",type:"restriction"},{name:"Label color",selector:"css_class",type:"color"},{name:"Next states",selector:"next_states_id",type:"state"}],this.restrictions=[{key:u.b.motionsCanManage,label:"Can manage motions"},{key:u.b.motionsCanSeeInternal,label:"Can see motions in internal state"},{key:u.b.motionsCanManageMetadata,label:"Can manage motion metadata"},{key:u.b.motionsIsSubmitter,label:"Submitters"}],this.amendmentIntoFinal=[{merge:u.a.NO,label:"No"},{merge:u.a.UNDEFINED,label:"-"},{merge:u.a.YES,label:"Yes"}]}ngOnInit(){const t=parseInt(this.route.snapshot.paramMap.get("id"),10);this.subscriptions.push(this.workflowRepo.getViewModelObservable(t).subscribe(t=>{t&&(this.workflow=t,this.updateRowDef(),this.cd.markForCheck())}),this.stateRepo.getViewModelListObservable().pipe(Object(l.a)(t=>t.filter(t=>this.workflow.states_id.includes(t.id)))).subscribe(t=>{t&&this.cd.markForCheck()}))}onClickStateName(t){this.openEditDialog(t.name,"Rename state","",!0).subscribe(e=>{if(e)if(this.cd.detectChanges(),"update"===e.action)this.stateRepo.update({name:e.value},t).then(()=>{},this.raiseError);else if("delete"===e.action){const e=this.translate.instant("Delete")+` ${t.name}?`;this.promptService.open("Are you sure",e).then(e=>{e&&this.stateRepo.delete(t).then(()=>{},this.raiseError)})}})}onNewStateButton(){this.openEditDialog("",this.translate.instant("New state"),this.translate.instant("Name")).subscribe(t=>{if(t&&"update"===t.action){const e=new u.c({name:t.value,workflow_id:this.workflow.id});this.stateRepo.create(e).then(()=>{},this.raiseError)}})}onEditWorkflowButton(){this.openEditDialog(this.workflow.name,"Edit name","Please enter a new workflow name:").subscribe(t=>{t&&"update"===t.action&&this.workflowRepo.update({name:t.value},this.workflow).then(()=>{},this.raiseError)})}onClickInputPerm(t,e){this.openEditDialog(e[t.selector],"Edit",t.name,!1,!0).subscribe(n=>{""===n.value&&(n.value=null),n&&"update"===n.action&&this.stateRepo.update({[t.selector]:n.value},e).then(()=>{},this.raiseError)})}onToggleStatePerm(t,e,n){this.stateRepo.update({[e]:n.checked},t).then(()=>{},this.raiseError)}onSelectColor(t,e){this.stateRepo.update({css_class:e},t).then(()=>{},this.raiseError)}onSetNextState(t,e){const n=e.next_states_id.map(t=>t),c=n.findIndex(e=>e===t.id);c<0?n.push(t.id):n.splice(c,1),this.stateRepo.update({next_states_id:n},e).then(()=>{},this.raiseError)}onSetRestriction(t,e){const n=e.restriction.map(t=>t),c=n.findIndex(e=>e===t);c<0?n.push(t):n.splice(c,1),this.stateRepo.update({restriction:n},e).then(()=>{},this.raiseError)}getRestrictionLabel(t){const e=this.restrictions.find(e=>e.key===t);return e?e.label:""}setMergeAmendment(t,e){this.stateRepo.update({merge_amendment_into_final:t},e).then(()=>{},this.raiseError)}openEditDialog(t,e,n,c,a){return this.dialogData={title:e||"",description:n||"",value:t,deletable:c,allowEmpty:a},this.dialog.open(this.workflowDialog,b.a).afterClosed()}getMergeAmendmentLabel(t){return this.amendmentIntoFinal.find(e=>e.merge===t).label}getTableDataSource(){const t=new i.o;return t.data=this.statePermissionsList,t}updateRowDef(){this.headerRowDef=["perm"],this.workflow&&this.workflow.states.forEach(t=>{this.headerRowDef.push(this.getColumnDef(t))})}getColumnDef(t){return`${t.name}${t.id}`}trackElement(t){return t}}return t.\u0275fac=function(e){return new(e||t)(f.Ub(g.d),f.Ub(p.k),f.Ub(h.a),f.Ub(m.a),f.Ub(w.b),f.Ub(r.a),f.Ub(s.a),f.Ub(o.a),f.Ub(f.h))},t.\u0275cmp=f.Ob({type:t,selectors:[["os-workflow-detail"]],viewQuery:function(t,e){var n;1&t&&f.Pc(T,!0),2&t&&f.Ec(n=f.jc())&&(e.workflowDialog=n.first)},features:[f.Eb],decls:22,vars:4,consts:[[3,"nav","hasMainButton","mainEvent"],[1,"title-slot"],[4,"ngIf"],[1,"extra-controls-slot"],["mat-icon-button","",3,"click"],["workflowDialog",""],["matMenuContent",""],["colorMenu","matMenu"],["nextStatesMenu","matMenu"],["restrictionMenu","matMenu"],["mergeAmendmentMenu","matMenu"],[1,"title-line"],[1,"scrollable-matrix"],["mat-table","",3,"dataSource"],["matColumnDef","perm","sticky",""],["mat-header-cell","","class","group-head-table-cell",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf","ngForTrackBy"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"group-head-table-cell"],["mat-cell",""],[1,"permission-name"],[3,"matColumnDef"],["mat-header-cell","",3,"click",4,"matHeaderCellDef"],["mat-header-cell","",3,"click"],[1,"clickable-cell","stretch-to-fill-parent"],[1,"inner-table"],["class","inner-table",4,"ngIf"],[3,"checked","change"],[1,"clickable-cell","stretch-to-fill-parent",3,"click"],[3,"matMenuTriggerFor","matMenuTriggerData","disableRipple","ngClass"],[1,"clickable-cell","stretch-to-fill-parent",3,"matMenuTriggerFor","matMenuTriggerData"],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row",""],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],["matInput","","osAutofocus","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"disabled","mat-dialog-close"],["type","button","mat-button","",3,"mat-dialog-close"],["type","button","mat-button","","color","warn",3,"mat-dialog-close",4,"ngIf"],["type","button","mat-button","","color","warn",3,"mat-dialog-close"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(f.ac(0,"os-head-bar",0),f.ic("mainEvent",(function(){return e.onNewStateButton()})),f.ac(1,"div",1),f.Rc(2,D,3,3,"h2",2),f.Zb(),f.ac(3,"div",3),f.ac(4,"button",4),f.ic("click",(function(){return e.onEditWorkflowButton()})),f.ac(5,"mat-icon"),f.Tc(6,"edit"),f.Zb(),f.Zb(),f.Zb(),f.Zb(),f.Rc(7,Q,18,11,"div",2),f.Rc(8,ct,20,19,"ng-template",null,5,f.Sc),f.ac(10,"mat-menu",6,7),f.Rc(12,it,1,1,"ng-template",6),f.Zb(),f.ac(13,"mat-menu",6,8),f.Rc(15,mt,1,1,"ng-template",6),f.Zb(),f.ac(16,"mat-menu",6,9),f.Rc(18,dt,1,1,"ng-template",6),f.Zb(),f.ac(19,"mat-menu",6,10),f.Rc(21,pt,1,1,"ng-template",6),f.Zb()),2&t&&(f.uc("nav",!1)("hasMainButton",!0),f.Hb(2),f.uc("ngIf",e.workflow),f.Hb(5),f.uc("ngIf",e.workflow))},directives:[v.a,c.t,k.b,M.a,C.f,C.b,i.n,i.c,i.i,i.b,c.s,i.k,i.m,i.h,i.a,Z.a,_.a,C.e,c.q,i.j,i.l,w.i,w.f,R.c,H.b,O.c,P.a,O.s,O.v,w.c,w.d,C.c],pipes:[p.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}.title-line[_ngcontent-%COMP%]{margin:20px 25px}table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{min-width:200px;position:relative}table[_ngcontent-%COMP%]   .clickable-cell[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;cursor:pointer}table[_ngcontent-%COMP%]   .clickable-cell[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.025)}table[_ngcontent-%COMP%]   .inner-table[_ngcontent-%COMP%]{text-align:center;-ms-flex-align:center;align-items:center;margin:auto;overflow:hidden;padding:0 10px}table[_ngcontent-%COMP%]   .mat-column-perm[_ngcontent-%COMP%]{min-width:150px}table[_ngcontent-%COMP%]   .mat-column-perm[_ngcontent-%COMP%]   .permission-name[_ngcontent-%COMP%]{margin-right:10px}.mat-chip[_ngcontent-%COMP%]:hover{cursor:pointer}.scrollable-matrix[_ngcontent-%COMP%]{overflow-y:scroll;overflow-x:auto;height:calc(100vh - 128px)}"],changeDetection:0}),t})();var wt=n("mrSG"),vt=n("AqIO"),kt=n("hsNs"),Mt=n("wL0i"),Ct=n("0Obk"),Zt=n("dRZP");function _t(t,e){if(1&t&&f.Vb(0,"a",7),2&t){const t=f.mc().row;f.uc("routerLink",t.id)}}function Rt(t,e){if(1&t&&(f.ac(0,"div",5),f.Rc(1,_t,1,1,"a",6),f.ac(2,"div"),f.Tc(3),f.nc(4,"translate"),f.Zb(),f.Zb()),2&t){const t=e.value,n=f.mc();f.Hb(1),f.uc("ngIf",!n.isMultiSelect),f.Hb(2),f.Uc(f.oc(4,2,t))}}function Ht(t,e){if(1&t){const t=f.bc();f.ac(0,"div",5),f.ac(1,"button",8),f.ic("click",(function(){f.Jc(t);const n=e.row;return f.mc().onDeleteWorkflow(n)})),f.ac(2,"mat-icon",9),f.Tc(3,"delete"),f.Zb(),f.Zb(),f.Zb()}}function Ot(t,e){if(1&t){const t=f.bc();f.ac(0,"h1",10),f.ac(1,"span"),f.Tc(2),f.nc(3,"translate"),f.Zb(),f.Zb(),f.ac(4,"div",11),f.ac(5,"p"),f.Tc(6),f.nc(7,"translate"),f.Zb(),f.ac(8,"mat-form-field"),f.ac(9,"input",12),f.ic("ngModelChange",(function(e){return f.Jc(t),f.mc().newWorkflowTitle=e})),f.Zb(),f.Zb(),f.Zb(),f.ac(10,"div",13),f.ac(11,"button",14),f.ac(12,"span"),f.Tc(13),f.nc(14,"translate"),f.Zb(),f.Zb(),f.ac(15,"button",15),f.ac(16,"span"),f.Tc(17),f.nc(18,"translate"),f.Zb(),f.Zb(),f.Zb()}if(2&t){const t=f.mc();f.Hb(2),f.Uc(f.oc(3,8,"New workflow")),f.Hb(4),f.Uc(f.oc(7,10,"Please enter a name for the new workflow:")),f.Hb(3),f.uc("ngModel",t.newWorkflowTitle),f.Hb(2),f.uc("disabled",""===t.newWorkflowTitle)("mat-dialog-close",t.newWorkflowTitle),f.Hb(2),f.Uc(f.oc(14,12,"Save")),f.Hb(2),f.uc("mat-dialog-close",null),f.Hb(2),f.Uc(f.oc(18,14,"Cancel"))}}const Pt=function(){return["menu"]},Tt=[{path:"",component:(()=>{class t extends Mt.a{constructor(t,e,n,c,a,o,i){super(t,e,n,c),this.translate=e,this.dialog=a,this.workflowRepo=o,this.promptService=i,this.tableColumnDefinition=[{prop:"name",width:"auto"},{prop:"delete"}],this.filterProps=["name","states"]}ngOnInit(){super.setTitle("Workflows")}onNewButton(t){this.newWorkflowTitle="",this.dialog.open(t,b.a).afterClosed().subscribe(t=>{t&&this.workflowRepo.create(new kt.a({name:t})).then(()=>{},this.raiseError)})}onDeleteWorkflow(t){return Object(wt.a)(this,void 0,void 0,(function*(){const e=this.translate.instant("Are you sure you want to delete this workflow?"),n=t.getTitle();(yield this.promptService.open(e,n))&&this.workflowRepo.delete(t).then(()=>{},this.raiseError)}))}}return t.\u0275fac=function(e){return new(e||t)(f.Ub(g.d),f.Ub(p.k),f.Ub(h.a),f.Ub(vt.a),f.Ub(w.b),f.Ub(r.a),f.Ub(m.a))},t.\u0275cmp=f.Ob({type:t,selectors:[["os-workflow-list"]],features:[f.Eb],decls:10,vars:14,consts:[["prevUrl","../..",3,"nav","hasMainButton","mainEvent"],[1,"title-slot"],["listStorageKey","workflow",3,"listObservableProvider","columns","allowProjector","hiddenInMobile","showListOfSpeakers","filterProps","dataSourceChange"],["class","cell-slot fill",4,"pblNgridCellDef"],["newWorkflowDialog",""],[1,"cell-slot","fill"],["class","detail-link",3,"routerLink",4,"ngIf"],[1,"detail-link",3,"routerLink"],["type","button","mat-icon-button","",3,"click"],["color","warn"],["mat-dialog-title",""],["mat-dialog-content",""],["matInput","","osAutofocus","","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"disabled","mat-dialog-close"],["type","button","mat-button","",3,"mat-dialog-close"]],template:function(t,e){if(1&t){const t=f.bc();f.ac(0,"os-head-bar",0),f.ic("mainEvent",(function(){f.Jc(t);const n=f.Fc(9);return e.onNewButton(n)})),f.ac(1,"div",1),f.ac(2,"h2"),f.Tc(3),f.nc(4,"translate"),f.Zb(),f.Zb(),f.Zb(),f.ac(5,"os-list-view-table",2),f.ic("dataSourceChange",(function(t){return e.onDataSourceChange(t)})),f.Rc(6,Rt,5,4,"div",3),f.Rc(7,Ht,4,0,"div",3),f.Zb(),f.Rc(8,Ot,19,16,"ng-template",null,4,f.Sc)}2&t&&(f.uc("nav",!1)("hasMainButton",!0),f.Hb(3),f.Uc(f.oc(4,11,"Workflows")),f.Hb(2),f.uc("listObservableProvider",e.workflowRepo)("columns",e.tableColumnDefinition)("allowProjector",!1)("hiddenInMobile",f.zc(13,Pt))("showListOfSpeakers",!1)("filterProps",e.filterProps),f.Hb(1),f.uc("pblNgridCellDef","name"),f.Hb(1),f.uc("pblNgridCellDef","delete"))},directives:[v.a,Ct.a,Zt.c,c.t,o.i,k.b,M.a,w.i,w.f,R.c,H.b,O.c,P.a,O.D,O.s,O.v,w.c,w.d],pipes:[p.j],styles:[""]}),t})(),pathMatch:"full"},{path:":id",component:ht}];let Dt=(()=>{class t{}return t.\u0275mod=f.Sb({type:t}),t.\u0275inj=f.Rb({factory:function(e){return new(e||t)},imports:[[o.j.forChild(Tt)],o.j]}),t})(),yt=(()=>{class t{}return t.\u0275mod=f.Sb({type:t}),t.\u0275inj=f.Rb({factory:function(e){return new(e||t)},imports:[[c.c,Dt,a.a]]}),t})()},wL0i:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var c=n("mV3u");class a extends c.a{constructor(t,e,n,c){super(t,e,n),this.storage=c,this.canMultiSelect=!1,this._multiSelectMode=!1,this.singleButtonWidth="40px",this.badgeButtonWidth="45px",this.selectedRows=[]}onDataSourceChange(t){this.dataSource=t}toggleMultiSelect(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}selectAll(){this.dataSource.selection.select(...this.dataSource.filteredData)}deselectAll(){this.dataSource&&this.dataSource.selection.clear()}get isMultiSelect(){return this._multiSelectMode}}}}]);